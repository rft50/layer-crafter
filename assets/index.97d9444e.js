/* empty css                    */import"./vue.70b1b80d.js";import{q as _t,C as s,ab as L,t as O,aF as _,a1 as k,aL as Ve,bv as yt,G as se,as as ft,_ as M,az as Dt,a2 as b,J as R,O as z,aK as Fe,a0 as A,I as he,a8 as D,a9 as p,b7 as q,aI as tt,aG as nt,l as de,u as cn,b2 as ze,aD as Rn,w as $e,b3 as qe,ap as vi,aH as Ot,A as ue,$ as G,b9 as dn,ar as He,bt as bi,bc as $t,T as yi,j as _i,bw as Ue,ay as Ni,aM as De,aO as be,z as Ze,bo as wi,bs as Ci,bd as $n,am as jt,H as ki,bx as Si,bf as Ii}from"./@vue.6b211d3c.js";import{L as We}from"./lz-string.dccec454.js";import{c as zn}from"./nanoevents.1080beb7.js";import{Y as Mi}from"./vue-next-select.16313da0.js";import{D as $i}from"./vuedraggable.400ed3a6.js";import{p as xi}from"./vue-textarea-autosize.35804eaf.js";import{P as Ti}from"./vue-panzoom.0776ea98.js";import{s as Pi,u as Un}from"./vue-toastification.5e0793ee.js";import"./amator.44aadee5.js";import"./bezier-easing.a990b400.js";import"./sortablejs.8a81d281.js";import"./panzoom.63406b21.js";import"./wheel.e7ba1027.js";import"./ngraph.events.083734c6.js";const Fi=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}};Fi();const Di="modulepreload",xn={},Ai="./",xt=function(t,n){return!n||n.length===0?t():Promise.all(n.map(i=>{if(i=`${Ai}${i}`,i in xn)return;xn[i]=!0;const r=i.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${o}`))return;const a=document.createElement("link");if(a.rel=r?"stylesheet":Di,r||(a.as="script",a.crossOrigin=""),a.href=i,document.head.appendChild(a),r)return new Promise((l,u)=>{a.addEventListener("load",l),a.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t())},Ei="./projInfo-schema.json",Oi="Layer Crafter",Vi="A project made in Profectus",qi="layer-crafter",Bi="rft50",Li="",Ri="",zi="0.0",Ui="Initial Commit",ji=!1,Gi=!1,Wi=2,Hi=!0,Zi=null,Yi="",Ji=["main"],Ki=3600,Xi=1,Qi=!0,er="base64";var X={$schema:Ei,title:Oi,description:Vi,id:qi,author:Bi,discordName:Li,discordLink:Ri,versionNumber:zi,versionTitle:Ui,allowGoBack:ji,defaultShowSmall:Gi,defaultDecimalsShown:Wi,useHeader:Hi,banner:Zi,logo:Yi,initialTabs:Ji,maxTickLength:Ki,offlineLimit:Xi,enablePausing:Qi,exportEncoding:er};const tr=_t({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,offlineProd:!0,offlineTime:null,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var E=window.player=tr;function fn(e){return JSON.stringify(e,(t,n)=>s(n))}var ee=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n};const nr=["onClick"],ir=L({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=O(!1),i=O(null);function r(){t("click"),i.value&&clearTimeout(i.value),n.value=!1,ft(()=>{n.value=!0,i.value=setTimeout(()=>n.value=!1,500)})}return(o,a)=>(_(),k("button",{onClick:yt(r,["stop"]),class:se(["feedback",{activated:n.value,left:e.left}])},[Ve(o.$slots,"default",{},void 0,!0)],10,nr))}});var gn=ee(ir,[["__scopeId","data-v-01a1b95c"]]);const Jt=e=>(tt("data-v-ac351c02"),e=e(),nt(),e),rr={class:"error"},sr={class:"error-title"},or={class:"error-details",style:{"margin-top":"-10px"}},ar={key:0},lr={class:"instructions"},ur=["href"],cr=Jt(()=>b("span",{class:"material-icons",style:{"font-size":"16px"}},"content_paste",-1)),dr=Jt(()=>b("span",{style:{"margin-left":"8px","font-size":"medium"}},"Copy Save",-1)),fr=Jt(()=>b("br",null,null,-1)),gr={key:0,style:{"margin-top":"20px"}},mr=Jt(()=>b("h3",null,"Other errors",-1)),pr=[mr],hr={class:"error-details"},vr={key:0,style:{"margin-top":"10px"}},br={key:1,style:{"margin-top":"10px"}},yr=L({__name:"Error",props:{errors:null},setup(e){const t=e,n=M(()=>t.errors[0]),i=M(()=>t.errors.map(a=>a.stack==null?[]:a.stack.split(`
`))),r=M(()=>t.errors.map(a=>a.cause==null?[]:(typeof a.cause=="string"?a.cause:JSON.stringify(a.cause)).split(`
`)));function o(){let a=fn(E);switch(X.exportEncoding){default:console.warn(`Unknown save encoding: ${X.exportEncoding}. Defaulting to lz`);case"lz":a=We.compressToUTF16(a);break;case"base64":a=btoa(unescape(encodeURIComponent(a)));break;case"plain":break}console.log(a);const l=document.createElement("textarea");l.value=a,document.body.appendChild(l),l.select(),l.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(l)}return Dt(()=>{E.autosave=!1,E.devSpeed=0}),(a,l)=>(_(),k("div",rr,[b("h1",sr,R(s(n).name)+": "+R(s(n).message),1),b("div",or,[s(n).cause?(_(),k("div",ar,[(_(!0),k(z,null,Fe(s(r)[0],u=>(_(),k("div",{key:u},R(u),1))),128))])):A("",!0),s(n).stack?(_(),k("div",{key:1,style:he(s(n).cause?"margin-top: 10px":"")},[(_(!0),k(z,null,Fe(s(i)[0],u=>(_(),k("div",{key:u},R(u),1))),128))],4)):A("",!0)]),b("div",lr,[D(" Check the console for more details, and consider sharing it with the developers on "),b("a",{href:s(X).discordLink||"https://discord.gg/yJ4fjnjU54",class:"discord-link"},"discord",8,ur),D("! "),p(gn,{onClick:o,class:"button",style:{display:"inline-flex"}},{default:q(()=>[cr,dr]),_:1}),fr,e.errors.length>1?(_(),k("div",gr,pr)):A("",!0),(_(!0),k(z,null,Fe(e.errors.slice(1),(u,f)=>(_(),k("div",{key:f,style:{"margin-top":"20px"}},[b("details",hr,[b("summary",null,R(u.name)+": "+R(u.message),1),u.cause?(_(),k("div",vr,[(_(!0),k(z,null,Fe(s(r)[f+1],h=>(_(),k("div",{key:h},R(h),1))),128))])):A("",!0),u.stack?(_(),k("div",br,[(_(!0),k(z,null,Fe(s(i)[f+1],h=>(_(),k("div",{key:h},R(h),1))),128))])):A("",!0)])]))),128))])]))}});var jn=ee(yr,[["__scopeId","data-v-ac351c02"]]);class _r{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const i=new Nr(t,n);for(this.first===void 0?(this.first=i,this.last=i):(i.next=this.first,this.first.prev=i,this.first=i),this.map.set(t,i);this.map.size>this.maxSize;){const r=this.last;this.map.delete(r.key),this.last=r.prev,this.last.next=void 0}}}class Nr{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const rn=17,wr=9e15,Cr=Math.log10(9e15),kr=1/9e15,Sr=308,Ir=-324,Tn=5,Mr=(1<<10)-1,$r=function(){const e=[];for(let n=Ir+1;n<=Sr;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),at=[2,Math.E,3,4,5,6,7,8,9,10],xr=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],Tr=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let C=function(t){return c.fromValue_noAlloc(t)},U=function(e,t,n){return c.fromComponents(e,t,n)},H=function(t,n,i){return c.fromComponents_noNormalize(t,n,i)};const Je=function(t,n){const i=n+1,r=Math.ceil(Math.log10(Math.abs(t))),o=Math.round(t*Math.pow(10,i-r))*Math.pow(10,r-i);return parseFloat(o.toFixed(Math.max(i-r,0)))},sn=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},Pr=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const i=e*e;let r=e;return n=n+1/(12*r),r=r*i,n=n+1/(360*r),r=r*i,n=n+1/(1260*r),r=r*i,n=n+1/(1680*r),r=r*i,n=n+1/(1188*r),r=r*i,n=n+691/(360360*r),r=r*i,n=n+7/(1092*r),r=r*i,n=n+3617/(122400*r),Math.exp(n)/t},Gn=.5671432904097838,Pn=function(e,t=1e-10){let n,i;if(!Number.isFinite(e)||e===0)return e;if(e===1)return Gn;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let r=0;r<100;++r){if(i=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(i-n)<t*Math.abs(i))return i;n=i}throw Error(`Iteration failed to converge: ${e.toString()}`)};function Fn(e,t=1e-10){let n,i,r,o;if(!Number.isFinite(e.mag)||e.eq(c.dZero))return e;if(e.eq(c.dOne))return c.fromNumber(Gn);n=c.ln(e);for(let a=0;a<100;++a){if(i=n.neg().exp(),r=n.sub(e.mul(i)),o=n.sub(r.div(n.add(1).sub(n.add(2).mul(r).div(c.mul(2,n).add(2))))),c.abs(o.sub(n)).lt(c.abs(o).mul(t)))return o;n=o}throw Error(`Iteration failed to converge: ${e.toString()}`)}const v=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof v?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/$r(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new v().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new v().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new v().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new v().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new v().fromDecimal(e)}static fromNumber(e){return new v().fromNumber(e)}static fromString(e){return new v().fromString(e)}static fromValue(e){return new v().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof v)return e;if(typeof e=="string"){const t=v.fromStringCache.get(e);return t!==void 0?t:v.fromString(e)}else return typeof e=="number"?v.fromNumber(e):v.dZero}static abs(e){return C(e).abs()}static neg(e){return C(e).neg()}static negate(e){return C(e).neg()}static negated(e){return C(e).neg()}static sign(e){return C(e).sign}static sgn(e){return C(e).sign}static round(e){return C(e).round()}static floor(e){return C(e).floor()}static ceil(e){return C(e).ceil()}static trunc(e){return C(e).trunc()}static add(e,t){return C(e).add(t)}static plus(e,t){return C(e).add(t)}static sub(e,t){return C(e).sub(t)}static subtract(e,t){return C(e).sub(t)}static minus(e,t){return C(e).sub(t)}static mul(e,t){return C(e).mul(t)}static multiply(e,t){return C(e).mul(t)}static times(e,t){return C(e).mul(t)}static div(e,t){return C(e).div(t)}static divide(e,t){return C(e).div(t)}static recip(e){return C(e).recip()}static reciprocal(e){return C(e).recip()}static reciprocate(e){return C(e).reciprocate()}static cmp(e,t){return C(e).cmp(t)}static cmpabs(e,t){return C(e).cmpabs(t)}static compare(e,t){return C(e).cmp(t)}static isNaN(e){return e=C(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=C(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return C(e).eq(t)}static equals(e,t){return C(e).eq(t)}static neq(e,t){return C(e).neq(t)}static notEquals(e,t){return C(e).notEquals(t)}static lt(e,t){return C(e).lt(t)}static lte(e,t){return C(e).lte(t)}static gt(e,t){return C(e).gt(t)}static gte(e,t){return C(e).gte(t)}static max(e,t){return C(e).max(t)}static min(e,t){return C(e).min(t)}static minabs(e,t){return C(e).minabs(t)}static maxabs(e,t){return C(e).maxabs(t)}static clamp(e,t,n){return C(e).clamp(t,n)}static clampMin(e,t){return C(e).clampMin(t)}static clampMax(e,t){return C(e).clampMax(t)}static cmp_tolerance(e,t,n){return C(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return C(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return C(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return C(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return C(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return C(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return C(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return C(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return C(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return C(e).gte_tolerance(t,n)}static pLog10(e){return C(e).pLog10()}static absLog10(e){return C(e).absLog10()}static log10(e){return C(e).log10()}static log(e,t){return C(e).log(t)}static log2(e){return C(e).log2()}static ln(e){return C(e).ln()}static logarithm(e,t){return C(e).logarithm(t)}static pow(e,t){return C(e).pow(t)}static pow10(e){return C(e).pow10()}static pow_base(e,t){return C(e).pow_base(t)}static root(e,t){return C(e).root(t)}static factorial(e,t){return C(e).factorial()}static gamma(e,t){return C(e).gamma()}static lngamma(e,t){return C(e).lngamma()}static exp(e){return C(e).exp()}static sqr(e){return C(e).sqr()}static sqrt(e){return C(e).sqrt()}static cube(e){return C(e).cube()}static cbrt(e){return C(e).cbrt()}static tetrate(e,t=2,n=H(1,0,1)){return C(e).tetrate(t,n)}static iteratedexp(e,t=2,n=H(1,0,1)){return C(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return C(e).iteratedlog(t,n)}static layeradd10(e,t){return C(e).layeradd10(t)}static layeradd(e,t,n=10){return C(e).layeradd(t,n)}static slog(e,t=10){return C(e).slog(t)}static lambertw(e){return C(e).lambertw()}static ssqrt(e){return C(e).ssqrt()}static pentate(e,t=2,n=H(1,0,1)){return C(e).pentate(t,n)}static sin(e){return C(e).sin()}static cos(e){return C(e).cos()}static tan(e){return C(e).tan()}static asin(e){return C(e).asin()}static acos(e){return C(e).acos()}static atan(e){return C(e).atan()}static sinh(e){return C(e).sinh()}static cosh(e){return C(e).cosh()}static tanh(e){return C(e).tanh()}static asinh(e){return C(e).asinh()}static acosh(e){return C(e).acosh()}static atanh(e){return C(e).atanh()}static affordGeometricSeries(e,t,n,i){return this.affordGeometricSeries_core(C(e),C(t),C(n),i)}static sumGeometricSeries(e,t,n,i){return this.sumGeometricSeries_core(e,C(t),C(n),i)}static affordArithmeticSeries(e,t,n,i){return this.affordArithmeticSeries_core(C(e),C(t),C(n),C(i))}static sumArithmeticSeries(e,t,n,i){return this.sumArithmeticSeries_core(C(e),C(t),C(n),C(i))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(C(e),C(t),C(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return H(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return H(t,0,1);const n=Math.floor(Math.random()*(e+1));let i=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(i=Math.trunc(i));let r=Math.pow(10,i);return Math.random()>.9&&(r=Math.trunc(r)),U(t,n,r)}static affordGeometricSeries_core(e,t,n,i){const r=t.mul(n.pow(i));return v.floor(e.div(r).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,i){return t.mul(n.pow(i)).mul(v.sub(1,n.pow(e))).div(v.sub(1,n))}static affordArithmeticSeries_core(e,t,n,i){const o=t.add(i.mul(n)).sub(n.div(2)),a=o.pow(2);return o.neg().add(a.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,i){const r=t.add(i.mul(n));return e.div(2).mul(r.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<kr)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=wr)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<Cr&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=v.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const i=e.split("^^^");if(i.length===2){const w=parseFloat(i[0]),N=parseFloat(i[1]),I=i[1].split(";");let P=1;if(I.length===2&&(P=parseFloat(I[1]),isFinite(P)||(P=1)),isFinite(w)&&isFinite(N)){const S=v.pentate(w,N,P);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}const r=e.split("^^");if(r.length===2){const w=parseFloat(r[0]),N=parseFloat(r[1]),I=r[1].split(";");let P=1;if(I.length===2&&(P=parseFloat(I[1]),isFinite(P)||(P=1)),isFinite(w)&&isFinite(N)){const S=v.tetrate(w,N,P);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}const o=e.split("^");if(o.length===2){const w=parseFloat(o[0]),N=parseFloat(o[1]);if(isFinite(w)&&isFinite(N)){const I=v.pow(w,N);return this.sign=I.sign,this.layer=I.layer,this.mag=I.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}e=e.trim().toLowerCase();let a,l,u=e.split("pt");if(u.length===2){a=10,l=parseFloat(u[0]),u[1]=u[1].replace("(",""),u[1]=u[1].replace(")","");let w=parseFloat(u[1]);if(isFinite(w)||(w=1),isFinite(a)&&isFinite(l)){const N=v.tetrate(a,l,w);return this.sign=N.sign,this.layer=N.layer,this.mag=N.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}if(u=e.split("p"),u.length===2){a=10,l=parseFloat(u[0]),u[1]=u[1].replace("(",""),u[1]=u[1].replace(")","");let w=parseFloat(u[1]);if(isFinite(w)||(w=1),isFinite(a)&&isFinite(l)){const N=v.tetrate(a,l,w);return this.sign=N.sign,this.layer=N.layer,this.mag=N.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}const f=e.split("e"),h=f.length-1;if(h===0){const w=parseFloat(e);if(isFinite(w))return this.fromNumber(w),v.fromStringCache.size>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}else if(h===1){const w=parseFloat(e);if(isFinite(w)&&w!==0)return this.fromNumber(w),v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}const g=e.split("e^");if(g.length===2){this.sign=1,g[0].charAt(0)=="-"&&(this.sign=-1);let w="";for(let N=0;N<g[1].length;++N){const I=g[1].charCodeAt(N);if(I>=43&&I<=57||I===101)w+=g[1].charAt(N);else return this.layer=parseFloat(w),this.mag=parseFloat(g[1].substr(N+1)),this.normalize(),v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}if(h<1)return this.sign=0,this.layer=0,this.mag=0,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this;const m=parseFloat(f[0]);if(m===0)return this.sign=0,this.layer=0,this.mag=0,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this;let y=parseFloat(f[f.length-1]);if(h>=2){const w=parseFloat(f[f.length-2]);isFinite(w)&&(y*=Math.sign(w),y+=sn(w))}if(!isFinite(m))this.sign=f[0]==="-"?-1:1,this.layer=h,this.mag=y;else if(h===1)this.sign=Math.sign(m),this.layer=1,this.mag=y+Math.log10(Math.abs(m));else if(this.sign=Math.sign(m),this.layer=h,h===2){const w=v.mul(U(1,2,y),C(m));return this.sign=w.sign,this.layer=w.layer,this.mag=w.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}else this.mag=y;return this.normalize(),v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}fromValue(e){return e instanceof v?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:Je(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:Je(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=Tn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):Je(this.m,e)+"e"+Je(this.e,e):this.layer===1?Je(this.m,e)+"e"+Je(this.e,e):this.layer<=Tn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+Je(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+Je(this.mag,e)}abs(){return H(this.sign===0?0:1,this.layer,this.mag)}neg(){return H(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?v.dZero:this.layer===0?U(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?v.dZero:this.layer===0?U(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?v.dZero:this.layer===0?U(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?v.dZero:this.layer===0?U(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=C(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return H(0,0,0);let n,i;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(v.cmpabs(this,t)>0?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return v.fromNumber(n.sign*n.mag+i.sign*i.mag);const r=n.layer*Math.sign(n.mag),o=i.layer*Math.sign(i.mag);if(r-o>=2)return n;if(r===0&&o===-1){if(Math.abs(i.mag-Math.log10(n.mag))>rn)return n;{const a=Math.pow(10,Math.log10(n.mag)-i.mag),l=i.sign+n.sign*a;return U(Math.sign(l),1,i.mag+Math.log10(Math.abs(l)))}}if(r===1&&o===0){if(Math.abs(n.mag-Math.log10(i.mag))>rn)return n;{const a=Math.pow(10,n.mag-Math.log10(i.mag)),l=i.sign+n.sign*a;return U(Math.sign(l),1,Math.log10(i.mag)+Math.log10(Math.abs(l)))}}if(Math.abs(n.mag-i.mag)>rn)return n;{const a=Math.pow(10,n.mag-i.mag),l=i.sign+n.sign*a;return U(Math.sign(l),1,i.mag+Math.log10(Math.abs(l)))}}plus(e){return this.add(e)}sub(e){return this.add(C(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=C(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return H(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return H(this.sign*t.sign,0,1);let n,i;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return v.fromNumber(n.sign*i.sign*n.mag*i.mag);if(n.layer>=3||n.layer-i.layer>=2)return U(n.sign*i.sign,n.layer,n.mag);if(n.layer===1&&i.layer===0)return U(n.sign*i.sign,1,n.mag+Math.log10(i.mag));if(n.layer===1&&i.layer===1)return U(n.sign*i.sign,1,n.mag+i.mag);if(n.layer===2&&i.layer===1){const r=U(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(U(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return U(n.sign*i.sign,r.layer+1,r.sign*r.mag)}if(n.layer===2&&i.layer===2){const r=U(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(U(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return U(n.sign*i.sign,r.layer+1,r.sign*r.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=C(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?v.dNaN:this.layer===0?U(this.sign,0,1/this.mag):U(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=C(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=C(e),n=this.mag>0?this.layer:-this.layer,i=t.mag>0?t.layer:-t.layer;return n>i?1:n<i?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=C(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=C(e);return this.lt(t)?t:this}min(e){const t=C(e);return this.gt(t)?t:this}maxabs(e){const t=C(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=C(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=C(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=C(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let i=this.mag,r=n.mag;return this.layer>n.layer&&(r=sn(r)),this.layer<n.layer&&(i=sn(i)),Math.abs(i-r)<=t*Math.max(Math.abs(i),Math.abs(r))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=C(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=C(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=C(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=C(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(v.dZero)?v.dZero:this.log10()}absLog10(){return this.sign===0?v.dNaN:this.layer>0?U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):U(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?v.dNaN:this.layer>0?U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):U(this.sign,0,Math.log10(this.mag))}log(e){return e=C(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?v.dNaN:this.layer===0&&e.layer===0?U(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):v.div(this.log10(),e.log10())}log2(){return this.sign<=0?v.dNaN:this.layer===0?U(this.sign,0,Math.log2(this.mag)):this.layer===1?U(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?U(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?v.dNaN:this.layer===0?U(this.sign,0,Math.log(this.mag)):this.layer===1?U(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?U(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=C(e),n=this,i=t;if(n.sign===0)return i.eq(0)?H(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(i.sign===0)return H(1,0,1);if(i.sign===1&&i.layer===0&&i.mag===1)return n;const r=n.absLog10().mul(i).pow10();return this.sign===-1?Math.abs(i.toNumber()%2)%2===1?r.neg():Math.abs(i.toNumber()%2)%2===0?r:v.dNaN:r}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return v.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return U(1,0,t);if(e.sign===0)return v.dOne;e=H(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?U(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?U(-e.sign,e.layer+1,-e.mag):v.dOne}pow_base(e){return C(e).pow(this)}root(e){const t=C(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?v.exp(v.mul(this,v.ln(this).sub(1))):v.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(H(1,0,24)))return v.fromNumber(Pr(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let i=e,r=12*i,o=1/r,a=t+o;if(a===t||(t=a,i=i*n,r=360*i,o=1/r,a=t-o,a===t))return v.exp(t);t=a,i=i*n,r=1260*i;let l=1/r;return t=t+l,i=i*n,r=1680*i,l=1/r,t=t-l,v.exp(t)}else return this.layer===1?v.exp(v.mul(this,v.ln(this).sub(1))):v.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?v.dOne:this.layer===0&&this.mag<=709.7?v.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?U(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?U(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):U(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return v.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return U(1,2,Math.log10(this.mag)-.3010299956639812);{const e=v.div(H(this.sign,this.layer-1,this.mag),H(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=H(1,0,1)){if(e===1)return v.pow(this,t);if(e===0)return new v(t);if(this.eq(v.dOne))return v.dOne;if(this.eq(-1))return v.pow(this,t);if(e===Number.POSITIVE_INFINITY){const r=this.toNumber();if(r<=1.444667861009766&&r>=.06598803584531254){if(r>1.444667861009099)return v.fromNumber(Math.E);const o=v.ln(this).neg();return o.lambertw().div(o)}else return r>1.444667861009766?v.fromNumber(Number.POSITIVE_INFINITY):v.dNaN}if(this.eq(v.dZero)){let r=Math.abs((e+1)%2);return r>1&&(r=2-r),v.fromNumber(r)}if(e<0)return v.iteratedlog(t,this,-e);t=C(t);const n=e;e=Math.trunc(e);const i=n-e;if(this.gt(v.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let r=0;r<e;++r){const o=t;if(t=this.pow(t),o.eq(t))return t}if(i!=0){const r=this.pow(t);return t.mul(1-i).add(r.mul(i))}return t}i!==0&&(t.eq(v.dOne)?this.gt(10)?t=this.pow(i):(t=v.fromNumber(v.tetrate_critical(this.toNumber(),i)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let r=0;r<e;++r){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return H(t.sign,t.layer+(e-r-1),t.mag);if(r>1e4)return t}return t}iteratedexp(e=2,t=H(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return v.tetrate(e,-t,this);e=C(e);let n=v.fromDecimal(this);const i=t;t=Math.trunc(t);const r=i-t;if(n.layer-e.layer>3){const o=Math.min(t,n.layer-e.layer-3);t-=o,n.layer-=o}for(let o=0;o<t;++o){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(o>1e4)return n}return r>0&&r<1&&(e.eq(10)?n=n.layeradd10(-r):n=n.layeradd(-r,e)),n}slog(e=10,t=100){let n=.001,i=!1,r=!1,o=this.slog_internal(e).toNumber();for(let a=1;a<t;++a){const u=new v(e).tetrate(o).gt(this);if(a>1&&r!=u&&(i=!0),r=u,i?n/=2:n*=2,n=Math.abs(n)*(u?-1:1),o+=n,n===0)break}return v.fromNumber(o)}slog_internal(e=10){if(e=C(e),e.lte(v.dZero)||e.eq(v.dOne))return v.dNaN;if(e.lt(v.dOne))return this.eq(v.dOne)?v.dZero:this.eq(v.dZero)?v.dNegOne:v.dNaN;if(this.mag<0||this.eq(v.dZero))return v.dNegOne;let t=0,n=v.fromDecimal(this);if(n.layer-e.layer>3){const i=n.layer-e.layer-3;t+=i,n.layer-=i}for(let i=0;i<100;++i)if(n.lt(v.dZero))n=v.pow(e,n),t-=1;else{if(n.lte(v.dOne))return v.fromNumber(t+v.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=v.log(n,e)}return v.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:v.critical_section(e,t,Tr)}static tetrate_critical(e,t){return v.critical_section(e,t,xr)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let i=0,r=0;for(let a=0;a<at.length;++a)if(at[a]==e){i=n[a][Math.floor(t)],r=n[a][Math.ceil(t)];break}else if(at[a]<e&&at[a+1]>e){const l=(e-at[a])/(at[a+1]-at[a]);i=n[a][Math.floor(t)]*(1-l)+n[a+1][Math.floor(t)]*l,r=n[a][Math.ceil(t)]*(1-l)+n[a+1][Math.ceil(t)]*l;break}const o=t-Math.floor(t);return i<=0||r<=0?i*(1-o)+r*o:Math.pow(e,Math.log(i)/Math.log(e)*(1-o)+Math.log(r)/Math.log(e)*o)}layeradd10(e){e=v.fromValue_noAlloc(e).toNumber();const t=v.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let i=0;i<100;++i){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const i=this.slog(t).toNumber()+e;return i>=0?v.tetrate(t,i):Number.isFinite(i)?i>=-1?v.log(v.tetrate(t,i+1),t):v.log(v.log(v.tetrate(t,i+2),t),t):v.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return v.fromNumber(Pn(this.toNumber()));if(this.layer===0)return v.fromNumber(Pn(this.sign*this.mag));if(this.layer===1)return Fn(this);if(this.layer===2)return Fn(this);if(this.layer>=3)return H(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return H(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=H(1,0,1)){t=C(t);const n=e;e=Math.trunc(e);const i=n-e;i!==0&&(t.eq(v.dOne)?(++e,t=v.fromNumber(i)):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let r=0;r<e;++r){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(r>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.sin(this.sign*this.mag)):H(0,0,0)}cos(){return this.mag<0?v.dOne:this.layer===0?v.fromNumber(Math.cos(this.sign*this.mag)):H(0,0,0)}tan(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.tan(this.sign*this.mag)):H(0,0,0)}asin(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.asin(this.sign*this.mag)):H(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?v.fromNumber(Math.acos(this.toNumber())):this.layer===0?v.fromNumber(Math.acos(this.sign*this.mag)):H(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.atan(this.sign*this.mag)):v.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return v.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return v.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?H(Number.NaN,Number.NaN,Number.NaN):v.ln(this.add(1).div(v.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(v.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let c=v;c.fromStringCache=new _r(Mr);c.dZero=H(0,0,0);c.dOne=H(1,0,1);c.dNegOne=H(-1,0,1);c.dTwo=H(1,0,2);c.dTen=H(1,0,10);c.dNaN=H(Number.NaN,Number.NaN,Number.NaN);c.dInf=H(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);c.dNegInf=H(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);c.dNumberMax=U(1,0,Number.MAX_VALUE);c.dNumberMin=U(1,0,Number.MIN_VALUE);C=c.fromValue_noAlloc;U=c.fromComponents;H=c.fromComponents_noNormalize;c.fromMantissaExponent;c.fromMantissaExponent_noNormalize;const Fr=new c(1);function It(e,t,n=!0){let i=c.log10(e).floor(),r=c.div(e,c.pow(10,i));r.toStringWithDecimalPlaces(t)==="10"&&(r=Fr,i=i.add(1));const o=i.gte(1e9)?xe(i,Math.max(Math.max(t,3),X.defaultDecimalsShown)):i.gte(1e4)?Gt(i,0):i.toStringWithDecimalPlaces(0);return n?r.toStringWithDecimalPlaces(t)+"e"+o:"e"+o}function Gt(e,t){if(e==null)return"NaN";if(e=new c(e),e.mag<.001)return 0 .toFixed(t);const i=e.toStringWithDecimalPlaces(t).split(".");return i[0]=i[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),i.length==1?i[0]:i[0]+"."+i[1]}function Wn(e,t){return e==null?"NaN":(e=new c(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),X.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const Dr=new c("eeee1000"),Ar=new c("e100000"),Dn=new c("e1000"),Hn=new c(1e9),Er=new c(1e6),Or=new c(1e3),Vr=new c(.98),qr=new c(.001),Zn=new c(0);function xe(e,t,n){if(t==null&&(t=X.defaultDecimalsShown),n=n!=null?n:X.defaultShowSmall,e=new c(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+xe(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(Dr)){const i=e.slog();return i.gte(Er)?"F"+xe(i.floor()):c.pow(10,i.sub(i.floor())).toStringWithDecimalPlaces(3)+"F"+Gt(i.floor(),0)}else{if(e.gte(Ar))return It(e,0,!1);if(e.gte(Dn))return It(e,0);if(e.gte(Hn))return It(e,t);if(e.gte(Or))return Gt(e,0);if(e.gte(qr)||!n)return Wn(e,t);if(e.eq(Zn))return 0 .toFixed(t)}return e=Jn(e),e.lt(Dn)?It(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):xe(e,t)+"\u207B\xB9"}function Me(e){return e=new c(e),e.sign<0?"-"+Me(e.neg()):e.gte(Hn)||e.lte(Vr)&&!e.eq(Zn)?xe(e):xe(e,0)}function Yn(e){return c.lt(e,0)?"-"+Yn(c.neg(e)):c.gt(e,2**51)?xe(c.div(e,31536e3))+"y":(e=new c(e).toNumber(),e<60?xe(e)+"s":e<3600?Me(Math.floor(e/60))+"m "+xe(e%60)+"s":e<86400?Me(Math.floor(e/3600))+"h "+Me(Math.floor(e/60)%60)+"m "+Me(e%60)+"s":e<31536e3?Me(Math.floor(e/84600)%365)+"d "+Me(Math.floor(e/3600)%24)+"h "+Me(Math.floor(e/60)%60)+"m":Me(Math.floor(e/31536e3))+"y "+Me(Math.floor(e/84600)%365)+"d "+Me(Math.floor(e/3600)%24)+"h")}function Br(e,t,n){e=new c(e);let i=e.toStringWithDecimalPlaces(t);return new c(i).gte(n)&&(i=c.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),i}function Lr(e,t){return xe(e,t,!0)}function Jn(e){let t=c.log10(e).ceil();const n=c.div(e,c.pow(10,t));return t=t.neg(),e=new c(10).pow(t).times(n),e}var Rr=Object.freeze(Object.defineProperty({__proto__:null,default:c,exponentialFormat:It,commaFormat:Gt,regularFormat:Wn,format:xe,formatWhole:Me,formatTime:Yn,toPlaces:Br,formatSmall:Lr,invertOOM:Jn},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:zr,commaFormat:Ur,regularFormat:jr,format:ye,formatWhole:gt,formatTime:Kt,toPlaces:Gr,formatSmall:mn,invertOOM:Wr}=Rr;window.Decimal=c;window.exponentialFormat=zr;window.commaFormat=Ur;window.regularFormat=jr;window.format=ye;window.formatWhole=gt;window.formatTime=Kt;window.toPlaces=Gr;window.formatSmall=mn;window.invertOOM=Wr;function pn(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function Hr(e){return(e[0]+e.slice(1).replace(/[A-Z]/g,t=>`-${t}`)).toLowerCase()}function Wt(e){return typeof e=="function"}var j=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(j||{});const Tt=Symbol("DoNotCache");function F(e,t){const n=e[t];Wt(n)&&n.length===0&&!n[Tt]?e[t]=M(n.bind(e)):Wt(n)&&(e[t]=n.bind(e),e[t][Tt]=!0)}function _e(e){return Wt(e)&&!e[Tt]&&(e=M(e)),e}const Be=Symbol("Component"),Le=Symbol("GatherProps");let Zr=0;function Nt(e="feature-"){return e+Zr++}var pe=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(pe||{});function it(e){const t=s(e);return t!==2&&t!==!1}function Xt(e){return s(e)===1}function Z(e){return e[Tt]=!0,e}function K(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}function Yr(e,...t){const n=[],i=r=>{Object.keys(r).forEach(o=>{const a=r[o];a!=null&&typeof a=="object"&&(t.includes(a.type)?n.push(a):!(a instanceof c)&&!de(a)&&i(a))})};return i(e),n}var le=window.state=cn({lastTenTicks:[],hasNaN:!1,NaNPath:[],errors:_t([])});const lt={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!0,mergeAdjacent:!0,showPin:!0};var hn=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e))(hn||{}),Se={classic:lt,paper:{...lt,variables:{...lt.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"},floatingTabs:!1},nordic:{...lt,variables:{...lt.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"},floatingTabs:!1},aqua:{...lt,variables:{...lt.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}}};const ve=zn();"fonts"in document&&(document.fonts.onloadingdone=()=>ve.emit("fontsLoaded"));var Jr=Object.freeze(Object.defineProperty({__proto__:null,globalBus:ve},Symbol.toStringTag,{value:"Module"}));function Kn(e={}){return Object.assign({id:`${X.id}-0`,name:"Default Save",tabs:X.initialTabs.slice(),time:Date.now(),autosave:!0,offlineProd:!0,offlineTime:0,timePlayed:0,keepGoing:!1,modID:X.id,modVersion:X.versionNumber,layers:{}},e)}function ke(e){const t=We.compressToUTF16(fn(e!=null?e:E));return localStorage.setItem((e!=null?e:E).id,t),t}async function Kr(){es();try{let e=localStorage.getItem(J.active);if(e==null){await ut(bt());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=We.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==X.id){await ut(bt());return}t.id=J.active,await ut(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await ut(bt())}}function bt(){const e=Rt(),t=Kn({id:e});return ke(t),J.saves.push(e),t}function Rt(){let e,t=0;do e=`${X.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const Xr=O(!1);async function ut(e){console.info("Loading save",e),Xr.value=!0;const{layers:t,removeLayer:n,addLayer:i}=await xt(()=>Promise.resolve().then(function(){return Jo}),void 0),{fixOldSave:r,getInitialLayers:o}=await xt(()=>Promise.resolve().then(function(){return Ic}),void 0);for(const a in t){const l=t[a];l&&n(l)}o(e).forEach(a=>i(a,e)),e=Kn(e),e.offlineProd&&e.time!=null&&e.time&&e.devSpeed!==0&&(e.offlineTime==null&&(e.offlineTime=0),e.offlineTime+=Math.min(e.offlineTime+(Date.now()-e.time)/1e3,X.offlineLimit*3600)),e.time=Date.now(),e.modVersion!==X.versionNumber&&(r(e.modVersion,e),e.modVersion=X.versionNumber),Object.assign(E,e),J.active=E.id,ve.emit("onLoad")}setInterval(()=>{E.autosave&&ke()},1e3);window.onbeforeunload=()=>{E.autosave&&ke()};window.save=ke;const Qr=window.hardReset=async()=>{await ut(bt())};window.deleteLowerSaves=()=>{const e=Object.values(J.saves).indexOf(E.id)+1;Object.values(J.saves).slice(e).forEach(t=>localStorage.removeItem(t)),J.saves=J.saves.slice(0,e)};const Pt=_t({active:"",saves:[],showTPS:!0,theme:hn.Nordic,unthrottled:!1,alignUnits:!1});ze(Pt,e=>{const t=We.compressToUTF16(JSON.stringify(e));localStorage.setItem(X.id,t)},{deep:!0});var J=window.settings=Pt;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:hn.Nordic,alignUnits:!1};ve.emit("loadSettings",e),Object.assign(Pt,e),Qr()};function es(){try{let e=localStorage.getItem(X.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=We.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(Pt,t)}ve.emit("loadSettings",Pt)}catch{}}const Xn=_t([]);function ts(e){Xn.push(e)}const ns=_t([]),is=_t([]),rs={class:"table"},ss=L({__name:"Column",setup(e){const t=M(()=>Se[J.theme].mergeAdjacent);return(n,i)=>(_(),k("div",rs,[b("div",{class:se(["col",{mergeAdjacent:s(t)}])},[Ve(n.$slots,"default")],2)]))}}),os={class:"table"},Qn=L({__name:"Row",setup(e){const t=M(()=>Se[J.theme].mergeAdjacent);return(n,i)=>(_(),k("div",os,[b("div",{class:se(["row",{mergeAdjacent:s(t)}])},[Ve(n.$slots,"default")],2)]))}});function ei(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vi(e)}function Q(e,t="span"){return typeof e=="function"?L({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),L({template:e})):L({render:()=>({})}):e}function mt(e){if(rt(e))return typeof e=="function"?e():Q(e);const t=e[Be];return p(t,e[Le](),null)}function An(...e){let t;return p(Qn,null,ei(t=e.map(mt))?t:{default:()=>[t]})}function En(...e){let t;return p(ss,null,ei(t=e.map(mt))?t:{default:()=>[t]})}function Re(e){if(rt(e))return typeof e=="function"?e():typeof e=="string"?p(z,null,[e]):p(e,null,null);const t=e[Be];return p(t,e[Le](),null)}function On(e,t){return e.reduce((n,i)=>p(z,null,[n,t,i]))}function rt(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[Tt]===!0}function ti(e,t){const n=O(null),i=O(void 0);function r(l){n.value||(n.value=setInterval(a,250)),i.value=l}function o(){n.value&&(clearInterval(n.value),n.value=null)}function a(){t&&t.value?t.value():e&&e.value&&e.value(i.value)}return Rn(o),{start:r,stop:o,handleHolding:a}}function as(e,t="div"){const n=$e();return qe(()=>{n.value=Q(we(e),t)}),n}function wt(e,t="div"){const n=$e(null);return qe(()=>{const i=we(e);n.value=i==""||i==null?null:Q(i,t)}),n}function we(e){return s(s(e))}function B(...e){return e.includes(Object)||e.push(Object),e}function ni(e){return Object.keys(e).reduce((t,n)=>(t[Hr(n)]=e[n],t),{})}const ls=L({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var h;const n=O({}),i=new ResizeObserver(l),r=O(null);Dt(()=>{const g=r.value;g!=null&&i.observe(g)});let o=!0,a=O((h=r.value)==null?void 0:h.getBoundingClientRect());function l(){o&&(o=!1,ft(()=>{var g;a.value=(g=r.value)==null?void 0:g.getBoundingClientRect(),Object.values(n.value).filter(m=>m).forEach(m=>m.rect=m.element.getBoundingClientRect()),t("updateNodes",n.value),o=!0}))}ve.on("fontsLoaded",l);const u={attributes:!1,childList:!0,subtree:!1};Ot(vn,(g,m)=>{const y=new MutationObserver(()=>f(g));y.observe(m,u),n.value[g]={element:m,observer:y,rect:m.getBoundingClientRect()},l()}),Ot(bn,g=>{var m;(m=n.value[g])==null||m.observer.disconnect(),n.value[g]=void 0,l()}),Ot(yn,n),Ot(_n,a);function f(g){const m=n.value[g];m!=null&&(m.rect=m.element.getBoundingClientRect(),t("updateNodes",n.value))}return(g,m)=>(_(),k(z,null,[Ve(g.$slots,"default",{},void 0,!0),b("div",{ref_key:"resizeListener",ref:r,class:"resize-listener"},null,512)],64))}});var ii=ee(ls,[["__scopeId","data-v-2b1dc1bc"]]);const us=["onPointerdown"],cs={class:"modal-wrapper"},ds={class:"modal-container"},fs={class:"modal-header"},gs={class:"modal-body"},ms={class:"modal-footer"},ps=b("div",{class:"modal-default-flex-grow"},null,-1),st=L({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const r=ue(e),o=M(()=>s(r.modelValue)||l.value);function a(){n("update:modelValue",!1)}const l=O(!1),u=O(null),f=M(()=>{var h,g;return(g=(h=u.value)==null?void 0:h.nodes)!=null?g:null});return t({isOpen:o,nodes:f}),(h,g)=>(_(),G(yi,{to:"#modal-root"},[p($t,{name:"modal",onBeforeEnter:g[0]||(g[0]=m=>l.value=!0),onAfterLeave:g[1]||(g[1]=m=>l.value=!1)},{default:q(()=>[dn(b("div",He({class:"modal-mask",onPointerdown:yt(a,["self"])},h.$attrs),[b("div",cs,[b("div",ds,[b("div",fs,[Ve(h.$slots,"header",{shown:s(o)},()=>[D(" default header ")])]),b("div",gs,[p(ii,{ref_key:"contextRef",ref:u},{default:q(()=>[Ve(h.$slots,"body",{shown:s(o)},()=>[D(" default body ")])]),_:3},512)]),b("div",ms,[Ve(h.$slots,"footer",{shown:s(o)},()=>[b("div",{class:"modal-default-footer"},[ps,b("button",{class:"button modal-default-button",onClick:a}," Close ")])])])])])],16,us),[[bi,e.modelValue]])]),_:3})]))}}),Ke=Symbol("ProxyState");function Te(e,t={}){const n=t;let i=!1,r=!1;function o(){return i||(r&&console.error("Cyclical dependency detected. Cannot evaluate lazy proxy."),r=!0,Object.assign(n,e.call(n,n)),i=!0),n}return new Proxy(n,{get(a,l){if(l===Ke)return o();const u=o()[l];return u!=null&&typeof u=="object"&&Oe in u?u[Oe]:u},set(a,l,u){return o()[l]=u,!0},has(a,l){return l===Ke?!0:Reflect.has(o(),l)},ownKeys(){return Reflect.ownKeys(o())},getOwnPropertyDescriptor(a,l){return i||(Object.assign(n,e.call(n,n)),i=!0),Object.getOwnPropertyDescriptor(a,l)}})}const ri=c.ln(10);function zt(e){return e}function kt(e,...t){const n=t.find(i=>x(i));return n==null?(console.error("Could not invert due to no input being a variable"),0):n.invert(e)}function hs(e,t){return x(t)?t.invert(c.neg(e)):(console.error("Could not invert due to no input being a variable"),0)}function vs(e,t){return x(t)?t.isIntegrable()?d.neg(t.getIntegralFormula(e)):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function bs(e){return d.neg(e)}function ys(e,t,n){return x(t)?t.invert(c.sub(e,ce(n))):x(n)?n.invert(c.sub(e,ce(t))):(console.error("Could not invert due to no input being a variable"),0)}function _s(e,t,n){var i,r;if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const o=t.getIntegralFormula(e);return d.times(n,(i=t.innermostVariable)!=null?i:0).add(o)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const o=n.getIntegralFormula(e);return d.times(t,(r=n.innermostVariable)!=null?r:0).add(o)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ns(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.add(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.add(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ws(e,t,n){return x(t)?t.invert(c.add(e,ce(n))):x(n)?n.invert(c.sub(ce(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Cs(e,t,n){var i,r;if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const o=t.getIntegralFormula(e);return d.sub(o,d.times(n,(i=t.innermostVariable)!=null?i:0))}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const o=n.getIntegralFormula(e);return d.times(t,(r=n.innermostVariable)!=null?r:0).sub(o)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ks(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.sub(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.sub(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ss(e,t,n){return x(t)?t.invert(c.div(e,ce(n))):x(n)?n.invert(c.div(e,ce(t))):(console.error("Could not invert due to no input being a variable"),0)}function Is(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.times(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.times(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ms(e,t,n){return x(t)?d.div(e,n):x(n)?d.div(e,t):(console.error("Could not apply substitution due to no input being a variable"),d.constant(0))}function $s(e,t,n){return x(t)?t.invert(c.mul(e,ce(n))):x(n)?n.invert(c.div(ce(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function xs(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.div(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.div(t,i)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ts(e,t,n){return x(t)?d.mul(e,n):x(n)?d.mul(e,t):(console.error("Could not apply substitution due to no input being a variable"),d.constant(0))}function Ps(e,t){return x(t)?t.invert(c.recip(e)):(console.error("Could not invert due to no input being a variable"),0)}function Fs(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.ln(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ds(e,t){return x(t)?t.invert(c.pow10(e)):(console.error("Could not invert due to no input being a variable"),0)}function As(e){return c.ln(e).sub(1).times(e).div(ri)}function Es(e,t){if(x(t)){const n=ri.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Os(e,t){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:As,invert:Es}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Vs(e,t,n){return x(t)?t.invert(c.pow(ce(n),e)):x(n)?n.invert(c.root(ce(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function qs(e,t){return c.ln(e).sub(1).times(e).div(c.ln(t))}function Bs(e,t,n){if(x(t)){const i=c.ln(ce(n)).times(e);return t.invert(i.div(i.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Ls(e,t,n){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e),n],evaluate:qs,invert:Bs}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Rs(e,t){return x(t)?t.invert(c.pow(2,e)):(console.error("Could not invert due to no input being a variable"),0)}function zs(e){return c.ln(e).sub(1).times(e).div(c.ln(2))}function Us(e,t){if(x(t)){const n=c.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function js(e,t){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:zs,invert:Us}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Gs(e,t){return x(t)?t.invert(c.exp(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ws(e){return c.ln(e).sub(1).times(e)}function Hs(e,t){return x(t)?t.invert(c.div(e,c.div(e,Math.E).lambertw())):(console.error("Could not invert due to no input being a variable"),0)}function Zs(e,t){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:Ws,invert:Hs}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Ys(e,t,n){return x(t)?t.invert(c.root(e,ce(n))):x(n)?n.invert(c.ln(e).div(c.ln(ce(t)))):(console.error("Could not invert due to no input being a variable"),0)}function Js(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e),r=d.add(n,1);return d.pow(i,r).div(r)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.pow(t,i).div(d.ln(t))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ks(e,t){return x(t)?t.invert(c.root(e,10)):(console.error("Could not invert due to no input being a variable"),0)}function Xs(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.pow10(n).div(d.ln(10))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Qs(e,t,n){return x(t)?t.invert(c.ln(e).div(c.ln(ce(n)))):x(n)?n.invert(c.root(ce(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function eo(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.pow(n,i).div(d.ln(n))}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e),r=d.add(t,1);return d.pow(i,r).div(r)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function to(e,t,n){return x(t)?t.invert(c.root(e,c.recip(ce(n)))):x(n)?n.invert(c.ln(ce(t)).div(c.ln(e))):(console.error("Could not invert due to no input being a variable"),0)}function no(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.pow(i,d.recip(n).add(1)).times(n).div(d.add(n,1))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function io(e,t){return x(t)?t.invert(c.ln(e)):(console.error("Could not invert due to no input being a variable"),0)}function ro(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.exp(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function so(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){const i=c.minabs(t,1e308).toNumber();return c.tetrate(e,i,n)}function oo(e,t,n,i){return x(t)?t.invert(c.ssqrt(e)):(console.error("Could not invert due to no input being a variable"),0)}function ao(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){const i=c.minabs(t,1e308).toNumber();return c.iteratedexp(e,i,new c(n))}function lo(e,t,n,i){return x(t)?t.invert(c.iteratedlog(e,Math.E,c.minabs(1e308,ce(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function uo(e,t=10,n=2){const i=c.minabs(n,1e308).toNumber();return c.iteratedlog(e,t,i)}function co(e,t=10){const n=c.minabs(t,1e308).toNumber();return c.slog(e,n)}function fo(e,t,n){return x(t)?t.invert(c.tetrate(e,c.minabs(1e308,ce(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function go(e,t,n){const i=c.minabs(t,1e308).toNumber();return c.layeradd(e,i,n)}function mo(e,t,n,i){return x(t)?t.invert(c.layeradd(e,c.minabs(1e308,ce(n)).negate().toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function po(e,t){return x(t)?t.invert(c.pow(Math.E,e).times(e)):(console.error("Could not invert due to no input being a variable"),0)}function ho(e,t){return x(t)?t.invert(c.tetrate(e,2)):(console.error("Could not invert due to no input being a variable"),0)}function vo(e,t,n){const i=c.minabs(t,1e308).toNumber();return c.pentate(e,i,n)}function bo(e,t){return x(t)?t.invert(c.asin(e)):(console.error("Could not invert due to no input being a variable"),0)}function yo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cos(n).neg()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function _o(e,t){return x(t)?t.invert(c.acos(e)):(console.error("Could not invert due to no input being a variable"),0)}function No(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.sin(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function wo(e,t){return x(t)?t.invert(c.atan(e)):(console.error("Could not invert due to no input being a variable"),0)}function Co(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cos(n).ln().neg()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ko(e,t){return x(t)?t.invert(c.sin(e)):(console.error("Could not invert due to no input being a variable"),0)}function So(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.asin(n).times(n).add(d.sqrt(d.sub(1,d.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Io(e,t){return x(t)?t.invert(c.cos(e)):(console.error("Could not invert due to no input being a variable"),0)}function Mo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.acos(n).times(n).sub(d.sqrt(d.sub(1,d.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function $o(e,t){return x(t)?t.invert(c.tan(e)):(console.error("Could not invert due to no input being a variable"),0)}function xo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.atan(n).times(n).sub(d.ln(d.pow(n,2).add(1)).div(2))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function To(e,t){return x(t)?t.invert(c.asinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Po(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cosh(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Fo(e,t){return x(t)?t.invert(c.acosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Do(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.sinh(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ao(e,t){return x(t)?t.invert(c.atanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Eo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cosh(n).ln()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Oo(e,t){return x(t)?t.invert(c.sinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Vo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.asinh(n).times(n).sub(d.pow(n,2).add(1).sqrt())}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function qo(e,t){return x(t)?t.invert(c.cosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Bo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.acosh(n).times(n).sub(d.add(n,1).sqrt().times(d.sub(n,1).sqrt()))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Lo(e,t){return x(t)?t.invert(c.tanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ro(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.atanh(n).times(n).add(d.sub(1,d.pow(n,2)).ln().div(2))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ct(e){return(t,n)=>new d({inputs:[t,n],evaluate:e,invert:zt})}function x(e){return e instanceof oe&&e.hasVariable()}function ce(e,t){return e instanceof oe?e.evaluate(t):s(e)}function zo(){return d.pow(this,2).div(2)}function Uo(){return this}const fe=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"inputs"in e&&(e.inputs=e.inputs.map(n=>typeof n=="object"&&Oe in n?n[Oe]:n)),"variable"in e?(typeof e.variable=="object"&&Oe in e.variable&&(e.variable=e.variable[Oe]),t=this.setupVariable(e)):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:zo,internalIntegrateInner:Uo,applySubstitution:zt}}setupConstant({inputs:e}){return e.length!==1&&console.error("Evaluate function is required if inputs is not length 1"),{inputs:e,internalVariables:0}}setupFormula(e){var m,y;const{inputs:t,evaluate:n,invert:i,integrate:r,integrateInner:o,applySubstitution:a}=e,l=t.reduce((w,N)=>w+(N instanceof fe?N.internalVariables:0),0),u=t.find(w=>w instanceof fe&&w.hasVariable()),f=l===1?u==null?void 0:u.innermostVariable:void 0,h=(m=u==null?void 0:u.isInvertible())!=null?m:!1,g=(y=u==null?void 0:u.isIntegrable())!=null?y:!1;return{inputs:t,internalEvaluate:n,internalInvert:h?i:void 0,internalIntegrate:g?r:void 0,internalIntegrateInner:o,applySubstitution:a,innermostVariable:f,internalVariables:l}}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,i;return(i=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(r=>ce(r,e))))!=null?n:this.hasVariable()?e:null)!=null?i:ce(this.inputs[0])}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof fe&&e.inputs[n]instanceof fe?t.equals(e.inputs[n]):!(t instanceof fe)&&!(e.inputs[n]instanceof fe)&&c.eq(s(t),s(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new d({inputs:[e]})}static variable(e){return new d({variable:e})}static step(e,t,n){const i=n(d.variable(0)),r=_e(t);function o(l){return c.lt(l,s(r))?l:c.add(i.evaluate(c.sub(l,s(r))),s(r))}function a(l,u){return x(u)&&i.isInvertible()?(c.gt(l,s(r))&&(l=c.add(i.invert(c.sub(l,s(r))),s(r))),u.invert(l)):(console.error("Could not invert due to no input being a variable"),0)}return new d({inputs:[e],evaluate:o,invert:i.isInvertible()&&i.hasVariable()?a:void 0})}static if(e,t,n,i){const r=O(0),o=d.variable(r),a=n(o),l=i==null?void 0:i(o),u=_e(t);function f(g){return s(u)?(r.value=g,a.evaluate()):l?(r.value=g,l.evaluate()):g}function h(g,m){return!x(m)||!a.isInvertible()||l!=null&&!l.isInvertible()?(console.error("Could not invert due to no input being a variable"),0):s(u)?m.invert(a.invert(g)):l?m.invert(l.invert(g)):m.invert(g)}return new d({inputs:[e],evaluate:f,invert:a.isInvertible()&&a.hasVariable()?h:void 0})}static conditional(e,t,n,i){return d.if(e,t,n,i)}static abs(e){return new d({inputs:[e],evaluate:c.abs})}static neg(e){return new d({inputs:[e],evaluate:c.neg,invert:hs,applySubstitution:bs,integrate:vs})}static sign(e){return new d({inputs:[e],evaluate:c.sign})}static round(e){return new d({inputs:[e],evaluate:c.round,invert:kt})}static floor(e){return new d({inputs:[e],evaluate:c.floor,invert:kt})}static ceil(e){return new d({inputs:[e],evaluate:c.ceil,invert:kt})}static trunc(e){return new d({inputs:[e],evaluate:c.trunc,invert:kt})}static add(e,t){return new d({inputs:[e,t],evaluate:c.add,invert:ys,integrate:_s,integrateInner:Ns,applySubstitution:zt})}static sub(e,t){return new d({inputs:[e,t],evaluate:c.sub,invert:ws,integrate:Cs,integrateInner:ks,applySubstitution:zt})}static mul(e,t){return new d({inputs:[e,t],evaluate:c.mul,invert:Ss,integrate:Is,applySubstitution:Ms})}static div(e,t){return new d({inputs:[e,t],evaluate:c.div,invert:$s,integrate:xs,applySubstitution:Ts})}static recip(e){return new d({inputs:[e],evaluate:c.recip,invert:Ps,integrate:Fs})}static clamp(e,t,n){return new d({inputs:[e,t,n],evaluate:c.clamp,invert:kt})}static pLog10(e){return new d({inputs:[e],evaluate:c.pLog10})}static absLog10(e){return new d({inputs:[e],evaluate:c.absLog10})}static log10(e){return new d({inputs:[e],evaluate:c.log10,invert:Ds,integrate:Os})}static log(e,t){return new d({inputs:[e,t],evaluate:c.log,invert:Vs,integrate:Ls})}static log2(e){return new d({inputs:[e],evaluate:c.log2,invert:Rs,integrate:js})}static ln(e){return new d({inputs:[e],evaluate:c.ln,invert:Gs,integrate:Zs})}static pow(e,t){return new d({inputs:[e,t],evaluate:c.pow,invert:Ys,integrate:Js})}static pow10(e){return new d({inputs:[e],evaluate:c.pow10,invert:Ks,integrate:Xs})}static pow_base(e,t){return new d({inputs:[e,t],evaluate:c.pow_base,invert:Qs,integrate:eo})}static root(e,t){return new d({inputs:[e,t],evaluate:c.root,invert:to,integrate:no})}static factorial(e){return new d({inputs:[e],evaluate:c.factorial})}static gamma(e){return new d({inputs:[e],evaluate:c.gamma})}static lngamma(e){return new d({inputs:[e],evaluate:c.lngamma})}static exp(e){return new d({inputs:[e],evaluate:c.exp,invert:io,integrate:ro})}static sqr(e){return d.pow(e,2)}static sqrt(e){return d.root(e,2)}static cube(e){return d.pow(e,3)}static cbrt(e){return d.root(e,3)}static tetrate(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:so,invert:oo})}static iteratedexp(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:ao,invert:lo})}static iteratedlog(e,t=10,n=1){return new d({inputs:[e,t,n],evaluate:uo})}static slog(e,t=10){return new d({inputs:[e,t],evaluate:co,invert:fo})}static layeradd10(e,t){return new d({inputs:[e,t],evaluate:c.layeradd10})}static layeradd(e,t,n=10){return new d({inputs:[e,t,n],evaluate:go,invert:mo})}static lambertw(e){return new d({inputs:[e],evaluate:c.lambertw,invert:po})}static ssqrt(e){return new d({inputs:[e],evaluate:c.ssqrt,invert:ho})}static pentate(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:vo})}static sin(e){return new d({inputs:[e],evaluate:c.sin,invert:ko,integrate:yo})}static cos(e){return new d({inputs:[e],evaluate:c.cos,invert:Io,integrate:No})}static tan(e){return new d({inputs:[e],evaluate:c.tan,invert:$o,integrate:Co})}static asin(e){return new d({inputs:[e],evaluate:c.asin,invert:bo,integrate:So})}static acos(e){return new d({inputs:[e],evaluate:c.acos,invert:_o,integrate:Mo})}static atan(e){return new d({inputs:[e],evaluate:c.atan,invert:wo,integrate:xo})}static sinh(e){return new d({inputs:[e],evaluate:c.sinh,invert:Oo,integrate:Po})}static cosh(e){return new d({inputs:[e],evaluate:c.cosh,invert:qo,integrate:Do})}static tanh(e){return new d({inputs:[e],evaluate:c.tanh,invert:Lo,integrate:Eo})}static asinh(e){return new d({inputs:[e],evaluate:c.asinh,invert:To,integrate:Vo})}static acosh(e){return new d({inputs:[e],evaluate:c.acosh,invert:Fo,integrate:Bo})}static atanh(e){return new d({inputs:[e],evaluate:c.atanh,invert:Ao,integrate:Ro})}step(e,t){return d.step(this,e,t)}if(e,t){return d.if(this,e,t)}conditional(e,t){return d.if(this,e,t)}abs(){return d.abs(this)}neg(){return d.neg(this)}sign(){return d.sign(this)}round(){return d.round(this)}floor(){return d.floor(this)}ceil(){return d.ceil(this)}trunc(){return d.trunc(this)}add(e){return d.add(this,e)}sub(e){return d.sub(this,e)}mul(e){return d.mul(this,e)}div(e){return d.div(this,e)}recip(){return d.recip(this)}max(e){return d.max(this,e)}min(e){return d.min(this,e)}maxabs(e){return d.maxabs(this,e)}minabs(e){return d.minabs(this,e)}clamp(e,t){return d.clamp(this,e,t)}clampMin(e){return d.clampMin(this,e)}clampMax(e){return d.clampMax(this,e)}pLog10(){return d.pLog10(this)}absLog10(){return d.absLog10(this)}log10(){return d.log10(this)}log(e){return d.log(this,e)}log2(){return d.log2(this)}ln(){return d.ln(this)}pow(e){return d.pow(this,e)}pow10(){return d.pow10(this)}pow_base(e){return d.pow_base(this,e)}root(e){return d.root(this,e)}factorial(){return d.factorial(this)}gamma(){return d.gamma(this)}lngamma(){return d.lngamma(this)}exp(){return d.exp(this)}sqr(){return d.pow(this,2)}sqrt(){return d.root(this,2)}cube(){return d.pow(this,3)}cbrt(){return d.root(this,3)}tetrate(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.tetrate(this,e,t)}iteratedexp(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return d.iteratedlog(this,e,t)}slog(e=10){return d.slog(this,e)}layeradd10(e){return d.layeradd10(this,e)}layeradd(e,t){return d.layeradd(this,e,t)}lambertw(){return d.lambertw(this)}ssqrt(){return d.ssqrt(this)}pentate(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.pentate(this,e,t)}sin(){return d.sin(this)}cos(){return d.cos(this)}tan(){return d.tan(this)}asin(){return d.asin(this)}acos(){return d.acos(this)}atan(){return d.atan(this)}sinh(){return d.sinh(this)}cosh(){return d.cosh(this)}tanh(){return d.tanh(this)}asinh(){return d.asinh(this)}acosh(){return d.acosh(this)}atanh(){return d.atanh(this)}};let oe=fe;oe.negate=fe.neg;oe.negated=fe.neg;oe.sgn=fe.sign;oe.plus=fe.add;oe.subtract=fe.sub;oe.minus=fe.sub;oe.multiply=fe.mul;oe.times=fe.mul;oe.divide=fe.div;oe.divideBy=fe.div;oe.dividedBy=fe.div;oe.reciprocal=fe.recip;oe.reciprocate=fe.recip;oe.max=Ct(c.max);oe.min=Ct(c.min);oe.minabs=Ct(c.minabs);oe.maxabs=Ct(c.maxabs);oe.clampMin=Ct(c.clampMin);oe.clampMax=Ct(c.clampMax);oe.logarithm=fe.log;class d extends oe{invert(t){return this.internalInvert&&this.hasVariable()?this.internalInvert.call(this,t,...this.inputs):this.inputs.length===1&&this.hasVariable()?t:(console.error("Cannot invert non-invertible formula"),0)}evaluateIntegral(t){return this.isIntegrable()?this.getIntegralFormula().evaluate(t):(console.error("Cannot evaluate integral of formula without integral"),0)}invertIntegral(t){return!this.isIntegrable()||!this.getIntegralFormula().isInvertible()?(console.error("Cannot invert integral of formula without invertible integral"),0):this.getIntegralFormula().invert(t)}calculateConstantOfIntegration(){const t=this.getIntegralFormula().evaluate(1),n=c.add(this.evaluate(0),this.evaluate(1)).div(2);return c.sub(n,t)}getIntegralFormula(t){if(this.integralFormula!=null&&t==null)return this.integralFormula;if(t==null){if(this.applySubstitution==null){if(t=[],this.internalIntegrate==null)return console.error("Cannot integrate formula with non-integrable operation"),d.constant(0);let n=this.internalIntegrate.call(this,t,...this.inputs);t.forEach(i=>n=i(n)),this.integralFormula=n}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else return console.error("Cannot integrate formula without variable"),d.constant(0);return this.integralFormula}else return this.applySubstitution==null?(console.error("Cannot have two complex operations in an integrable formula"),d.constant(0)):(t.push(n=>this.applySubstitution.call(this,n,...this.inputs)),this.internalIntegrateInner?this.internalIntegrateInner.call(this,t,...this.inputs):this.internalIntegrate?this.internalIntegrate.call(this,t,...this.inputs):this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable()?this:(console.error("Cannot integrate formula without variable"),d.constant(0)))}}function jo(e,t,n=!0,i,r=c.dInf){const o=_e(n),a=_e(i),l=_e(r);return M(()=>{var m,y,w,N;const u=s(l);if(c.eq(u,1))return c.gte(t.value,e.evaluate())?c.dOne:c.dZero;const f=s(o),h=(m=s(a))!=null?m:f?10:0;let g=0;if(c.gt(u,h)){if(!e.isInvertible())return console.error("Cannot calculate max affordable of non-invertible formula with more maxBulkAmount than directSum"),0;if(f){if(!e.isIntegralInvertible())return console.error("Cannot calculate max affordable of formula with non-invertible integral"),0;g=c.floor(e.invertIntegral(c.add(t.value,e.evaluateIntegral()))).sub((y=s(e.innermostVariable))!=null?y:0)}else g=c.floor(e.invert(t.value))}if(g=c.clampMax(g,u),h>0){const I=g;g=c.sub(g,h).clampMin(0);let P;for(f?P=Ut(e,g,!0,0):P=e.evaluate(c.add((w=s(e.innermostVariable))!=null?w:0,g));c.lt(g,u)&&c.lt(g,Number.MAX_SAFE_INTEGER)&&c.add(I,1).gte(g);){const S=e.evaluate(g.add((N=s(e.innermostVariable))!=null?N:0));if(c.add(P,S).lte(t.value))g=g.add(1),P=c.add(P,S);else break}}return g})}function Ut(e,t,n=!0,i){var u;if(c.eq(t,1))return e.evaluate();const r=(u=s(e.innermostVariable))!=null?u:0;let o=c.add(t,r);const a=o;i!=null||(i=n?10:0),o=o.sub(i).clampMin(r);let l=0;if(c.gt(t,i)){if(!e.isInvertible())return console.error("Cannot calculate cost with indirect sum of non-invertible formula"),0;if(n){if(!e.isIntegrable())return console.error("Cannot calculate cost with cumulative cost of non-integrable formula"),0;if(l=c.sub(e.evaluateIntegral(o),e.evaluateIntegral()),a.gt(1e308))return c.add(l,c.sub(a,o).times(e.evaluate(o)))}else if(l=e.evaluate(o),o=o.add(1),a.gt(1e308))return c.sub(a,o).add(1).times(l)}for(let f=o.toNumber();f<a.toNumber();f++)l=c.add(l,e.evaluate(f));return l}const Qe=Symbol("PersistentState"),et=Symbol("DefaultValue"),Ht=Symbol("StackTrace"),Zt=Symbol("Deleted"),Oe=Symbol("NonPersistent"),ct=Symbol("SaveDataPath"),Ft=Symbol("SkipPersistence");function Go(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function Vn(e,t){var n;c.isNaN(t)&&(le.hasNaN||(E.autosave=!1,le.hasNaN=!0,le.NaNPath=e[ct],le.NaNPersistent=e),console.error(`Attempted to save NaN value to ${(n=e[ct])==null?void 0:n.join(".")}`)),e[Qe].value=t}function je(e,t=!0){const n=de(e)?e:O(e);de(e)&&(e=e.value);const i=M({get(){return n.value},set(o){t?Vn(r,o):r[Qe].value=o}});i[et]=e;const r={get value(){return n.value},set value(o){t?Vn(r,o):r[Qe].value=o},__v_isRef:!0,[Qe]:n,[et]:e,[Ht]:Go(),[Zt]:!1,[Oe]:i,[ct]:void 0};return Ce.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",r,`
Created at:
`+r[Ht]):dt[Ce[Ce.length-1]].add(r),r}function Wo(e){return e!=null&&typeof e=="object"&&Qe in e}function Vt(e){return!(Ke in e)&&Oe in e?e[Oe]:new Proxy(e,{get(t,n){if(n!==Qe)return n===Ft?!0:t[n]},set(t,n,i){return t[n]=i,!0},has(t,n){return n===Qe?!1:n==Ft?!0:Reflect.has(t,n)}})}function Ho(e){Ce.length===0?console.warn("Deleting a persistent ref outside of a layer. Ignoring...",e):dt[Ce[Ce.length-1]].delete(e),e[Zt]=!0}ve.on("addLayer",(e,t)=>{const n=[],i=(r,o=[])=>{let a=!1;return Object.keys(r).forEach(l=>{let u=r[l];if(u!=null&&typeof u=="object"){if(u[Ft]===!0)return;if(Ke in u&&(u=u[Ke]),Wo(u)){if(a=!0,u[Zt]){console.warn("Deleted persistent ref present in returned object. Ignoring...",u,`
Created at:
`+u[Ht]);return}dt[e.id].delete(u);const f=[e.id,...o,l];u[ct]!=null&&JSON.stringify(f)!==JSON.stringify(u[ct])&&console.error(`Persistent ref is being saved to \`${f.join(".")}\` when it's already present at \`${u[ct].join(".")}\`.`,"This can cause unexpected behavior when loading saves between updates."),u[ct]=f;const h=o.reduce((m,y)=>(y in m||(m[y]={}),m[y]),t),g=h[l];h[l]=u[Qe],_i(h)?g!=null?h[l]=g:h[l]=u[et]:g!=null?h[l].value=g:h[l].value=u[et]}else!(u instanceof c)&&!(u instanceof d)&&!de(u)&&!n.includes(u)&&(typeof u.type=="symbol"&&n.push(u),i(u,[...o,l])&&(Ue(u)&&!Ue(r)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",Ke in r?r[Ke]:r,l):a=!0))}}),a};i(e[Ke]),dt[e.id].forEach(r=>{r[Zt]||console.error(`Created persistent ref in ${e.id} without registering it to the layer!`,`Make sure to include everything persistent in the returned object.

Created at:
`+r[Ht])}),dt[e.id].clear()});const vn=Symbol("RegisterNode"),bn=Symbol("UnregisterNode"),yn=Symbol("Nodes"),_n=Symbol("Bounds"),Ne=cn({});window.layers=Ne;const dt={},Ce=[];function Nn(e,t){return Te(()=>{const n={},i=n.emitter=zn();if(n.on=i.on.bind(i),n.emit=i.emit.bind(i),n.nodes=O({}),n.id=e,Ce.push(e),dt[e]=new Set,n.minimized=je(!1,!1),Object.assign(n,t.call(n,n)),Ce[Ce.length-1]==null||Ce[Ce.length-1]!==e)throw new Error(`Adding layers stack in invalid state. This should not happen
Stack: ${Ce}
Trying to pop ${n.id}`);Ce.pop(),F(n,"color"),F(n,"display"),F(n,"classes"),F(n,"style"),F(n,"name"),K(n,"name",n.id),F(n,"minWidth"),K(n,"minWidth",600),F(n,"minimizable"),K(n,"minimizable",!0),F(n,"minimizedDisplay");const r=n.style;return n.style=M(()=>{var a,l;let o=s(n.minWidth);return(typeof o=="number"||!Number.isNaN(parseInt(o)))&&(o=o+"px"),[(a=s(r))!=null?a:"",(l=n.minimized)!=null&&l.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:o,flexBasis:o,margin:""}]}),n})}function wn(e,t){if(console.info("Adding layer",e.id),Ne[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,Ne[e.id]);return}K(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),Ne[e.id]=e,ve.emit("addLayer",e,t.layers[e.id])}function si(e){return Ne[e]}function Cn(e){console.info("Removing layer",e.id),ve.emit("removeLayer",e),Ne[e.id]=void 0}function Zo(e){Cn(e),wn(e,E)}function Yo(e){const t=O(!1);return{openModal:()=>t.value=!0,modal:Z(()=>p(st,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>p("h2",null,[s(e.name)]),body:s(e.display)}))}}ve.on("update",function(t){Object.values(Ne).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(Ne).forEach(n=>{n==null||n.emit("update",t)}),Object.values(Ne).forEach(n=>{n==null||n.emit("postUpdate",t)})});var Jo=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:vn,UnregisterNodeInjectionKey:bn,NodesInjectionKey:yn,BoundsInjectionKey:_n,layers:Ne,persistentRefs:dt,addingLayers:Ce,createLayer:Nn,addLayer:wn,getLayer:si,removeLayer:Cn,reloadLayer:Zo,setupLayerModal:Yo},Symbol.toStringTag,{value:"Module"}));const Ko=L({components:{Context:ii,ErrorVue:jn},props:{index:{type:Number,required:!0},display:{type:B(Object,String,Function),required:!0},minimizedDisplay:B(Object,String,Function),minimized:{type:Object,required:!0},name:{type:B(String),required:!0},color:B(String),minimizable:B(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:i,minimizedDisplay:r}=ue(e),o=as(t),a=wt(r),l=M(()=>X.allowGoBack&&n.value>0&&!we(i));function u(){E.tabs.splice(s(e.index),1/0)}function f(g){e.nodes.value=g}const h=O([]);return Ni((g,m,y)=>(console.warn(`Error caught in "${e.name}" layer`,g,m,y),h.value.push(g instanceof Error?g:new Error(JSON.stringify(g))),!1)),{component:o,minimizedComponent:a,showGoBack:l,updateNodes:f,unref:s,goBack:u,errors:h}}}),Xo={key:1};function Qo(e,t,n,i,r,o){const a=De("ErrorVue"),l=De("Context");return e.errors.length>0?(_(),G(a,{key:0,errors:e.errors},null,8,["errors"])):(_(),k("div",He({key:1,class:"layer-container",style:{"--layer-color":e.unref(e.color)}},e.$attrs),[e.showGoBack?(_(),k("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...u)=>e.goBack&&e.goBack(...u))},"\u274C")):A("",!0),e.unref(e.minimized)?(_(),k("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=u=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(_(),G(be(e.minimizedComponent),{key:0})):(_(),k("div",Xo,R(e.unref(e.name)),1))])):(_(),k("div",{key:2,class:se(["layer-tab",{showGoBack:e.showGoBack}])},[p(l,{onUpdateNodes:e.updateNodes},{default:q(()=>[(_(),G(be(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(_(),k("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=u=>e.$emit("setMinimized",!0))}," \u25BC ")):A("",!0)],16))}var ea=ee(Ko,[["render",Qo],["__scopeId","data-v-a9f5b1da"]]);const oi=e=>(tt("data-v-5adb7020"),e=e(),nt(),e),ta=oi(()=>b("h2",null,"Changelog",-1)),na=oi(()=>b("details",{open:""},[b("summary",null,[D("v0.0 Initial Commit - "),b("time",null,"2024-15-02")]),D(" This is the first release :D "),b("ul",null,[b("li",{class:"feature"},"Add Board"),b("li",{class:"feature"},"Add Base Cascade")])],-1)),ia=L({__name:"Changelog",setup(e,{expose:t}){const n=O(!1);return t({open(){n.value=!0}}),(i,r)=>(_(),G(st,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=o=>n.value=o)},{header:q(()=>[ta]),body:q(()=>[na]),_:1},8,["modelValue"]))}});var ra=ee(ia,[["__scopeId","data-v-5adb7020"]]),sa=L({props:{element:Object,display:{type:B(Object,String,Function),required:!0},style:B(Object,String,Array),classes:B(Object),direction:B(String),xoffset:B(String),yoffset:B(String),pinned:Object},setup(e){const{element:t,display:n,pinned:i}=ue(e),r=O(!1),o=M(()=>(we(i)||r.value)&&a.value),a=wt(n),l=$e(Q(Z(()=>{const h=we(t);return h==null?"":Re(h)})));function u(h){const g=i;h.shiftKey&&g&&(g.value=!g.value,h.stopPropagation(),h.preventDefault())}const f=M(()=>we(i)&&Se[J.theme].showPin);return{Direction:j,isHovered:r,isShown:o,comp:a,elementComp:l,unref:s,togglePinned:u,showPin:f}}});const oa={key:0,class:"material-icons pinned"};function aa(e,t,n,i,r,o){return _(),k("div",{class:se(["tooltip-container",{shown:e.isShown}]),onMouseenter:t[0]||(t[0]=a=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=a=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...a)=>e.togglePinned&&e.togglePinned(...a))},[Ve(e.$slots,"default",{},void 0,!0),e.elementComp?(_(),G(be(e.elementComp),{key:0})):A("",!0),p($t,{name:"fade"},{default:q(()=>{var a;return[e.isShown?(_(),k("div",{key:0,class:se(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:he([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(a=e.unref(e.style))!=null?a:{}])},[e.showPin?(_(),k("span",oa,"push_pin")):A("",!0),e.comp?(_(),G(be(e.comp),{key:1})):A("",!0)],6)):A("",!0)]}),_:1})],34)}var me=ee(sa,[["render",aa],["__scopeId","data-v-6102fa3a"]]);const pt=e=>(tt("data-v-10effbe8"),e=e(),nt(),e),la={class:"info-modal-header"},ua=["src","alt"],ca={class:"info-modal-title"},da={key:0},fa={key:0},ga={key:0},ma=pt(()=>b("div",null," Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb ",-1)),pa=pt(()=>b("br",null,null,-1)),ha=pt(()=>b("br",null,null,-1)),va=["href"],ba=pt(()=>b("span",{class:"material-icons info-modal-discord"},"discord",-1)),ya=pt(()=>b("div",null,[b("a",{href:"https://discord.gg/yJ4fjnjU54",class:"info-modal-discord-link",target:"_blank"},[b("span",{class:"material-icons info-modal-discord"},"discord"),D(" Profectus & Friends ")])],-1)),_a=pt(()=>b("div",null,[b("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[b("span",{class:"material-icons info-modal-discord"},"discord"),D(" The Modding Tree ")])],-1)),Na=pt(()=>b("br",null,null,-1));var wa=L({__name:"Info",props:{changelog:null},setup(e,{expose:t}){const n=e,{title:i,logo:r,author:o,discordName:a,discordLink:l,versionNumber:u,versionTitle:f}=X,h=ue(n),g=O(!1),m=M(()=>Kt(E.timePlayed)),y=M(()=>Q(Z(()=>p(z,null,[ns.map(mt)]))));t({open(){g.value=!0}});function w(){var N;(N=s(h.changelog))==null||N.open()}return(N,I)=>(_(),G(st,{modelValue:g.value,"onUpdate:modelValue":I[0]||(I[0]=P=>g.value=P)},{header:q(()=>[b("div",la,[s(r)?(_(),k("img",{key:0,class:"info-modal-logo",src:s(r),alt:s(i)},null,8,ua)):A("",!0),b("div",ca,[b("h2",null,R(s(i)),1),b("h4",null,[D(" v"+R(s(u)),1),s(f)?(_(),k("span",da,": "+R(s(f)),1)):A("",!0)])])])]),body:q(({shown:P})=>[P?(_(),k("div",fa,[s(o)?(_(),k("div",ga,"By "+R(s(o)),1)):A("",!0),ma,pa,b("div",{class:"link",onClick:w},"Changelog"),ha,b("div",null,[s(l)?(_(),k("a",{key:0,href:s(l),class:"info-modal-discord-link",target:"_blank"},[ba,D(" "+R(s(a)),1)],8,va)):A("",!0)]),ya,_a,Na,b("div",null,"Time Played: "+R(s(m)),1),(_(),G(be(s(y))))])):A("",!0)]),_:1},8,["modelValue"]))}});var Ca=ee(wa,[["__scopeId","data-v-10effbe8"]]);const ka={class:"field"},Sa={key:0,class:"field-title"},kn=L({__name:"Select",props:{title:null,modelValue:null,options:null,placeholder:null,closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var a;const n=e,i=wt(Ze(n,"title"),"span"),r=O((a=n.options.find(l=>l.value===n.modelValue))!=null?a:null);ze(Ze(n,"modelValue"),l=>{var u;we(r)!==l&&(r.value=(u=n.options.find(f=>f.value===l))!=null?u:null)});function o(l){t("update:modelValue",l.value)}return(l,u)=>(_(),k("div",ka,[s(i)?(_(),k("span",Sa,[(_(),G(be(s(i))))])):A("",!0),p(s(Mi),{options:e.options,modelValue:r.value,"onUpdate:modelValue":[u[0]||(u[0]=f=>r.value=f),o],min:1,"label-by":"label",placeholder:e.placeholder,"close-on-select":e.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const Ia={class:"field"},Ma=L({__name:"Toggle",props:{title:null,modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=M(()=>{var o;return Q((o=s(n.title))!=null?o:"<span></span>","span")}),r=M({get(){return!!n.modelValue},set(o){t("update:modelValue",o)}});return(o,a)=>(_(),k("label",Ia,[dn(b("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":a[0]||(a[0]=l=>de(r)?r.value=l:null)},null,512),[[wi,s(r)]]),(_(),G(be(s(i))))]))}});var Ee=ee(Ma,[["__scopeId","data-v-11046116"]]);const $a={class:"header"},xa=b("h2",null,"Settings",-1),Ta={class:"option-tabs"},Pa={key:0},Fa={key:1};var Da=L({__name:"Options",setup(e,{expose:t}){const n=O(!1),i=O("behaviour");function r(re){return re==i.value}function o(re){i.value=re}t({isTab:r,setTab:o,save:ke,open(){n.value=!0}});const a=Object.keys(Se).map(re=>({label:pn(re),value:re})),l=M(()=>Q(Z(()=>p(z,null,[Xn.map(mt)])))),{showTPS:u,theme:f,unthrottled:h,alignUnits:g}=ue(J),{autosave:m,offlineProd:y}=ue(E),w=M({get(){return E.devSpeed===0},set(re){E.devSpeed=re?0:null}}),N=Z(()=>p("span",{class:"option-title"},[D("Unthrottled"),p("desc",null,[D("Allow the game to run as fast as possible. Not battery friendly.")])])),I=Z(()=>p("span",{class:"option-title"},[D("Offline Production"),p(me,{display:"Save-specific",direction:j.Right},{default:()=>[D("*")]}),p("desc",null,[D("Simulate production that occurs while the game is closed.")])])),P=Z(()=>p("span",{class:"option-title"},[D("Autosave"),p(me,{display:"Save-specific",direction:j.Right},{default:()=>[D("*")]}),p("desc",null,[D("Automatically save the game every second or when the game is closed.")])])),S=Z(()=>p("span",{class:"option-title"},[D("Pause game"),p(me,{display:"Save-specific",direction:j.Right},{default:()=>[D("*")]}),p("desc",null,[D("Stop everything from moving.")])])),T=Z(()=>p("span",{class:"option-title"},[D("Theme"),p("desc",null,[D("How the game looks.")])])),V=Z(()=>p("span",{class:"option-title"},[D("Show TPS"),p("desc",null,[D("Show TPS meter at the bottom-left corner of the page.")])])),ae=Z(()=>p("span",{class:"option-title"},[D("Align modifier units"),p("desc",null,[D("Align numbers to the beginning of the unit in modifier view.")])]));return(re,Y)=>(_(),G(st,{modelValue:n.value,"onUpdate:modelValue":Y[10]||(Y[10]=ne=>n.value=ne)},{header:q(()=>[b("div",$a,[xa,b("div",Ta,[b("button",{class:se({selected:r("behaviour")}),onClick:Y[0]||(Y[0]=ne=>o("behaviour"))},"Behaviour",2),b("button",{class:se({selected:r("appearance")}),onClick:Y[1]||(Y[1]=ne=>o("appearance"))},"Appearance",2)])])]),body:q(()=>[r("behaviour")?(_(),k("div",Pa,[p(Ee,{title:s(N),modelValue:s(h),"onUpdate:modelValue":Y[2]||(Y[2]=ne=>de(h)?h.value=ne:null)},null,8,["title","modelValue"]),s(X).enablePausing?(_(),G(Ee,{key:0,title:s(S),modelValue:s(w),"onUpdate:modelValue":Y[3]||(Y[3]=ne=>de(w)?w.value=ne:null)},null,8,["title","modelValue"])):A("",!0),p(Ee,{title:s(I),modelValue:s(y),"onUpdate:modelValue":Y[4]||(Y[4]=ne=>de(y)?y.value=ne:null)},null,8,["title","modelValue"]),p(Ee,{title:s(P),modelValue:s(m),"onUpdate:modelValue":Y[5]||(Y[5]=ne=>de(m)?m.value=ne:null)},null,8,["title","modelValue"]),s(m)?A("",!0):(_(),G(gn,{key:1,class:"button save-button",onClick:Y[6]||(Y[6]=ne=>s(ke)())},{default:q(()=>[D("Manually save")]),_:1}))])):A("",!0),r("appearance")?(_(),k("div",Fa,[p(kn,{title:s(T),options:s(a),modelValue:s(f),"onUpdate:modelValue":Y[7]||(Y[7]=ne=>de(f)?f.value=ne:null)},null,8,["title","options","modelValue"]),(_(),G(be(s(l)))),p(Ee,{title:s(V),modelValue:s(u),"onUpdate:modelValue":Y[8]||(Y[8]=ne=>de(u)?u.value=ne:null)},null,8,["title","modelValue"]),p(Ee,{title:s(ae),modelValue:s(g),"onUpdate:modelValue":Y[9]||(Y[9]=ne=>de(g)?g.value=ne:null)},null,8,["title","modelValue"])])):A("",!0)]),_:1},8,["modelValue"]))}});const Aa=["onSubmit"],Ea={class:"field"},Oa={key:0,class:"field-title"},Va=["placeholder"],qa=L({__name:"Text",props:{title:null,modelValue:null,textArea:{type:Boolean},placeholder:null,maxHeight:null,submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,i=wt(Ze(n,"title"),"span"),r=$e(null);Dt(()=>{var u;(u=r.value)==null||u.focus()});const o=M({get(){var u;return(u=s(n.modelValue))!=null?u:""},set(u){t("update:modelValue",u)}});function a(){t("submit")}function l(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(u,f)=>(_(),k("form",{onSubmit:yt(a,["prevent"])},[b("div",Ea,[s(i)?(_(),k("span",Oa,[(_(),G(be(s(i))))])):A("",!0),e.textArea?(_(),G(s(xi),{key:1,modelValue:s(o),"onUpdate:modelValue":f[0]||(f[0]=h=>de(o)?o.value=h:null),placeholder:e.placeholder,maxHeight:e.maxHeight,onBlur:l,ref_key:"field",ref:r},null,8,["modelValue","placeholder","maxHeight"])):dn((_(),k("input",{key:2,type:"text","onUpdate:modelValue":f[1]||(f[1]=h=>de(o)?o.value=h:null),placeholder:e.placeholder,class:se({fullWidth:!e.title}),onBlur:l,ref_key:"field",ref:r},null,42,Va)),[[Ci,s(o)]])])],40,Aa))}});var ai=ee(qa,[["__scopeId","data-v-90bd4994"]]);const Ba={key:0},La=["onClick","disabled"],Ra={key:0},za=["onClick"],Ua=L({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const i=ue(e),r=O(!1);ze(r,l=>{t("confirmingChanged",l)});function o(){if(s(i.skipConfirm)){t("click");return}r.value&&t("click"),r.value=!r.value}function a(){r.value=!1}return(l,u)=>(_(),k("span",{class:se(["container",{confirming:r.value}])},[r.value?(_(),k("span",Ba,"Are you sure?")):A("",!0),b("button",{onClick:yt(o,["stop"]),class:"button danger",disabled:e.disabled},[r.value?(_(),k("span",Ra,"Yes")):Ve(l.$slots,"default",{key:1},void 0,!0)],8,La),r.value?(_(),k("button",{key:1,class:"button",onClick:yt(a,["stop"])},"No",8,za)):A("",!0)],2))}});var ja=ee(Ua,[["__scopeId","data-v-2f8ef34c"]]);const Ye=e=>(tt("data-v-32313015"),e=e(),nt(),e),Ga=Ye(()=>b("div",{class:"handle material-icons"},"drag_handle",-1)),Wa={key:0,class:"actions"},Ha=Ye(()=>b("span",{class:"material-icons"},"content_paste",-1)),Za=Ye(()=>b("span",{class:"material-icons"},"content_copy",-1)),Ya=Ye(()=>b("span",{class:"material-icons"},"edit",-1)),Ja=Ye(()=>b("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),Ka={key:1,class:"actions"},Xa=Ye(()=>b("span",{class:"material-icons"},"check",-1)),Qa=Ye(()=>b("span",{class:"material-icons"},"close",-1)),el={key:2,class:"details"},tl={class:"save-version"},nl=Ye(()=>b("br",null,null,-1)),il={key:0},rl={key:3,class:"details"},sl={key:4,class:"details error"},ol=Ye(()=>b("br",null,null,-1)),al=L({__name:"Save",props:{save:null},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:i}=ue(n),r=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),o=O(!1),a=O(!1),l=O("");ze(o,()=>{var g;return l.value=(g=i.value.name)!=null?g:""});const u=M(()=>i.value!=null&&i.value.id===E.id),f=M(()=>{var g;return u.value?E.time:(g=i.value!=null&&i.value.time)!=null?g:0});function h(){t("editName",l.value),o.value=!1}return(g,m)=>(_(),k("div",{class:se(["save",{active:s(u)}])},[Ga,o.value?(_(),k("div",Ka,[b("button",{onClick:h,class:"button"},[p(me,{display:"Save",direction:s(j).Left,class:"info"},{default:q(()=>[Xa]),_:1},8,["direction"])]),b("button",{onClick:m[5]||(m[5]=y=>o.value=!o.value),class:"button"},[p(me,{display:"Cancel",direction:s(j).Left,class:"info"},{default:q(()=>[Qa]),_:1},8,["direction"])])])):(_(),k("div",Wa,[s(i).error==null&&!a.value?(_(),G(gn,{key:0,onClick:m[0]||(m[0]=y=>t("export")),class:"button",left:""},{default:q(()=>[p(me,{display:"Export",direction:s(j).Left,class:"info"},{default:q(()=>[Ha]),_:1},8,["direction"])]),_:1})):A("",!0),s(i).error==null&&!a.value?(_(),k("button",{key:1,onClick:m[1]||(m[1]=y=>t("duplicate")),class:"button"},[p(me,{display:"Duplicate",direction:s(j).Left,class:"info"},{default:q(()=>[Za]),_:1},8,["direction"])])):A("",!0),s(i).error==null&&!a.value?(_(),k("button",{key:2,onClick:m[2]||(m[2]=y=>o.value=!o.value),class:"button"},[p(me,{display:"Edit Name",direction:s(j).Left,class:"info"},{default:q(()=>[Ya]),_:1},8,["direction"])])):A("",!0),p(ja,{disabled:s(u),onClick:m[3]||(m[3]=y=>t("delete")),onConfirmingChanged:m[4]||(m[4]=y=>a.value=y)},{default:q(()=>[p(me,{display:"Delete",direction:s(j).Left,class:"info"},{default:q(()=>[Ja]),_:1},8,["direction"])]),_:1},8,["disabled"])])),s(i).error==null&&!o.value?(_(),k("div",el,[b("button",{class:"button open",onClick:m[6]||(m[6]=y=>t("open"))},[b("h3",null,R(s(i).name),1)]),b("span",tl,"v"+R(s(i).modVersion),1),nl,s(f)?(_(),k("div",il,"Last played "+R(s(r).format(s(f))),1)):A("",!0)])):s(i).error==null&&o.value?(_(),k("div",rl,[p(ai,{modelValue:l.value,"onUpdate:modelValue":m[7]||(m[7]=y=>l.value=y),class:"editname",onSubmit:h},null,8,["modelValue"])])):(_(),k("div",sl,[D(" Error: Failed to load save with id "+R(s(i).id),1),ol,D(R(s(i).error),1)]))],2))}});var ll=ee(al,[["__scopeId","data-v-32313015"]]);const Sn=e=>(tt("data-v-2a4275be"),e=e(),nt(),e),ul=Sn(()=>b("h2",null,"Saves Manager",-1)),cl={class:"modal-footer"},dl={class:"field"},fl=Sn(()=>b("span",{class:"field-title"},"Create Save",-1)),gl={class:"field-buttons"},ml={class:"footer"},pl=Sn(()=>b("div",{style:{"flex-grow":"1"}},null,-1)),hl=L({__name:"SavesManager",setup(e,{expose:t}){const n=O(!1),i=O(null);t({open(){n.value=!0}});const r=O(!1),o=O(""),a=O(null);ze(o,S=>{S?ft(()=>{try{if(S[0]!=="{")if(S[0]==="e")S=decodeURIComponent(escape(atob(S)));else if(S[0]==="\u1BE1")S=We.decompressFromUTF16(S);else{console.warn("Unable to determine preset encoding",S),r.value=!0;return}const T=JSON.parse(S);if(typeof T!="object"){r.value=!0;return}const V=Rt();T.id=V,ke(T),o.value="",r.value=!1,J.saves.push(V)}catch{r.value=!0}}):r.value=!1});let l={},u=O(Object.keys(l).reduce((S,T)=>(S.push({label:T.split("/").slice(-1)[0].slice(0,-4),value:l[T]}),S),[]));const f=cn({});function h(S){if(f[S]==null){let T=localStorage.getItem(S);if(T==null)f[S]={error:"Save doesn't exist in localStorage",id:S};else if(T==="dW5kZWZpbmVk")f[S]={error:"Save is undefined",id:S};else try{if(T[0]!=="{")if(T[0]==="e")T=decodeURIComponent(escape(atob(T)));else if(T[0]==="\u1BE1")T=We.decompressFromUTF16(T);else return console.warn("Unable to determine preset encoding",T),r.value=!0,f[S]={error:"Unable to determine preset encoding",id:S},f[S];f[S]={...JSON.parse(T),id:S}}catch(V){f[S]={error:V,id:S},console.warn(`SavesManager: Failed to load info about save with id ${S}:
${V}
${T}`)}}return f[S]}ze(n,S=>{S&&Object.keys(f).forEach(T=>delete f[T])});const g=M(()=>J.saves.reduce((S,T)=>(S[T]=h(T),S),{}));function m(S){let T;switch(E.id===S?T=fn(E):T=JSON.stringify(g.value[S]),X.exportEncoding){default:console.warn(`Unknown save encoding: ${X.exportEncoding}. Defaulting to lz`);case"lz":T=We.compressToUTF16(T);break;case"base64":T=btoa(unescape(encodeURIComponent(T)));break;case"plain":break}const V=document.createElement("textarea");V.value=T,document.body.appendChild(V),V.select(),V.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(V)}function y(S){E.id===S&&ke();const T={...g.value[S],id:Rt()};ke(T),J.saves.push(T.id)}function w(S){J.saves=J.saves.filter(T=>T!==S),localStorage.removeItem(S),f[S]=void 0}function N(S){g.value[E.id].time=E.time,ke(),f[E.id]=void 0,ut(g.value[S]),f[S]=void 0}function I(S){if(a.value=S,ft(()=>{a.value=null}),S[0]!=="{")if(S[0]==="e")S=decodeURIComponent(escape(atob(S)));else if(S[0]==="\u1BE1")S=We.decompressFromUTF16(S);else{console.warn("Unable to determine preset encoding",S);return}const T=JSON.parse(S);T.id=Rt(),ke(T),J.saves.push(T.id),N(T.id)}function P(S,T){const V=g.value[S];V!=null&&(V.name=T,E.id===S?(E.name=T,ke()):(ke(V),f[S]=void 0))}return(S,T)=>(_(),G(st,{modelValue:n.value,"onUpdate:modelValue":T[4]||(T[4]=V=>n.value=V),ref_key:"modal",ref:i},{header:q(()=>[ul]),body:q(({shown:V})=>[V?(_(),G(s($i),{key:0,list:s(J).saves,handle:".handle",itemKey:ae=>ae},{item:q(({element:ae})=>[p(ll,{save:s(g)[ae],onOpen:re=>N(ae),onExport:re=>m(ae),onEditName:re=>P(ae,re),onDuplicate:re=>y(ae),onDelete:re=>w(ae)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):A("",!0)]),footer:q(()=>[b("div",cl,[p(ai,{modelValue:o.value,"onUpdate:modelValue":T[0]||(T[0]=V=>o.value=V),title:"Import Save",placeholder:"Paste your save here!",class:se({importingFailed:r.value})},null,8,["modelValue","class"]),b("div",dl,[fl,b("div",gl,[b("button",{class:"button",onClick:T[1]||(T[1]=V=>N(s(bt)().id))},"New Game"),Object.keys(s(u)).length>0?(_(),G(kn,{key:0,options:s(u),modelValue:a.value,"onUpdate:modelValue":T[2]||(T[2]=V=>I(V)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):A("",!0)])]),b("div",ml,[pl,b("button",{class:"button modal-default-button",onClick:T[3]||(T[3]=V=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var li=ee(hl,[["__scopeId","data-v-2a4275be"]]);const Ie=e=>(tt("data-v-47c54e31"),e=e(),nt(),e),vl=["src","alt"],bl={key:1,class:"title"},yl=Ie(()=>b("div",{style:{"flex-grow":"1",cursor:"unset"}},null,-1)),_l={class:"discord"},Nl={class:"discord-links"},wl={key:0},Cl=["href"],kl=Ie(()=>b("li",null,[b("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"Profectus & Friends")],-1)),Sl=Ie(()=>b("li",null,[b("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Il={href:"https://forums.moddingtree.com/",target:"_blank"},Ml=Ie(()=>b("span",{class:"material-icons"},"forum",-1)),$l=Ie(()=>b("span",{class:"material-icons"},"info",-1)),xl=Ie(()=>b("span",{class:"material-icons"},"library_books",-1)),Tl=Ie(()=>b("span",{class:"material-icons"},"settings",-1)),Pl=Ie(()=>b("span",{class:"material-icons"},"library_books",-1)),Fl=Ie(()=>b("span",{class:"material-icons"},"settings",-1)),Dl=Ie(()=>b("span",{class:"material-icons"},"info",-1)),Al={href:"https://forums.moddingtree.com/",target:"_blank"},El=Ie(()=>b("span",{class:"material-icons"},"forum",-1)),Ol={class:"discord"},Vl={class:"discord-links"},ql={key:0},Bl=["href"],Ll=Ie(()=>b("li",null,[b("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"Profectus & Friends")],-1)),Rl=Ie(()=>b("li",null,[b("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),zl=L({__name:"Nav",setup(e){const t=O(null),n=O(null),i=O(null),r=O(null),{useHeader:o,banner:a,title:l,discordName:u,discordLink:f,versionNumber:h}=X;function g(){window.open(f,"mywindow")}return(m,y)=>(_(),k(z,null,[s(o)?(_(),k("div",He({key:0,class:"nav"},m.$attrs),[s(a)?(_(),k("img",{key:0,src:s(a),class:"banner",alt:s(l)},null,8,vl)):(_(),k("div",bl,R(s(l)),1)),b("div",{onClick:y[0]||(y[0]=w=>{var N;return(N=r.value)==null?void 0:N.open()}),class:"version-container"},[p(me,{display:"Changelog",direction:s(j).Down,class:"version"},{default:q(()=>[b("span",null,"v"+R(s(h)),1)]),_:1},8,["direction"])]),yl,b("div",_l,[b("span",{onClick:g,class:"material-icons"},"discord"),b("ul",Nl,[s(f)?(_(),k("li",wl,[b("a",{href:s(f),target:"_blank"},R(s(u)),9,Cl)])):A("",!0),kl,Sl])]),b("div",null,[b("a",Il,[p(me,{display:"Forums",direction:s(j).Down,yoffset:"5px"},{default:q(()=>[Ml]),_:1},8,["direction"])])]),b("div",{onClick:y[1]||(y[1]=w=>{var N;return(N=t.value)==null?void 0:N.open()})},[p(me,{display:"Info",direction:s(j).Down,class:"info"},{default:q(()=>[$l]),_:1},8,["direction"])]),b("div",{onClick:y[2]||(y[2]=w=>{var N;return(N=n.value)==null?void 0:N.open()})},[p(me,{display:"Saves",direction:s(j).Down,xoffset:"-20px"},{default:q(()=>[xl]),_:1},8,["direction"])]),b("div",{onClick:y[3]||(y[3]=w=>{var N;return(N=i.value)==null?void 0:N.open()})},[p(me,{display:"Settings",direction:s(j).Down,xoffset:"-66px"},{default:q(()=>[Tl]),_:1},8,["direction"])])],16)):(_(),k("div",He({key:1,class:"overlay-nav"},m.$attrs),[b("div",{onClick:y[4]||(y[4]=w=>{var N;return(N=r.value)==null?void 0:N.open()}),class:"version-container"},[p(me,{display:"Changelog",direction:s(j).Right,xoffset:"25%",class:"version"},{default:q(()=>[b("span",null,"v"+R(s(h)),1)]),_:1},8,["direction"])]),b("div",{onClick:y[5]||(y[5]=w=>{var N;return(N=n.value)==null?void 0:N.open()})},[p(me,{display:"Saves",direction:s(j).Right},{default:q(()=>[Pl]),_:1},8,["direction"])]),b("div",{onClick:y[6]||(y[6]=w=>{var N;return(N=i.value)==null?void 0:N.open()})},[p(me,{display:"Settings",direction:s(j).Right},{default:q(()=>[Fl]),_:1},8,["direction"])]),b("div",{onClick:y[7]||(y[7]=w=>{var N;return(N=t.value)==null?void 0:N.open()})},[p(me,{display:"Info",direction:s(j).Right},{default:q(()=>[Dl]),_:1},8,["direction"])]),b("div",null,[b("a",Al,[p(me,{display:"Forums",direction:s(j).Right,xoffset:"7px"},{default:q(()=>[El]),_:1},8,["direction"])])]),b("div",Ol,[b("span",{onClick:g,class:"material-icons"},"discord"),b("ul",Vl,[s(f)?(_(),k("li",ql,[b("a",{href:s(f),target:"_blank"},R(s(u)),9,Bl)])):A("",!0),Ll,Rl])])],16)),p(Ca,{ref_key:"info",ref:t,changelog:r.value},null,8,["changelog"]),p(li,{ref_key:"savesManager",ref:n},null,512),p(Da,{ref_key:"options",ref:i},null,512),p(ra,{ref_key:"changelog",ref:r},null,512)],64))}});var ui=ee(zl,[["__scopeId","data-v-47c54e31"]]);const Ul={class:"inner-tab"},jl=L({__name:"Game",setup(e){const t=Ze(E,"tabs"),n=M(()=>Object.keys(Ne)),i=X.useHeader;function r(o){const{display:a,minimized:l,name:u,color:f,minimizable:h,nodes:g,minimizedDisplay:m}=o;return{display:a,minimized:l,name:u,color:f,minimizable:h,nodes:g,minimizedDisplay:m}}return(o,a)=>(_(),k("div",{class:se(["tabs-container",{useHeader:s(i)}])},[(_(!0),k(z,null,Fe(s(t),(l,u)=>{var f,h;return _(),k("div",{key:u,class:se(["tab",s((f=s(Ne)[l])==null?void 0:f.classes)]),style:he(s((h=s(Ne)[l])==null?void 0:h.style))},[u===0&&!s(i)?(_(),G(ui,{key:0})):A("",!0),b("div",Ul,[s(n).includes(l)?(_(),G(ea,He({key:0},r(s(Ne)[l]),{index:u,onSetMinimized:g=>s(Ne)[l].minimized.value=g}),null,16,["index","onSetMinimized"])):(_(),G(be(l),{key:1,index:u},null,8,["index"]))])],6)}),128))],2))}});var Gl=ee(jl,[["__scopeId","data-v-dcd207b4"]]);const Wl=L({__name:"Spacer",props:{width:{default:"8px"},height:{default:"17px"}},setup(e){return(t,n)=>(_(),k("div",{style:he({width:e.width,height:e.height})},null,4))}});const Hl=["x1","y1","x2","y2"],Zl=L({__name:"BoardLink",props:{link:null,dragging:null,dragged:null},setup(e){const t=e,n=ue(t),i=M(()=>{var l,u,f,h,g,m,y;const a={...n.link.value.startNode.position};return n.link.value.offsetStart&&(a.x+=s(n.link.value.offsetStart).x,a.y+=s(n.link.value.offsetStart).y),((l=n.dragging)==null?void 0:l.value)===n.link.value.startNode&&(a.x+=(h=(f=(u=n.dragged)==null?void 0:u.value)==null?void 0:f.x)!=null?h:0,a.y+=(y=(m=(g=n.dragged)==null?void 0:g.value)==null?void 0:m.y)!=null?y:0),a}),r=M(()=>{var l,u,f,h,g,m,y;const a={...n.link.value.endNode.position};return n.link.value.offsetEnd&&(a.x+=s(n.link.value.offsetEnd).x,a.y+=s(n.link.value.offsetEnd).y),((l=n.dragging)==null?void 0:l.value)===n.link.value.endNode&&(a.x+=(h=(f=(u=n.dragged)==null?void 0:u.value)==null?void 0:f.x)!=null?h:0,a.y+=(y=(m=(g=n.dragged)==null?void 0:g.value)==null?void 0:m.y)!=null?y:0),a}),o=M(()=>ni(t.link));return(a,l)=>(_(),k("line",He({class:"link"},s(o),{class:{pulsing:e.link.pulsing},x1:s(i).x,y1:s(i).y,x2:s(r).x,y2:s(r).y}),null,16,Hl))}});var Yl=ee(Zl,[["__scopeId","data-v-4e1e901b"]]);const Jl={key:0},Kl=["transform","onMousedown","onTouchstart","onMouseup","onTouchend"],Xl=["fill","stroke-width","stroke"],Ql=["fill"],eu=L({__name:"BoardNodeAction",props:{node:null,nodeType:null,actions:null,isSelected:{type:Boolean},selectedAction:null},emits:["clickAction"],setup(e,{emit:t}){const i=ue(e),r=M(()=>te(i.nodeType.value.size,s(i.node))),o=M(()=>{var h;return(h=te(i.nodeType.value.outlineColor,s(i.node)))!=null?h:Se[J.theme].variables["--outline"]}),a=M(()=>{var h;return(h=te(i.nodeType.value.titleColor,s(i.node)))!=null?h:Se[J.theme].variables["--foreground"]}),l=M(()=>te(i.nodeType.value.actionDistance,s(i.node)));function u(h,g){t("clickAction",g.id),h.preventDefault(),h.stopPropagation()}function f(h,g){var m;((m=s(i.selectedAction))==null?void 0:m.id)===g.id&&(h.preventDefault(),h.stopPropagation())}return(h,g)=>(_(),G($t,{name:"actions",appear:""},{default:q(()=>[e.isSelected&&e.actions?(_(),k("g",Jl,[(_(!0),k(z,null,Fe(e.actions,(m,y)=>{var w,N;return _(),k("g",{key:m.id,class:se(["action",{selected:((w=e.selectedAction)==null?void 0:w.id)===m.id}]),transform:`translate(
                        ${(-s(r)-30)*Math.sin(((e.actions.length-1)/2-y)*s(l))},
                        ${(s(r)+30)*Math.cos(((e.actions.length-1)/2-y)*s(l))}
                    )`,onMousedown:I=>u(I,m),onTouchstart:I=>u(I,m),onMouseup:I=>f(I,m),onTouchend:yt(I=>f(I,m),["stop"])},[b("circle",{fill:s(te)(m.fillColor,e.node),r:"20","stroke-width":((N=e.selectedAction)==null?void 0:N.id)===m.id?4:0,stroke:s(o)},null,8,Xl),b("text",{fill:s(a),class:"material-icons"},R(s(te)(m.icon,e.node)),9,Ql)],42,Kl)}),128))])):A("",!0)]),_:1}))}});var tu=ee(eu,[["__scopeId","data-v-9efb2a56"]]);const nu=["points","fill","stroke"],iu=["fill","x"],ru=["fill","x"],ci=L({__name:"ChainBody",props:{size:null,fillColor:null,strokeColor:null,data:null},setup(e){const n=ue(e),i=n.size.value,r=.5,o=[[-i,-i],[-i,i],[-i*r,i],[0,i*(1+r)],[i*r,i],[i,i],[i,-i],[i*r,-i],[0,-i*r],[-i*r,-i]].map(a=>`${a[0]},${a[1]}`).join(" ");return(a,l)=>(_(),k(z,null,[b("polygon",{class:"body",points:s(o),fill:e.fillColor,stroke:e.strokeColor,"stroke-width":4},null,8,nu),b("text",{fill:s(Se)[s(J).theme].variables["--foreground"],x:-s(i)/2,class:"node-title"},R(s(s(n).data).type),9,iu),b("text",{fill:s(Se)[s(J).theme].variables["--foreground"],x:-s(i)/2,y:20,class:"node-title"},R(s(s(n).data).stars+"-Star"),9,ru)],64))}}),su=["points","fill","stroke"],ou=["transform"],au=L({__name:"ChainStart",props:{size:null,fillColor:null,strokeColor:null,node:null},setup(e){const n=ue(e),i=n.size.value,r=.5,o=[[-i,-i],[-i,i],[-i*r,i],[0,i*(1+r)],[i*r,i],[i,i],[i,-i]].map(u=>`${u[0]},${u[1]}`).join(" "),l=n.node.value.state.parts;return(u,f)=>(_(),k(z,null,[b("polygon",{class:"body",points:s(o),fill:e.fillColor,stroke:e.strokeColor,"stroke-width":4},null,8,su),(_(!0),k(z,null,Fe(s(l),(h,g)=>(_(),k("g",{key:g,transform:"translate(0 "+(g+1)*s(i)*2.5+")"},[p(ci,{"fill-color":e.fillColor,size:s(i),data:h,"stroke-color":e.strokeColor},null,8,["fill-color","size","data","stroke-color"])],8,ou))),128))],64))}});const lu=["transform"],uu={key:0},cu=["r","fill","stroke"],du=["r","fill","stroke"],fu=["r","fill"],gu=["r","stroke-dasharray","stroke-dashoffset","stroke"],mu={key:1,transform:"rotate(45, 0, 0)"},pu=["width","height","transform","fill","stroke"],hu=["width","height","transform","fill","stroke"],vu=["width","height","transform","fill"],bu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],yu=["fill"],_u={key:0},Nu=["fill","y"],wu=["fill","y"],Cu=L({__name:"BoardNode",props:{node:null,nodeType:null,dragging:null,dragged:null,hasDragged:{type:Boolean},receivingNode:{type:Boolean},isSelected:{type:Boolean},selectedAction:null},emits:["mouseDown","endDragging","clickAction"],setup(e,{emit:t}){const n=e,i=Math.sqrt(2),r=ue(n),o=M(()=>te(r.nodeType.value.draggable,s(r.node)));ze(o,W=>{const ge=s(r.node);s(r.dragging)===ge&&!W&&t("endDragging",ge)});const a=M(()=>{var ge;const W=s(r.node);return(ge=te(r.nodeType.value.actions,W))==null?void 0:ge.filter(Pe=>it(te(Pe.visibility,W)))}),l=M(()=>{var ge;const W=s(r.node);if(te(r.nodeType.value.draggable,W)&&((ge=s(r.dragging))==null?void 0:ge.id)===W.id&&s(r.dragged)!=null){const{x:Pe,y:Ge}=s(r.dragged);return{x:W.position.x+Math.round(Pe/25)*25,y:W.position.y+Math.round(Ge/25)*25}}return W.position}),u=M(()=>te(r.nodeType.value.shape,s(r.node))),f=M(()=>te(r.nodeType.value.title,s(r.node))),h=M(()=>{var W;return(W=r.isSelected.value?s(r.selectedAction)&&te(s(r.selectedAction).tooltip,s(r.node)):null)!=null?W:te(r.nodeType.value.label,s(r.node))}),g=M(()=>{var W,ge;return te((ge=(W=s(r.selectedAction))==null?void 0:W.confirmationLabel)!=null?ge:{text:"Tap again to confirm"},s(r.node))}),m=M(()=>te(r.nodeType.value.size,s(r.node))),y=M(()=>{var W;return(W=te(r.nodeType.value.progress,s(r.node)))!=null?W:0}),w=M(()=>Se[J.theme].variables["--background"]),N=M(()=>{var W;return(W=te(r.nodeType.value.outlineColor,s(r.node)))!=null?W:Se[J.theme].variables["--outline"]}),I=M(()=>{var W;return(W=te(r.nodeType.value.fillColor,s(r.node)))!=null?W:Se[J.theme].variables["--raised-background"]}),P=M(()=>te(r.nodeType.value.progressColor,s(r.node))),S=M(()=>{var W;return(W=te(r.nodeType.value.titleColor,s(r.node)))!=null?W:Se[J.theme].variables["--foreground"]}),T=M(()=>te(r.nodeType.value.progressDisplay,s(r.node))),V=M(()=>r.dragging.value!=null&&s(r.hasDragged)&&te(r.nodeType.value.canAccept,s(r.node),r.dragging.value)),ae=M(()=>te(r.nodeType.value.style,s(r.node))),re=M(()=>te(r.nodeType.value.classes,s(r.node)));function Y(W){t("mouseDown",W,r.node.value,o.value)}function ne(W){var ge,Pe,Ge;(ge=r.hasDragged)!=null&&ge.value||(t("endDragging",r.node.value),(Ge=(Pe=r.nodeType.value).onClick)==null||Ge.call(Pe,r.node.value),W.stopPropagation())}return(W,ge)=>{var Pe,Ge,ht;return _(),k("g",{class:se(["boardnode",{[e.node.type]:!0,isSelected:e.isSelected,isDraggable:s(o),...s(re)}]),style:he([{opacity:((Pe=e.dragging)==null?void 0:Pe.id)===e.node.id&&e.hasDragged?.5:1},(Ge=s(ae))!=null?Ge:[]]),transform:`translate(${s(l).x},${s(l).y})${e.isSelected?" scale(1.2)":""}`},[p(tu,{actions:(ht=s(a))!=null?ht:[],"is-selected":e.isSelected,node:e.node,"node-type":e.nodeType,"selected-action":e.selectedAction,onClickAction:ge[0]||(ge[0]=$=>t("clickAction",$))},null,8,["actions","is-selected","node","node-type","selected-action"]),b("g",{class:"node-container",onMousedown:Y,onTouchstartPassive:Y,onMouseup:ne,onTouchendPassive:ne},[s(u)===s(Xe).Circle?(_(),k("g",uu,[s(V)?(_(),k("circle",{key:0,class:"receiver",r:s(m)+8,fill:s(w),stroke:e.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,cu)):A("",!0),b("circle",{class:"body",r:s(m),fill:s(I),stroke:s(N),"stroke-width":4},null,8,du),s(T)===s(un).Fill?(_(),k("circle",{key:1,class:"progress progressFill",r:Math.max(s(m)*s(y)-2,0),fill:s(P)},null,8,fu)):(_(),k("circle",{key:2,r:s(m)+4.5,class:"progress progressRing",fill:"transparent","stroke-dasharray":(s(m)+4.5)*2*Math.PI,"stroke-width":5,"stroke-dashoffset":(s(m)+4.5)*2*Math.PI-s(y)*(s(m)+4.5)*2*Math.PI,stroke:s(P)},null,8,gu))])):s(u)===s(Xe).Diamond?(_(),k("g",mu,[s(V)?(_(),k("rect",{key:0,class:"receiver",width:s(m)*s(i)+16,height:s(m)*s(i)+16,transform:`translate(${-(s(m)*s(i)+16)/2}, ${-(s(m)*s(i)+16)/2})`,fill:s(w),stroke:e.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,pu)):A("",!0),b("rect",{class:"body",width:s(m)*s(i),height:s(m)*s(i),transform:`translate(${-s(m)*s(i)/2}, ${-s(m)*s(i)/2})`,fill:s(I),stroke:s(N),"stroke-width":4},null,8,hu),s(T)===s(un).Fill?(_(),k("rect",{key:1,class:"progress progressFill",width:Math.max(s(m)*s(i)*s(y)-2,0),height:Math.max(s(m)*s(i)*s(y)-2,0),transform:`translate(${-Math.max(s(m)*s(i)*s(y)-2,0)/2}, ${-Math.max(s(m)*s(i)*s(y)-2,0)/2})`,fill:s(P)},null,8,vu)):(_(),k("rect",{key:2,class:"progress progressDiamond",width:s(m)*s(i)+9,height:s(m)*s(i)+9,transform:`translate(${-(s(m)*s(i)+9)/2}, ${-(s(m)*s(i)+9)/2})`,fill:"transparent","stroke-dasharray":(s(m)*s(i)+9)*4,"stroke-width":5,"stroke-dashoffset":(s(m)*s(i)+9)*4-s(y)*(s(m)*s(i)+9)*4,stroke:s(P)},null,8,bu))])):s(u)===s(Xe).ChainStart?(_(),G(au,{key:2,size:s(m),fillColor:s(I),strokeColor:s(N),node:e.node},null,8,["size","fillColor","strokeColor","node"])):s(u)===s(Xe).ChainBody?(_(),G(ci,{key:3,size:s(m),fillColor:s(I),strokeColor:s(N),data:e.node.state},null,8,["size","fillColor","strokeColor","data"])):A("",!0),b("text",{fill:s(S),class:"node-title"},R(s(f)),9,yu)],32),p($t,{name:"fade",appear:""},{default:q(()=>{var $;return[s(h)?(_(),k("g",_u,[b("text",{fill:($=s(h).color)!=null?$:s(S),class:se(["node-title",{pulsing:s(h).pulsing}]),y:-s(m)-20},R(s(h).text),11,Nu)])):A("",!0)]}),_:1}),p($t,{name:"fade",appear:""},{default:q(()=>{var $;return[e.isSelected&&e.selectedAction?(_(),k("text",{key:0,fill:($=s(g).color)!=null?$:s(S),class:se(["node-title",{pulsing:s(g).pulsing}]),y:s(m)+75},R(s(g).text),11,wu)):A("",!0)]}),_:1})],14,lu)}}});var ku=ee(Cu,[["__scopeId","data-v-12483d05"]]);const Su={class:"stage",width:"100%",height:"100%"},Iu={class:"g1"},Mu=L({__name:"Board",props:{nodes:null,types:null,state:null,visibility:null,width:null,height:null,style:null,classes:null,links:null,selectedAction:null,selectedNode:null,draggingNode:null,receivingNode:null,mousePosition:null,setReceivingNode:{type:Function},setDraggingNode:{type:Function}},setup(e){const n=ue(e),i=O({x:0,y:0}),r=O({x:0,y:0}),o=O(!1),a=O(null),l=M(()=>{const y=n.nodes.value.slice();if(n.selectedNode.value){const w=y.splice(y.indexOf(n.selectedNode.value),1)[0];y.push(w)}if(n.draggingNode.value){const w=y.splice(y.indexOf(n.draggingNode.value),1)[0];y.push(w)}return y});qe(()=>{const y=n.draggingNode.value;if(y==null)return null;const w={x:y.position.x+r.value.x,y:y.position.y+r.value.y};let N=Number.MAX_VALUE;n.setReceivingNode.value(n.nodes.value.reduce((I,P)=>{if(P.id===y.id)return I;const S=n.types.value[P.type];if(!te(S.canAccept,P,y))return I;const V=Math.pow(w.x-P.position.x,2)+Math.pow(w.y-P.position.y,2);let ae=te(S.size,P);return V>N||V>ae*ae?I:(N=V,P)},null))});function u(y){y.setTransformOrigin(null),y.moveTo(a.value.$el.clientWidth/2,a.value.$el.clientHeight/2)}function f(y,w=null,N=!1){if(n.draggingNode.value==null){y.preventDefault(),y.stopPropagation();let I,P;if("touches"in y)if(y.touches.length===1)I=y.touches[0].clientX,P=y.touches[0].clientY;else return;else I=y.clientX,P=y.clientY;i.value={x:I,y:P},r.value={x:0,y:0},o.value=!1,N&&n.setDraggingNode.value(w)}w!=null&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function h(y){const{x:w,y:N,scale:I}=a.value.panZoomInstance.getTransform();let P,S;if("touches"in y)if(y.touches.length===1)P=y.touches[0].clientX,S=y.touches[0].clientY;else{g(n.draggingNode.value),n.mousePosition.value=null;return}else P=y.clientX,S=y.clientY;n.mousePosition.value={x:(P-w)/I,y:(S-N)/I},r.value={x:r.value.x+(P-i.value.x)/I,y:r.value.y+(S-i.value.y)/I},i.value={x:P,y:S},(Math.abs(r.value.x)>10||Math.abs(r.value.y)>10)&&(o.value=!0),n.draggingNode.value!=null&&(y.preventDefault(),y.stopPropagation())}function g(y,w=!1){var N,I;if(n.draggingNode.value!=null&&n.draggingNode.value===y){n.receivingNode.value==null&&(n.draggingNode.value.position.x+=Math.round(r.value.x/25)*25,n.draggingNode.value.position.y+=Math.round(r.value.y/25)*25);const P=n.nodes.value;P.push(P.splice(P.indexOf(n.draggingNode.value),1)[0]),n.receivingNode.value&&((I=(N=n.types.value[n.receivingNode.value.type]).onDrop)==null||I.call(N,n.receivingNode.value,n.draggingNode.value)),n.setDraggingNode.value(null)}else!o.value&&!w&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function m(y,w){n.state.value.selectedAction===w?s(n.selectedAction).onClick(s(n.selectedNode)):n.state.value={...n.state.value,selectedAction:w}}return(y,w)=>{const N=De("panZoom");return s(it)(e.visibility)?(_(),G(N,{key:0,style:he([{width:e.width,height:e.height},e.style]),class:se(e.classes),selector:".g1",options:{initialZoom:1,minZoom:.1,maxZoom:10,zoomDoubleClickSpeed:1},ref_key:"stage",ref:a,onInit:u,onMousemove:h,onTouchmove:h,onMousedown:w[0]||(w[0]=I=>f(I)),onTouchstart:w[1]||(w[1]=I=>f(I)),onMouseup:w[2]||(w[2]=()=>g(s(e.draggingNode))),onTouchendPassive:w[3]||(w[3]=()=>g(s(e.draggingNode))),onMouseleave:w[4]||(w[4]=()=>g(s(e.draggingNode),!0))},{default:q(()=>[(_(),k("svg",Su,[b("g",Iu,[p($n,{name:"link",appear:""},{default:q(()=>[(_(!0),k(z,null,Fe(s(e.links)||[],I=>(_(),k("g",{key:`${I.startNode.id}-${I.endNode.id}`},[p(Yl,{link:I,dragging:s(e.draggingNode),dragged:I.startNode===s(e.draggingNode)||I.endNode===s(e.draggingNode)?r.value:void 0},null,8,["link","dragging","dragged"])]))),128))]),_:1}),p($n,{name:"grow",duration:500,appear:""},{default:q(()=>[(_(!0),k(z,null,Fe(s(l),I=>(_(),k("g",{key:I.id,style:{"transition-duration":"0s"}},[p(ku,{node:I,nodeType:e.types[I.type],dragging:s(e.draggingNode),dragged:s(e.draggingNode)===I?r.value:void 0,hasDragged:s(e.draggingNode)==null?!1:o.value,receivingNode:s(e.receivingNode)===I,isSelected:s(e.selectedNode)===I,selectedAction:s(e.selectedNode)===I?s(e.selectedAction):null,onMouseDown:f,onEndDragging:g,onClickAction:P=>m(I,P)},null,8,["node","nodeType","dragging","dragged","hasDragged","receivingNode","isSelected","selectedAction","onClickAction"])]))),128))]),_:1})])]))]),_:1},8,["style","class","options"])):A("",!0)}}});ve.on("setupVue",e=>Ti.install(e));const di=Symbol("Board");var un=(e=>(e.Outline="Outline",e.Fill="Fill",e))(un||{}),Xe=(e=>(e.Circle="Circle",e.Diamond="Triangle",e.ChainStart="ChainStart",e.ChainBody="ChainBody",e.ChainEnd="ChainEnd",e))(Xe||{});function $u(e){const t=je({nodes:[],selectedNode:null,selectedAction:null},!1);return Te(n=>{const i=e.call(n,n);i.id=Nt("board-"),i.type=di,i[Be]=Mu,i.state?(Ho(t),F(i,"state")):(t[et]={nodes:i.startNodes().map((l,u)=>(l.id=u,l)),selectedNode:null,selectedAction:null},i.state=t),i.nodes=M(()=>s(a.state).nodes),i.selectedNode=M({get(){return a.nodes.value.find(l=>l.id===s(a.state).selectedNode)||null},set(l){var u,f;de(a.state)?a.state.value={...a.state.value,selectedNode:(u=l==null?void 0:l.id)!=null?u:null}:a.state.selectedNode=(f=l==null?void 0:l.id)!=null?f:null}}),i.selectedAction=M({get(){const l=a.selectedNode.value;if(l==null)return null;const u=a.types[l.type];return u.actions==null?null:u.actions.find(f=>f.id===s(a.state).selectedAction)||null},set(l){var u,f;de(a.state)?a.state.value={...a.state.value,selectedAction:(u=l==null?void 0:l.id)!=null?u:null}:a.state.selectedAction=(f=l==null?void 0:l.id)!=null?f:null}}),i.mousePosition=O(null),i.links?F(i,"links"):i.links=M(()=>a.selectedAction.value==null?null:a.selectedAction.value.links&&a.selectedNode.value?te(a.selectedAction.value.links,a.selectedNode.value):null),i.draggingNode=O(null),i.receivingNode=O(null),F(i,"visibility"),K(i,"visibility",pe.Visible),F(i,"width"),K(i,"width","100%"),F(i,"height"),K(i,"height","100%"),F(i,"classes"),F(i,"style");for(const l in i.types){const u=i.types[l];if(F(u,"title"),F(u,"label"),F(u,"size"),K(u,"size",50),F(u,"style"),F(u,"classes"),F(u,"draggable"),K(u,"draggable",!1),F(u,"shape"),K(u,"shape","Circle"),F(u,"canAccept"),K(u,"canAccept",!1),F(u,"progress"),F(u,"progressDisplay"),K(u,"progressDisplay","Fill"),F(u,"progressColor"),K(u,"progressColor","none"),F(u,"fillColor"),F(u,"outlineColor"),F(u,"titleColor"),F(u,"actionDistance"),K(u,"actionDistance",Math.PI/6),u.nodes=M(()=>s(a.state).nodes.filter(f=>f.type===l)),K(u,"onClick",function(f){s(a.state).selectedNode=f.id}),u.actions)for(const f of u.actions)F(f,"visibility"),K(f,"visibility",pe.Visible),F(f,"icon"),F(f,"fillColor"),F(f,"tooltip"),F(f,"confirmationLabel"),K(f,"confirmationLabel",{text:"Tap again to confirm"}),F(f,"links")}function r(l){i.draggingNode.value=l}function o(l){i.receivingNode.value=l}i.placeInAvailableSpace=function(l,u=100,f=j.Right){const h=a.nodes.value.slice().filter(g=>g===l||(f===j.Down||f===j.Up)&&Math.abs(g.position.x-l.position.x)>u||(f===j.Left||f===j.Right)&&Math.abs(g.position.y-l.position.y)>u?!1:!(f===j.Right&&g.position.x<l.position.x-u||f===j.Left&&g.position.x>l.position.x+u||f===j.Up&&g.position.y>l.position.y+u||f===j.Down&&g.position.y<l.position.y-u)).sort(f===j.Right?(g,m)=>g.position.x-m.position.x:f===j.Left?(g,m)=>m.position.x-g.position.x:f===j.Up?(g,m)=>m.position.y-g.position.y:(g,m)=>g.position.y-m.position.y);for(let g=0;g<h.length;g++){const m=h[g],y=f===j.Right||f===j.Left?Math.abs(l.position.x-m.position.x):Math.abs(l.position.y-m.position.y);if(y<u)f===j.Right?l.position.x=m.position.x+u:f===j.Left?l.position.x=m.position.x-u:f===j.Up?l.position.y=m.position.y-u:f===j.Down&&(l.position.y=m.position.y+u);else if(g>0&&y>u)break}},i[Le]=function(){const{nodes:l,types:u,state:f,visibility:h,width:g,height:m,style:y,classes:w,links:N,selectedAction:I,selectedNode:P,mousePosition:S,draggingNode:T,receivingNode:V}=this;return{nodes:l,types:u,state:f,visibility:h,width:g,height:m,style:s(y),classes:w,links:N,selectedAction:I,selectedNode:P,mousePosition:S,draggingNode:T,receivingNode:V,setDraggingNode:r,setReceivingNode:o}};const a=i;return a})}function te(e,t,...n){return Wt(e)?e(t,...n):s(e)}const Mt={};ve.on("addLayer",e=>{const t=Yr(e,di);Mt[e.id]=e.on("postUpdate",n=>{t.forEach(i=>{Object.values(i.types).forEach(r=>r.nodes.value.forEach(o=>{var a;return(a=r.update)==null?void 0:a.call(r,o,n)}))})})});ve.on("removeLayer",e=>{var t;(t=Mt[e.id])==null||t.call(Mt),Mt[e.id]=void 0});function on(e,t){return e.nodes.value.find(n=>n.id===t)}function an(e,t="points",n=0,i=void 0){const r=de(e)?e:je(e);if(r.displayName=t,r.precision=n,r.small=i,!de(e)){const o=r[Oe];o.displayName=t,o.precision=n,o.small=i}return r}new c("10^^8");new c("1e100");function Yt(e,t){const n=t!=null?t:e.value;return c.eq(e.precision,0)?gt(e.small?n:c.floor(n)):ye(n,e.precision,e.small)}const xu=Symbol("Reset");function Tu(e){return Te(t=>{const n=e.call(t,t);return n.id=Nt("reset-"),n.type=xu,n.reset=function(){var r;const i=o=>{if(o!=null&&typeof o=="object"&&!(o instanceof c)&&!(o instanceof d)){if(Ft in o&&o[Ft]===!0)return;if(et in o){const a=o;a.value=a[et]}else!(o instanceof c)&&!de(o)&&Object.values(o).forEach(a=>i(a))}};s(n.thingsToReset).forEach(i),ve.emit("reset",n),(r=n.onReset)==null||r.call(n)},F(n,"thingsToReset"),n})}const qt={};ve.on("removeLayer",e=>{var t;(t=qt[e.id])==null||t.call(qt),qt[e.id]=void 0});const Pu={key:0},Fu={key:0,class:"mark star"},Du=["src"],Au=L({__name:"MarkNode",props:{mark:{type:[Boolean,String]}},setup(e){return(t,n)=>e.mark?(_(),k("div",Pu,[e.mark===!0?(_(),k("div",Fu)):(_(),k("img",{key:1,class:"mark",src:e.mark},null,8,Du))])):A("",!0)}});var Qt=ee(Au,[["__scopeId","data-v-2207999f"]]);const Eu=L({__name:"Node",props:{id:null},setup(e){const n=ue(e),i=jt(vn,()=>{}),r=jt(bn,()=>{}),o=$e(null),a=M(()=>o.value&&o.value.parentElement);return ze([a,n.id],([l,u],[f,h])=>{f&&r(s(h)),l&&i(u,l)}),Rn(()=>r(s(n.id))),(l,u)=>(_(),k("div",{class:"node",ref_key:"node",ref:o},null,512))}});var en=ee(Eu,[["__scopeId","data-v-a48cb382"]]),Ou=L({props:{display:{type:B(Object,String,Function),required:!0},visibility:{type:B(Number,Boolean),required:!0},style:B(Object,String,Array),classes:B(Object),onClick:Function,onHold:Function,canClick:{type:B(Boolean),required:!0},small:Boolean,mark:B(Boolean,String),id:{type:String,required:!0}},components:{Node:en,MarkNode:Qt},setup(e){const{display:t,onClick:n,onHold:i}=ue(e),r=$e("");qe(()=>{var h;const l=we(t);if(l==null){r.value="";return}if(rt(l)){r.value=Q(l);return}const u=Q((h=l.title)!=null?h:"","h3"),f=Q(l.description,"div");r.value=Q(Z(()=>p("span",null,[l.title!=null?p("div",null,[p(u,null,null)]):null,p(f,null,null)])))});const{start:o,stop:a}=ti(n,i);return{start:o,stop:a,comp:r,Visibility:pe,isVisible:it,isHidden:Xt,unref:s}}});function Vu(e,t,n,i,r,o){var u;const a=De("MarkNode"),l=De("Node");return e.isVisible(e.visibility)?(_(),k("button",{key:0,style:he([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(u=e.unref(e.style))!=null?u:[]]),onClick:t[0]||(t[0]=(...f)=>e.onClick&&e.onClick(...f)),onMousedown:t[1]||(t[1]=(...f)=>e.start&&e.start(...f)),onMouseleave:t[2]||(t[2]=(...f)=>e.stop&&e.stop(...f)),onMouseup:t[3]||(t[3]=(...f)=>e.stop&&e.stop(...f)),onTouchstartPassive:t[4]||(t[4]=(...f)=>e.start&&e.start(...f)),onTouchendPassive:t[5]||(t[5]=(...f)=>e.stop&&e.stop(...f)),onTouchcancelPassive:t[6]||(t[6]=(...f)=>e.stop&&e.stop(...f)),class:se({feature:!0,clickable:!0,can:e.unref(e.canClick),locked:!e.unref(e.canClick),small:e.small,...e.unref(e.classes)})},[e.unref(e.comp)?(_(),G(be(e.unref(e.comp)),{key:0})):A("",!0),p(a,{mark:e.unref(e.mark)},null,8,["mark"]),p(l,{id:e.id},null,8,["id"])],38)):A("",!0)}var qu=ee(Ou,[["render",Vu],["__scopeId","data-v-211328c0"]]);function Bu(e,t,n=!0){const i=typeof n=="function"?M(n):n;return e.on("update",()=>{var r;s(i)&&s(t.canClick)&&((r=t.onClick)==null||r.call(t))})}const Lu=["x1","y1","x2","y2"],Ru=L({__name:"Link",props:{link:null,startNode:null,endNode:null,boundingRect:null},setup(e){const t=e,n=ue(t),i=M(()=>{const a=n.startNode.value.rect,l=n.boundingRect.value,u=l?{x:a.x+a.width/2-l.x,y:a.y+a.height/2-l.y}:{x:0,y:0};return n.link.value.offsetStart&&(u.x+=n.link.value.offsetStart.x,u.y+=n.link.value.offsetStart.y),u}),r=M(()=>{const a=n.endNode.value.rect,l=n.boundingRect.value,u=l?{x:a.x+a.width/2-l.x,y:a.y+a.height/2-l.y}:{x:0,y:0};return n.link.value.offsetEnd&&(u.x+=n.link.value.offsetEnd.x,u.y+=n.link.value.offsetEnd.y),u}),o=M(()=>ni(t.link));return(a,l)=>(_(),k("line",He({"stroke-width":"15px",stroke:"white"},s(o),{x1:s(i).x,y1:s(i).y,x2:s(r).x,y2:s(r).y}),null,16,Lu))}});const zu=L({__name:"Links",props:{links:null},setup(e){var u;const n=Ze(e,"links"),i=O(null),r=jt(yn,O({})),o=jt(_n,O(void 0)),a=O((u=i.value)==null?void 0:u.getBoundingClientRect());ze(o,()=>{var f;return a.value=(f=i.value)==null?void 0:f.getBoundingClientRect()}),Dt(()=>{var f;return a.value=(f=i.value)==null?void 0:f.getBoundingClientRect()});const l=M(()=>{var h,g;const f=r.value;return(g=(h=n.value)==null?void 0:h.filter(m=>{var y,w;return((y=f[m.startNode.id])==null?void 0:y.rect)&&((w=f[m.startNode.id])==null?void 0:w.rect)}))!=null?g:[]});return(f,h)=>(_(),k(z,null,[s(l)?(_(),k("svg",ki(He({key:0},f.$attrs)),[(_(!0),k(z,null,Fe(s(l),(g,m)=>(_(),G(Ru,{key:m,link:g,boundingRect:a.value,startNode:s(r)[g.startNode.id],endNode:s(r)[g.endNode.id]},null,8,["link","boundingRect","startNode","endNode"]))),128))],16)):A("",!0),b("div",{ref_key:"resizeListener",ref:i,class:"resize-listener"},null,512)],64))}});var Uu=ee(zu,[["__scopeId","data-v-063f6d6b"]]);L({props:{nodes:{type:B(Array),required:!0},leftSideNodes:B(Array),rightSideNodes:B(Array),branches:B(Array)},components:{Links:Uu},setup(e){const{nodes:t,leftSideNodes:n,rightSideNodes:i}=ue(e),r=$e();qe(()=>{const l=we(t);r.value=Q(Z(()=>p(z,null,[l.map(u=>p("span",{class:"row tree-row",style:"margin: 50px auto;"},[u.map(Re)]))])))});const o=$e();qe(()=>{const l=we(n);o.value=l?Q(Z(()=>p("span",{class:"left-side-nodes small"},[l.map(Re)]))):""});const a=$e();return qe(()=>{const l=we(i);a.value=l?Q(Z(()=>p("span",{class:"side-nodes small"},[l.map(Re)]))):""}),{unref:s,nodesComp:r,leftNodesComp:o,rightNodesComp:a}}});const ju=L({props:{display:B(Object,String,Function),visibility:{type:B(Number,Boolean),required:!0},style:B(String,Object,Array),classes:B(Object),onClick:Function,onHold:Function,color:B(String),glowColor:B(String),canClick:{type:B(Boolean),required:!0},mark:B(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:Qt,Node:en},setup(e){const{onClick:t,onHold:n,display:i}=ue(e),r=wt(i),{start:o,stop:a}=ti(t,n);return{start:o,stop:a,comp:r,unref:s,Visibility:pe,isCoercableComponent:rt,isVisible:it,isHidden:Xt}}});function Gu(e,t,n,i,r,o){var u;const a=De("MarkNode"),l=De("Node");return e.isVisible(e.visibility)?(_(),k("div",{key:0,style:he({visibility:e.isHidden(e.visibility)?"hidden":void 0}),class:se({treeNode:!0,can:e.unref(e.canClick),...e.unref(e.classes)}),onClick:t[0]||(t[0]=(...f)=>e.onClick&&e.onClick(...f)),onMousedown:t[1]||(t[1]=(...f)=>e.start&&e.start(...f)),onMouseleave:t[2]||(t[2]=(...f)=>e.stop&&e.stop(...f)),onMouseup:t[3]||(t[3]=(...f)=>e.stop&&e.stop(...f)),onTouchstartPassive:t[4]||(t[4]=(...f)=>e.start&&e.start(...f)),onTouchendPassive:t[5]||(t[5]=(...f)=>e.stop&&e.stop(...f)),onTouchcancelPassive:t[6]||(t[6]=(...f)=>e.stop&&e.stop(...f))},[b("div",{style:he([{backgroundColor:e.unref(e.color),boxShadow:`-4px -4px 4px rgba(0, 0, 0, 0.25) inset, 0 0 20px ${e.unref(e.glowColor)}`},(u=e.unref(e.style))!=null?u:[]])},[(_(),G(be(e.unref(e.comp))))],4),p(a,{mark:e.unref(e.mark)},null,8,["mark"]),p(l,{id:e.id},null,8,["id"])],38)):A("",!0)}var Wu=ee(ju,[["render",Gu],["__scopeId","data-v-727230a6"]]);const Hu=Symbol("TreeNode");function Zu(e,...t){const n=t.reduce((i,r)=>{var o;return Object.assign(i,(o=r.getPersistentData)==null?void 0:o.call(r))},{});return Te(i=>{var a,l,u;const r=(a=e==null?void 0:e.call(i,i))!=null?a:{};r.id=Nt("treeNode-"),r.type=Hu,r[Be]=Wu;for(const f of t)(l=f.preConstruct)==null||l.call(f,r);Object.assign(n),F(r,"visibility"),K(r,"visibility",pe.Visible),F(r,"canClick"),K(r,"canClick",!0),F(r,"color"),F(r,"display"),F(r,"glowColor"),F(r,"classes"),F(r,"style"),F(r,"mark");for(const f of t)(u=f.postConstruct)==null||u.call(f,r);if(r.onClick){const f=r.onClick.bind(r);r.onClick=function(h){s(r.canClick)!==!1&&f(h)}}if(r.onHold){const f=r.onHold.bind(r);r.onHold=function(){s(r.canClick)!==!1&&f()}}const o=t.reduce((f,h)=>{var g;return Object.assign(f,(g=h.getGatheredProps)==null?void 0:g.call(h,r))},{});return r[Le]=function(){const{display:f,visibility:h,style:g,classes:m,onClick:y,onHold:w,color:N,glowColor:I,canClick:P,mark:S,id:T}=this;return{display:f,visibility:h,style:g,classes:m,onClick:y,onHold:w,color:N,glowColor:I,canClick:P,mark:S,id:T,...o}},r})}function Yu(e,t=null,n=0){const i=_e(n);return M(()=>t==null||c.gte(e.value,s(i))?Yt(e)+" "+e.displayName:`Reach ${c.eq(t.precision,0)?gt(s(i)):ye(s(i),t.precision)} ${t.displayName} to unlock (You have ${c.eq(t.precision,0)?gt(t.value):ye(t.value,t.precision)})`)}function Ju(e){return Zu(t=>{const n=e.call(t,t);return K(n,"display",pn(n.layerID)),F(n,"append"),{...n,onClick:s(n.append)?function(){if(E.tabs.includes(n.layerID)){const i=E.tabs.lastIndexOf(n.layerID);E.tabs.splice(i,1)}else E.tabs.push(n.layerID)}:function(){E.tabs.splice(1,1,n.layerID)}}})}function Ku(e){const t=[],n={};let i=!1;function r(){return i||(t.push(...e()),n.base=t.map(l=>_e(l.base)),n.baseText=t.map(l=>_e(l.baseText)),n.visible=t.map(l=>_e(l.visible)),n.title=t.map(l=>_e(l.title)),n.subtitle=t.map(l=>_e(l.subtitle)),i=!0),t}const o=je({},!1);return[Z(()=>{const l=r();let u=!0;const f=l.map((h,g)=>{var P,S,T;if(s(n.visible[g])===!1)return null;const m=p("h3",{onClick:()=>o.value[g]=!o.value[g],style:"cursor: pointer"},[p("span",{class:"modifier-toggle"+(s(o.value[g])?" collapsed":"")},[D("\u25BC")]),s(n.title[g]),s(n.subtitle[g])!=null?p("span",{class:"subtitle"},[D(" ("),s(n.subtitle[g]),D(")")]):null]),y=s(o.value[g])?null:p(z,null,[p("div",{class:"modifier-container"},[p("span",{class:"modifier-description"},[Re((P=s(n.baseText[g]))!=null?P:"Base")]),p("span",{class:"modifier-amount"},[ye((S=s(n.base[g]))!=null?S:1),h.unit])]),h.modifier.description==null?null:Re(s(h.modifier.description))]),w=!u;u=!1;const N=(T=s(n.base[g]))!=null?T:1,I=h.modifier.apply(N);return p(z,null,[w?p("br",null,null):null,p("div",{style:{"--unit":J.alignUnits&&h.unit!=null?"'"+h.unit+"'":""}},[m,p("br",null,null),y,p("hr",null,null),p("div",{class:"modifier-container"},[p("span",{class:"modifier-description"},[D("Total")]),p("span",{class:"modifier-amount",style:(h.smallerIsBetter===!0?c.gt(I,N!=null?N:1):c.lt(I,N!=null?N:1))?"color: var(--danger)":""},[mn(I),h.unit])])])])});return p(z,null,[f])}),o]}function Xu(e,t){return F(t,"display"),F(t,"classes"),F(t,"style"),F(t,"direction"),K(t,"direction",j.Up),F(t,"xoffset"),F(t,"yoffset"),t.pinnable&&(t.pinned=je(!1,!1)),ft(()=>{const n=e[Be];e[Be]=me;const i=e[Le].bind(e);e[Le]=function(){const{display:o,classes:a,style:l,direction:u,xoffset:f,yoffset:h,pinned:g}=this;return{element:{[Be]:n,[Le]:i},display:o,classes:a,style:s(l),direction:u,xoffset:f,yoffset:h,pinned:g}}.bind(t)}),t}const Qu=L({__name:"Sticky",setup(e){const t=O("0"),n=new ResizeObserver(r),i=$e(null);function r(){let o=i.value;if(o==null)return;let a=0;for(;o.previousSibling;){const l=o.previousSibling;l.dataset&&"vSticky"in l.dataset&&(a+=l.offsetHeight),o=l}t.value=a+"px"}return ft(r),document.fonts.ready.then(r),Dt(()=>{var a;const o=(a=i.value)==null?void 0:a.parentElement;o&&n.observe(o)}),(o,a)=>(_(),k("div",{class:"sticky",style:he({top:t.value}),ref_key:"element",ref:i,"data-v-sticky":""},[Ve(o.$slots,"default",{},void 0,!0)],4))}});var ec=ee(Qu,[["__scopeId","data-v-cccac690"]]);const tc=L({__name:"Resource",props:{resource:null,color:null},setup(e){const t=e,n=M(()=>Yt(t.resource));return(i,r)=>(_(),k("h2",{style:he({color:e.color,"text-shadow":"0px 0px 10px "+e.color})},R(s(n)),5))}});const nc={class:"main-display"},ic={key:0},rc={key:1},sc=L({__name:"MainDisplay",props:{resource:null,color:null,classes:null,style:null,effectDisplay:null},setup(e){const n=ue(e),i=O(null),r=wt(n.effectDisplay),o=M(()=>c.lt(n.resource.value,"1e1000"));return(a,l)=>(_(),G(ec,null,{default:q(()=>{var u,f,h,g;return[b("div",{class:se(["main-display-container",(u=e.classes)!=null?u:{}]),style:he([{height:`${((h=(f=i.value)==null?void 0:f.$el.clientHeight)!=null?h:0)+50}px`},(g=e.style)!=null?g:{}])},[b("div",nc,[s(o)?(_(),k("span",ic,"You have ")):A("",!0),p(tc,{resource:e.resource,color:e.color||"white"},null,8,["resource","color"]),D(" "+R(e.resource.displayName),1),s(r)?(_(),k("span",rc,[D(", "),(_(),G(be(s(r)),{ref_key:"effectRef",ref:i},null,512))])):A("",!0)])],6)]}),_:1}))}});function St(e){return Te(t=>{var i;const n=e.call(t,t);return n.partialDisplay=r=>p("span",{style:s(n.requirementMet)?"":"color: var(--danger)"},[Yt(n.resource,n.cost instanceof d?Ut(n.cost,r!=null?r:1,s(n.cumulativeCost),s(n.directSum)):s(n.cost))," ",n.resource.displayName]),n.display=r=>p("div",null,[s(n.requiresPay)?"Costs: ":"Requires: ",Yt(n.resource,n.cost instanceof d?Ut(n.cost,r!=null?r:1,s(n.cumulativeCost),s(n.directSum)):s(n.cost))," ",n.resource.displayName]),F(n,"visibility"),K(n,"visibility",pe.Visible),F(n,"cost"),F(n,"requiresPay"),K(n,"requiresPay",!0),F(n,"cumulativeCost"),K(n,"cumulativeCost",!0),F(n,"maxBulkAmount"),K(n,"maxBulkAmount",1),F(n,"directSum"),K(n,"pay",function(r){const o=n.cost instanceof d?Ut(n.cost,r!=null?r:1,s(n.cumulativeCost),s(n.directSum)):s(n.cost);n.resource.value=c.sub(n.resource.value,o).max(0)}),n.canMaximize=M(()=>{var l;if(!(n.cost instanceof d))return!1;const r=s(n.maxBulkAmount);if(c.lte(r,1))return!1;const o=s(n.cumulativeCost),a=(l=s(n.directSum))!=null?l:o?10:0;return c.lte(r,a)?!0:!(!n.cost.isInvertible()||o===!0&&!n.cost.isIntegrable())}),n.cost instanceof d?n.requirementMet=jo(n.cost,n.resource,(i=n.cumulativeCost)!=null?i:!0,n.directSum,n.maxBulkAmount):n.requirementMet=M(()=>c.gte(n.resource.value,s(n.cost))?1:0),n})}function In(e){return Te(()=>({requirementMet:M(()=>it(e.visibility)),visibility:pe.None,requiresPay:!1}))}function oc(e,t){return Te(()=>({requirementMet:_e(e),partialDisplay:t==null?void 0:Z(()=>Re(t)),display:t==null?void 0:Z(()=>p(z,null,[D("Req: "),Re(t)])),visibility:t==null?pe.None:pe.Visible,requiresPay:!1}))}function tn(e){if(Ue(e))return e.every(tn);const t=s(e.requirementMet);return typeof t=="boolean"?t:c.gt(t,0)}function fi(e){if(Ue(e))return e.map(fi).reduce(c.min);const t=s(e.requirementMet);return typeof t=="boolean"?t?c.dInf:0:c.gt(t,1)&&s(e.canMaximize)!==!0?1:t}function At(e,t=1){var n,i;if(Ue(e)&&(e=e.filter(r=>it(r.visibility)),e.length===1&&(e=e[0])),Ue(e)){e=e.filter(a=>"partialDisplay"in a);const r=e.filter(a=>s(a.requiresPay)),o=e.filter(a=>!s(a.requiresPay));return p(z,null,[r.length>0?p("div",null,[D("Costs:")," ",On(r.map(a=>a.partialDisplay(t)),p(z,null,[D(", ")]))]):null,o.length>0?p("div",null,[D("Requires:")," ",On(o.map(a=>a.partialDisplay(t)),p(z,null,[D(", ")]))]):null])}return(i=(n=e.display)==null?void 0:n.call(e))!=null?i:p(z,null,null)}function gi(e,t=1){var n;Ue(e)?e.filter(i=>s(i.requiresPay)).forEach(i=>{var r;return(r=i.pay)==null?void 0:r.call(i,t)}):s(e.requiresPay)&&((n=e.pay)==null||n.call(e,t))}const ac=Symbol("Repeatable");function qn(e,...t){const n=je(0),i=t.reduce((r,o)=>{var a;return Object.assign(r,(a=o.getPersistentData)==null?void 0:a.call(o))},{});return Te(r=>{var m,y,w;const o=e.call(r,r);o.id=Nt("repeatable-"),o.type=ac,o[Be]=qu;for(const N of t)(m=N.preConstruct)==null||m.call(N,o);o.amount=n,o.amount[et]=(y=o.initialAmount)!=null?y:0,Object.assign(o,i);const a={requirementMet:M(()=>c.sub(s(o.limit),o.amount.value)),requiresPay:!1,visibility:pe.None,canMaximize:!0},l=In(o);Ue(o.requirements)?(o.requirements.unshift(l),o.requirements.push(a)):o.requirements=[l,o.requirements,a],o.maxed=M(()=>c.gte(o.amount.value,s(o.limit))),F(o,"classes");const u=o.classes;o.classes=M(()=>{const N=s(u)||{};return o.maxed.value&&(N.bought=!0),N}),o.amountToIncrease=M(()=>c.clampMin(fi(o.requirements),1)),o.canClick=M(()=>tn(o.requirements));const f=o.onClick;o.onClick=function(N){var S;const I=o;if(!s(I.canClick))return;const P=(S=s(o.amountToIncrease))!=null?S:1;gi(o.requirements,P),I.amount.value=c.add(I.amount.value,P),f==null||f(N)},F(o,"display");const h=o.display;o.display=Z(()=>{var I,P,S;const N=s(h);if(rt(N)){const T=Q(N);return p(T,null,null)}if(N!=null){const T=o,V=Q((I=N.title)!=null?I:"","h3"),ae=Q((P=N.description)!=null?P:""),re=Q((S=N.effectDisplay)!=null?S:"");return p("span",null,[N.title==null?null:p("div",null,[p(V,null,null)]),N.description==null?null:p(ae,null,null),N.showAmount===!1?null:p("div",null,[p("br",null,null),p(z,null,[D("Amount: "),gt(T.amount.value)]),c.isFinite(s(T.limit))?p(z,null,[D(" / "),gt(s(T.limit))]):void 0]),N.effectDisplay==null?null:p("div",null,[p("br",null,null),D("Currently: "),p(re,null,null)]),T.maxed.value?null:p("div",null,[p("br",null,null),At(T.requirements,s(o.amountToIncrease))])])}return""}),F(o,"visibility"),K(o,"visibility",pe.Visible),F(o,"limit"),K(o,"limit",c.dInf),F(o,"style"),F(o,"mark"),F(o,"small");for(const N of t)(w=N.postConstruct)==null||w.call(N,o);const g=t.reduce((N,I)=>{var P;return Object.assign(N,(P=I.getGatheredProps)==null?void 0:P.call(I,o))},{});return o[Le]=function(){const{display:N,visibility:I,style:P,classes:S,onClick:T,canClick:V,small:ae,mark:re,id:Y}=this;return{display:N,visibility:I,style:s(P),classes:S,onClick:T,canClick:V,small:ae,mark:re,id:Y,...g}},o})}const lc={postConstruct(e){e.amount===void 0&&console.error(`Decorated feature ${e.id} does not contain the required 'amount' property"`),F(e,"bonusAmount"),e.totalAmount===void 0&&(e.totalAmount=M(()=>{var t;return c.add(s((t=e.amount)!=null?t:0),s(e.bonusAmount))}))}};function Bt(e){return Te(t=>{const{multiplier:n,description:i,enabled:r,smallerIsBetter:o}=e.call(t,t),a=_e(n),l=_e(i),u=r==null?void 0:_e(r);return{apply:f=>c.times(f,s(a)),invert:f=>c.div(f,s(a)),getFormula:f=>d.times(f,a),enabled:u,description:i==null?void 0:Z(()=>p("div",{class:"modifier-container"},[s(l)!=null?p("span",{class:"modifier-description"},[Re(s(l))]):null,p("span",{class:"modifier-amount",style:(o===!0?c.gt(s(a),1):c.lt(s(a),1))?"color: var(--danger)":""},[D("\xD7"),mn(s(a))])]))}})}function Bn(e){return Te(()=>{const t=e();return{apply:n=>t.filter(i=>s(i.enabled)!==!1).reduce((i,r)=>r.apply(i),n),invert:t.every(n=>n.invert!=null)?n=>t.filter(i=>s(i.enabled)!==!1).reduceRight((i,r)=>r.invert(i),n):void 0,getFormula:t.every(n=>n.getFormula!=null)?n=>t.filter(i=>s(i.enabled)!==!1).reduce((i,r)=>r.getFormula(i),n):void 0,enabled:t.some(n=>n.enabled!=null)?M(()=>t.filter(n=>s(n.enabled)!==!1).length>0):void 0,description:t.some(n=>n.description!=null)?Z(()=>p(z,null,[t.filter(n=>s(n.enabled)!==!1).map(n=>s(n.description)).filter(n=>n).map(Re)])):void 0}})}const Lt={postConstruct(e){F(e,"effect")}};var uc=L({props:{display:{type:B(String,Object,Function),required:!0},visibility:{type:B(Number,Boolean),required:!0},style:B(String,Object,Array),classes:B(Object),requirements:{type:Object,required:!0},canPurchase:{type:B(Boolean),required:!0},bought:{type:B(Boolean),required:!0},mark:B(Boolean,String),id:{type:String,required:!0},purchase:{type:Function,required:!0}},components:{Node:en,MarkNode:Qt},setup(e){const{display:t,requirements:n,bought:i}=ue(e),r=$e("");return qe(()=>{const o=we(t);if(o==null){r.value="";return}if(rt(o)){r.value=Q(o);return}const a=Q(o.title||"","h3"),l=Q(o.description,"div"),u=Q(o.effectDisplay||"");r.value=Q(Z(()=>p("span",null,[o.title!=null?p("div",null,[p(a,null,null)]):null,p(l,null,null),o.effectDisplay!=null?p("div",null,[D("Currently: "),p(u,null,null)]):null,i.value?null:p(z,null,[p("br",null,null),At(n.value)])])))}),{component:r,unref:s,Visibility:pe,isVisible:it,isHidden:Xt}}});const cc=["disabled"];function dc(e,t,n,i,r,o){var u;const a=De("MarkNode"),l=De("Node");return e.isVisible(e.visibility)?(_(),k("button",{key:0,style:he([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(u=e.unref(e.style))!=null?u:{}]),onClick:t[0]||(t[0]=(...f)=>e.purchase&&e.purchase(...f)),class:se({feature:!0,upgrade:!0,can:e.unref(e.canPurchase),locked:!e.unref(e.canPurchase),bought:e.unref(e.bought),...e.unref(e.classes)}),disabled:!e.unref(e.canPurchase)},[e.unref(e.component)?(_(),G(be(e.unref(e.component)),{key:0})):A("",!0),p(a,{mark:e.unref(e.mark)},null,8,["mark"]),p(l,{id:e.id},null,8,["id"])],14,cc)):A("",!0)}var fc=ee(uc,[["render",dc],["__scopeId","data-v-9be6bac0"]]);const gc=Symbol("Upgrade");function ln(e,...t){const n=je(!1,!1),i=t.reduce((r,o)=>{var a;return Object.assign(r,(a=o.getPersistentData)==null?void 0:a.call(o))},{});return Te(r=>{var u,f;const o=e.call(r,r);o.id=Nt("upgrade-"),o.type=gc,o[Be]=fc;for(const h of t)(u=h.preConstruct)==null||u.call(h,o);o.bought=n,Object.assign(o,i),o.canPurchase=M(()=>!n.value&&tn(o.requirements)),o.purchase=function(){var g;const h=o;!s(h.canPurchase)||(gi(o.requirements),n.value=!0,(g=h.onPurchase)==null||g.call(h))};const a=In(o);Ue(o.requirements)?o.requirements.unshift(a):o.requirements=[a,o.requirements],F(o,"visibility"),K(o,"visibility",pe.Visible),F(o,"classes"),F(o,"style"),F(o,"display"),F(o,"mark");for(const h of t)(f=h.postConstruct)==null||f.call(h,o);const l=t.reduce((h,g)=>{var m;return Object.assign(h,(m=g.getGatheredProps)==null?void 0:m.call(g,o))},{});return o[Le]=function(){const{display:h,visibility:g,style:m,classes:y,requirements:w,canPurchase:N,bought:I,mark:P,id:S,purchase:T}=this;return{display:h,visibility:g,style:s(m),classes:y,requirements:w,canPurchase:N,bought:I,mark:P,id:S,purchase:T,...l}},o})}function mc(e,t){const n=[];for(let i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n}function pc(e){return{apply:t=>c.lt(s(e.cap.value),t)?s(e.cap.value):t,description:M(()=>"Cap at "+ye(s(e.cap.value)))}}var hc=L({props:{visibility:{type:B(Number,Boolean),required:!0},display:B(Object,String,Function),earned:{type:B(Boolean),required:!0},requirements:B(Object,Array),image:B(String),style:B(String,Object,Array),classes:B(Object),mark:B(Boolean,String),small:B(Boolean),id:{type:String,required:!0}},components:{Node:en,MarkNode:Qt},setup(e){const{display:t,requirements:n,earned:i}=ue(e),r=$e("");return qe(()=>{const o=we(t);if(o==null){r.value="";return}if(rt(o)){r.value=Q(o);return}const a=Q(o.requirement?o.requirement:Z(()=>{var f;return At((f=we(n))!=null?f:[])}),"h3"),l=Q(o.effectDisplay||"","b"),u=we(i)?Q(o.optionsDisplay||"","span"):"";r.value=Q(Z(()=>p("span",null,[p(a,null,null),o.effectDisplay!=null?p("div",null,[p(l,null,null)]):null,o.optionsDisplay!=null?p("div",{class:"equal-spaced"},[p(u,null,null)]):null])))}),{comp:r,unref:s,Visibility:pe,isVisible:it,isHidden:Xt}}});function vc(e,t,n,i,r,o){var u;const a=De("MarkNode"),l=De("Node");return e.isVisible(e.visibility)?(_(),k("div",{key:0,style:he([{visibility:e.isHidden(e.visibility)?"hidden":void 0,backgroundImage:e.earned&&e.image&&`url(${e.image})`||""},(u=e.unref(e.style))!=null?u:[]]),class:se({feature:!0,achievement:!0,locked:!e.unref(e.earned),done:e.unref(e.earned),small:e.unref(e.small),...e.unref(e.classes)})},[e.comp?(_(),G(be(e.comp),{key:0})):A("",!0),p(a,{mark:e.unref(e.mark)},null,8,["mark"]),p(l,{id:e.id},null,8,["id"])],6)):A("",!0)}var bc=ee(hc,[["render",vc],["__scopeId","data-v-5673325a"]]);ve.on("setupVue",e=>e.use(Pi));const yc=Un(),_c=Symbol("Achievement");let vt=function(e){return e.All="all",e.Configurable="configurable",e.Incomplete="incomplete",e.None="none",e}({});function Nc(e,...t){const n=je(!1,!1),i=t.reduce((r,o)=>{var a;return Object.assign(r,(a=o.getPersistentData)==null?void 0:a.call(o))},{});return Te(r=>{var u,f,h;const o=(u=e==null?void 0:e.call(r,r))!=null?u:{};o.id=Nt("achievement-"),o.type=_c,o[Be]=bc;for(const g of t)(f=g.preConstruct)==null||f.call(g,o);o.earned=n,o.complete=function(){var m,y;if(n.value)return;n.value=!0;const g=o;if((m=g.onComplete)==null||m.call(g),g.display!=null&&s(g.showPopups)===!0){const w=s(g.display);let N;rt(w)?N=Q(w):w.requirement!=null?N=Q(w.requirement):N=At((y=g.requirements)!=null?y:[]),yc.info(p("div",null,[p("h3",null,[D("Achievement earned!")]),p("div",null,[p(N,null,null)])]))}},Object.assign(o,i),F(o,"visibility"),K(o,"visibility",pe.Visible);const a=o.visibility;o.visibility=Si(()=>{const g=s(o.display);switch(J.msDisplay){default:case vt.All:return s(a);case vt.Configurable:return s(o.earned)&&!(g!=null&&typeof g=="object"&&"optionsDisplay"in g)?pe.None:s(a);case vt.Incomplete:return s(o.earned)?pe.None:s(a);case vt.None:return pe.None}}),F(o,"display"),F(o,"mark"),F(o,"small"),F(o,"image"),F(o,"style"),F(o,"classes"),F(o,"showPopups"),K(o,"showPopups",!0);for(const g of t)(h=g.postConstruct)==null||h.call(g,o);const l=t.reduce((g,m)=>{var y;return Object.assign(g,(y=m.getGatheredProps)==null?void 0:y.call(m,o))},{});if(o[Le]=function(){const{visibility:g,display:m,requirements:y,earned:w,image:N,style:I,classes:P,mark:S,small:T,id:V}=this;return{visibility:g,display:m,requirements:y,earned:w,image:N,style:s(I),classes:P,mark:S,small:T,id:V,...l}},o.requirements){const g=o,m=[In(g),oc(()=>!g.earned.value),...Ue(o.requirements)?o.requirements:[o.requirements]];qe(()=>{J.active===E.id&&tn(m)&&g.complete()})}return o})}ve.on("loadSettings",e=>{K(e,"msDisplay",vt.All)});const wc=Object.values(vt).map(e=>({label:pn(e),value:e}));ts(Z(()=>p(kn,{title:Z(()=>p("span",{class:"option-title"},[D("Show achievements"),p("desc",null,[D("Select which achievements to display based on criterias.")])])),options:wc,"onUpdate:modelValue":e=>J.msDisplay=e,modelValue:J.msDisplay},null)));const Ln=[{requiredSize:-2,baseCost:1,scaling:1.4},{requiredSize:-1,baseCost:1e5,scaling:1.5},{requiredSize:0,baseCost:1e12,scaling:1.6},{requiredSize:1,baseCost:1e20,scaling:1.7}],Cc=function(e){const t="C",n="Cascade-"+e.position,i="#4BDC13",r=Nn(t+"-"+e.position,function(){let o;const a=O(1e25);if(e.position===0)o=an(1,"stuff");else{const $=e.layers[e.position-1];o=an(M({get:()=>c.div(s($.points),1e20),set:ie=>$.points.value=c.mul(ie,1e20)}),"stuff",0,!0)}const l=Tu(()=>({thingsToReset:()=>[r]})),u=Ju(()=>({layerID:this.id,display:t,color:i,reset:l})),f=Xu(u,{display:Yu(o),pinnable:!0});function h($,ie){return St(()=>({cost:M(()=>c.mul($.baseCost,c.pow($.scaling,s(ie.amount)))),resource:Vt(o)}))}const g=[],m=Bn(()=>g),y=Bt(()=>({multiplier:M(()=>m.apply(1)),description:"All Boost"})),w=[],N=[],I=[],P=[];for(let $=0;$<Ln.length&&!($>e.size+2);$++){const ie=Ln[$];w[$]=qn(ot=>({requirements:h(ie,ot),display:Z(()=>p(z,null,[t+"-"+$,p("br",null,null),"Amount: "+ye(s(ot.totalAmount))+" ("+ye(s(ot.amount))+")",p("br",null,null),At(ot.requirements)])),bonusAmountRaw:je(0),bonusAmount:M(()=>ot.bonusAmountRaw.value)}),lc),P[$]=[Bt(()=>({multiplier:w[$].totalAmount,description:()=>"Structure Count"})),y];const Ae=je(!0);N[$]=Nc(()=>({requirements:St(()=>({resource:an(w[$].amount,`C-${$} Amount`),cost:50,requiresPay:!1})),display:{effectDisplay:"Autobuy C-"+$,optionsDisplay:Z(()=>p(z,null,[p(Ee,{modelValue:Ae.value,"onUpdate:modelValue":ot=>{Ae.value=ot}},null)]))},small:!0,showPopups:!1,togglePersist:Ae})),I.push(Bu(this,w[$],()=>Ae.value&&N[$].earned.value))}function S($){return e.size<$.index-2?null:ln(ie=>({requirements:St(()=>({cost:$.cost,resource:Vt(o)})),effect:()=>c.pow($.effect,s(w[$.index].amount)),display:{title:"Resonance "+$.index,description:"Purchased C-"+$.index+" boost themselves by "+$.effect+"x",effectDisplay:Z(()=>p(z,null,[ye(s(ie.effect))+"x"]))},appliesTo:$.index}),Lt)}function T($){return e.upgrade<$.requirement?null:ln(ie=>({requirements:St(()=>({cost:$.cost,resource:Vt(o)})),effect:()=>2,display:{title:"Spectrum "+$.index,description:"All production on this layer is doubled",effectDisplay:Z(()=>p(z,null,[ye(s(ie.effect))+"x"]))},appliesTo:-1}),Lt)}const V={res0:S({index:0,cost:200,effect:1.1}),spec1:T({index:1,cost:1e5,requirement:-1}),res1:S({index:1,cost:2e7,effect:1.08}),cond0:e.upgrade>=0?ln($=>({requirements:St(()=>({cost:1e13,resource:Vt(o)})),effect:()=>c.add(10,s(w[0].totalAmount)).log10(),display:{title:"Condense 0",description:"Boost C-0 by log10 of C-0",effectDisplay:Z(()=>p(z,null,[ye(s($.effect))+"x"]))},appliesTo:0}),Lt):null,res2:S({index:2,cost:2e16,effect:1.06}),spec2:T({index:2,cost:1e21,requirement:1})};for(const $ in V)V[$]===null&&delete V[$];const ae=Object.values(V);function re($){return e.repeatable<$.index-2||e.size<$.appliesTo-2?null:qn(ie=>({requirements:h({baseCost:$.cost,scaling:$.scaling},ie),effect:()=>c.pow($.effect,s(ie.amount)),display:{title:"CR-"+$.index,description:$.effect+"x C-"+$.appliesTo+" production per level",effectDisplay:Z(()=>p(z,null,[ye(s(ie.effect))+"x"]))},limit:$.limit,appliesTo:$.appliesTo,shouldAdd:e.repeatable>=$.index-2}),Lt)}const Y=[re({index:0,cost:100,scaling:100,effect:3,limit:5+e.repeatable*2,appliesTo:0}),re({index:1,cost:1e9,scaling:1e3,effect:2,limit:3+e.repeatable,appliesTo:0}),re({index:2,cost:1e16,scaling:1e4,effect:3,limit:3,appliesTo:1}),re({index:3,cost:1e21,scaling:1e5,effect:3,limit:3,appliesTo:2})];for(let $=Y.length-1;$>=0;$--)Y[$]===null&&Y.splice($,1);const ne=[];for(let $=0;$<P.length;$++)ne[$]=Bn(()=>P[$]);for(const $ of ae){const ie=$.appliesTo;if(ie===void 0)continue;const Ae=Bt(()=>({multiplier:$.effect,description:$.display.title,enabled:$.bought}));ie===-1?g.push(Ae):P[ie].push(Ae)}for(const $ of Y){const ie=$.appliesTo;if(ie===void 0)continue;const Ae=Bt(()=>({multiplier:$.effect,description:$.display.title,enabled:()=>c.gt(s($.amount),0)}));ie===-1?g.push(Ae):P[ie].push(Ae)}P[0].push(pc({cap:a})),this.on("update",$=>{e.position===0?o.value=c.add(o.value,ne[0].apply($)):e.layers[e.position-1].cap.value=c.mul(1e25,c.max(1,ne[0].apply(10)));for(let ie=0;ie<w.length-1;ie++)w[ie].bonusAmountRaw.value=c.add(w[ie].bonusAmountRaw.value,ne[ie+1].apply($))});const W=[{title:"All Boost",modifier:y}];for(let $=0;$<w.length;$++)W.push({title:"C-"+$+" Production",modifier:ne[$]});e.position!==0&&(W[1].base=10);const[ge,Pe]=Ku(()=>W),Ge=mc(ae,5).map($=>An(...$)),ht=O(!1);return{name:n,color:i,points:o,cap:a,tooltip:f,display:Z(()=>p(z,null,[p("button",{class:"button",style:{display:"inline-block",fontSize:"20px"},onClick:()=>ht.value=!0},[D("Modifiers")]),p(st,{modelValue:ht.value,"onUpdate:modelValue":$=>{ht.value=$}},{header:()=>p("h2",null,[D("Modifiers")]),body:()=>mt(ge)}),p(sc,{resource:o,color:i},null),p("div",null,[D("Production capped at "),ye(a.value)]),Ge,p("br",null,null),An(...Y),p("br",null,null),p(Qn,null,{default:()=>[En(...w),En(...N)]})])),treeNode:u,structures:w,upgrades:V,repeatables:Y,modifierSection:ge,modifierSectionCollapsed:Pe,autoMilestones:N,autoHooks:I}});return r},mi=Nn("main",function(){const e=M(()=>s(t.types.builder.nodes)[0]),t=$u(n=>({links:()=>{const i=[];return s(n.nodes),e.value.state.linked.forEach(r=>{i.push({startNode:e.value,endNode:on(n,r),stroke:"var(--foreground)",strokeWidth:4})}),i},types:{builder:{actions:[{icon:"build",id:"build",onClick:i=>{var a;const r=i.state,o=r.linked;if(!r.active&&o.length>0){r.active=!0;const l=[];for(let u=0;u<o.length;u++){const f=on(n,o[u]),h=pi(f,l);wn(h,E),E.tabs.push(h.id),f.position={x:i.position.x-100*o.length+200*u+100,y:i.position.y+300}}}else if(r.active){r.active=!1;for(let l=0;l<o.length;l++){const f=on(n,o[l]).state,h=f.layerId,g=si(h);(a=g==null?void 0:g.autoHooks)==null||a.forEach(y=>y()),Cn(g),delete E.layers[h];const m=E.tabs.indexOf(h);m!=-1&&E.tabs.splice(m,1),delete f.layerId}}},tooltip:{text:"BUILD"}}],canAccept:(i,r)=>r.type!="layer"?!1:!i.state.active,draggable:!1,onDrop:(i,r)=>{const o=i.state.linked;if(o.includes(r.id)){const a=o.indexOf(r.id);a>-1&&o.splice(a,1)}else o.push(r.id)},shape:Xe.Diamond,size:100,title:"Builder"},layer:{draggable:i=>i.state.layerId===void 0,shape:Xe.ChainStart,size:50,title:i=>i.state.type},part:{draggable:!0,shape:Xe.ChainBody,size:50,title:""}},startNodes:()=>[{position:{x:0,y:0},type:"builder",state:{active:!1,linked:[]}},{position:{x:100,y:100},type:"layer",state:{type:"cascade",parts:[]}},{position:{x:200,y:100},type:"layer",state:{type:"cascade",parts:[{type:"size",stars:1},{type:"repeatable",stars:1}]}},{position:{x:300,y:100},type:"part",state:{type:"size",stars:1}}]}));return{name:"Board",display:Z(()=>p(z,null,[E.devSpeed===0?p("div",null,[D("Game Paused")]):null,E.devSpeed!=null&&E.devSpeed!==0&&E.devSpeed!==1?p("div",null,[D("Dev Speed: "),ye(E.devSpeed),D("x")]):null,E.offlineTime!=null&&E.offlineTime!==0?p("div",null,[D("Offline Time: "),Kt(E.offlineTime)]):null,p(Wl,null,null),mt(t)])),board:t}});function pi(e,t){const n=e.state,i={position:t.length,size:0,upgrade:0,repeatable:0,layers:t};n.parts.forEach(o=>{i[o.type]+=o.stars});const r=Cc(i);return n.layerId=r.id,t.push(r),r}const kc=e=>{var i,r,o,a,l;const t=[mi],n=[];return(l=(a=(o=(r=(i=e.layers)==null?void 0:i.main)==null?void 0:r.board)==null?void 0:o.state)==null?void 0:a.nodes)==null||l.filter(u=>(u==null?void 0:u.type)=="layer").forEach(u=>{u.state.layerId!=null&&pi(u,n)}),t.push(...n),t},hi=M(()=>!1);function Sc(e,t){}var Ic=Object.freeze(Object.defineProperty({__proto__:null,main:mi,getInitialLayers:kc,hasWon:hi,fixOldSave:Sc},Symbol.toStringTag,{value:"Module"}));const Et=e=>(tt("data-v-4a50ce42"),e=e(),nt(),e),Mc={class:"game-over-modal-header"},$c=["src","alt"],xc={class:"game-over-modal-title"},Tc=Et(()=>b("h2",null,"Congratulations!",-1)),Pc={key:0},Fc=Et(()=>b("br",null,null,-1)),Dc=Et(()=>b("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),Ac=Et(()=>b("br",null,null,-1)),Ec=["href"],Oc=Et(()=>b("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),Vc=L({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:i,discordLink:r,versionNumber:o,versionTitle:a}=X,l=M(()=>Kt(E.timePlayed)),u=M(()=>hi.value&&!E.keepGoing),f=Ze(E,"autosave");function h(){E.keepGoing=!0}function g(){ut(bt())}return(m,y)=>(_(),G(st,{"model-value":s(u)},{header:q(()=>[b("div",Mc,[s(n)?(_(),k("img",{key:0,class:"game-over-modal-logo",src:s(n),alt:s(t)},null,8,$c)):A("",!0),b("div",xc,[Tc,b("h4",null,"You've beaten "+R(s(t))+" v"+R(s(o))+": "+R(s(a)),1)])])]),body:q(({shown:w})=>[w?(_(),k("div",Pc,[b("div",null,"It took you "+R(s(l))+" to beat the game.",1),Fc,Dc,Ac,b("div",null,[b("a",{href:s(r),class:"game-over-modal-discord-link"},[Oc,D(" "+R(s(i)),1)],8,Ec)]),p(Ee,{title:"Autosave",modelValue:s(f),"onUpdate:modelValue":y[0]||(y[0]=N=>de(f)?f.value=N:null)},null,8,["modelValue"])])):A("",!0)]),footer:q(()=>[b("div",{class:"game-over-footer"},[b("button",{onClick:h,class:"button"},"Keep Going"),b("button",{onClick:g,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var qc=ee(Vc,[["__scopeId","data-v-4a50ce42"]]);const nn=e=>(tt("data-v-d3bb0716"),e=e(),nt(),e),Bc=nn(()=>b("div",{class:"nan-modal-header"},[b("h2",null,"NaN value detected!")],-1)),Lc={key:0},Rc=nn(()=>b("br",null,null,-1)),zc=["href"],Uc=nn(()=>b("span",{class:"material-icons nan-modal-discord"},"discord",-1)),jc=nn(()=>b("br",null,null,-1)),Gc={class:"nan-footer"},Wc=L({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=X,i=O(!0),r=O(!0),o=Ze(le,"hasNaN"),a=O(null);ze(o,m=>{m?(i.value=E.autosave,r.value=E.devSpeed===0):(E.autosave=i.value,E.devSpeed=r.value?0:null)});const l=M(()=>{var m;return(m=le.NaNPath)==null?void 0:m.join(".")}),u=M(()=>le.NaNPersistent!=null?le.NaNPersistent.value:null);function f(){le.NaNPersistent!=null&&(le.NaNPersistent.value=new c(0),le.hasNaN=!1)}function h(){le.NaNPersistent&&(le.NaNPersistent.value=new c(1),le.hasNaN=!1)}function g(){le.NaNPersistent&&(le.NaNPersistent.value=new c(NaN),le.hasNaN=!1)}return(m,y)=>(_(),k(z,null,[p(st,He({modelValue:s(o),"onUpdate:modelValue":y[4]||(y[4]=w=>de(o)?o.value=w:null)},m.$attrs),{header:q(()=>[Bc]),body:q(()=>[b("div",null,[D(' Attempted to assign "'+R(s(l))+'" to NaN',1),s(u)?(_(),k("span",Lc,R(" ")+"(previously "+R(s(ye)(s(u)))+")",1)):A("",!0),D(". Auto-saving has been "+R(i.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),Rc,b("div",null,[b("a",{href:s(n)||"https://discord.gg/yJ4fjnjU54",class:"nan-modal-discord-link"},[Uc,D(" "+R(s(t)||"Profectus & Friends"),1)],8,zc)]),jc,p(Ee,{title:"Autosave",modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=w=>i.value=w)},null,8,["modelValue"]),s(X).enablePausing?(_(),G(Ee,{key:0,title:"Pause game",modelValue:r.value,"onUpdate:modelValue":y[1]||(y[1]=w=>r.value=w)},null,8,["modelValue"])):A("",!0)]),footer:q(()=>[b("div",Gc,[b("button",{onClick:y[2]||(y[2]=w=>{var N;return(N=a.value)==null?void 0:N.open()}),class:"button"},"Open Saves Manager"),b("button",{onClick:f,class:"button"},"Set to 0"),b("button",{onClick:h,class:"button"},"Set to 1"),s(u)&&s(c).neq(s(u),0)&&s(c).neq(s(u),1)?(_(),k("button",{key:0,onClick:y[3]||(y[3]=w=>o.value=!1),class:"button"}," Set to previous ")):A("",!0),b("button",{onClick:g,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),p(li,{ref_key:"savesManager",ref:a},null,512)],64))}});var Hc=ee(Wc,[["__scopeId","data-v-d3bb0716"]]);const Zc={key:0,class:"tpsDisplay"},Yc=L({__name:"TPS",setup(e){const t=M(()=>c.div(le.lastTenTicks.length,le.lastTenTicks.reduce((n,i)=>n+i,0)));return(n,i)=>s(t).isNan()?A("",!0):(_(),k("div",Zc,"TPS: "+R(s(gt)(s(t))),1))}});var Jc=ee(Yc,[["__scopeId","data-v-89b89152"]]);var Kc=L({__name:"App",setup(e){const t=X.useHeader,n=M(()=>Se[J.theme].variables),i=Ze(J,"showTPS"),r=Ze(le,"errors"),o=M(()=>Q(Z(()=>p(z,null,[is.map(mt)]))));return(a,l)=>s(r).length>0?(_(),k("div",{key:0,class:"error-container",style:he(s(n))},[p(jn,{errors:s(r)},null,8,["errors"])],4)):(_(),k(z,{key:1},[b("div",{id:"modal-root",style:he(s(n))},null,4),b("div",{class:se(["app",{useHeader:s(t)}]),style:he(s(n))},[s(t)?(_(),G(ui,{key:0})):A("",!0),p(Gl),s(s(i))?(_(),G(Jc,{key:1})):A("",!0),p(qc),p(Hc),(_(),G(be(s(o))))],6)],64))}});var Xc=ee(Kc,[["__scopeId","data-v-bf4e22ac"]]);function Qc(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:o,onRegisterError:a}=e;let l,u,f,h;const g=async(y=!0)=>{await f,y&&(l==null||l.addEventListener("controlling",w=>{w.isUpdate&&window.location.reload()})),await(h==null?void 0:h())};async function m(){if("serviceWorker"in navigator){const{Workbox:y,messageSW:w}=await xt(()=>import("./workbox-window.4a8794bb.js"),[]);h=async()=>{u&&u.waiting&&await w(u.waiting,{type:"SKIP_WAITING"})},l=new y("./sw.js",{scope:"./",type:"classic"}),l.addEventListener("activated",N=>{N.isUpdate||i==null||i()});{const N=()=>{n==null||n()};l.addEventListener("waiting",N),l.addEventListener("externalwaiting",N)}l.register({immediate:t}).then(N=>{u=N,o?o("./sw.js",N):r==null||r(N)}).catch(N=>{a==null||a(N)})}}return f=m(),g}function ed(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:o,onRegisterError:a}=e,l=O(!1),u=O(!1);return{updateServiceWorker:Qc({immediate:t,onNeedRefresh(){l.value=!0,n==null||n()},onOfflineReady(){u.value=!0,i==null||i()},onRegistered:r,onRegisteredSW:o,onRegisterError:a}),offlineReady:u,needRefresh:l}}const Mn=console.error;console.error=function(...e){Mn(...e)};window.onerror=function(e,t,n,i,r){return le.errors.push(r instanceof Error?r:new Error(JSON.stringify(r))),Mn(r),!0};window.onunhandledrejection=function(e){le.errors.push(e.reason instanceof Error?e.reason:new Error(JSON.stringify(e.reason))),Mn(e.reason)};document.title=X.title;window.projInfo=X;X.id===""&&console.error("Project ID is empty!","Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await Kr();const{globalBus:e}=await xt(()=>Promise.resolve().then(function(){return Jr}),void 0),{startGameLoop:t}=await xt(()=>import("./gameLoop.73c893b3.js"),["assets/gameLoop.73c893b3.js","assets/@fontsource.f66d05e7.css","assets/vue.70b1b80d.js","assets/amator.44aadee5.js","assets/bezier-easing.a990b400.js","assets/@vue.6b211d3c.js","assets/lz-string.dccec454.js","assets/nanoevents.1080beb7.js","assets/vue-next-select.16313da0.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.400ed3a6.js","assets/sortablejs.8a81d281.js","assets/vue-textarea-autosize.35804eaf.js","assets/vue-panzoom.0776ea98.js","assets/panzoom.63406b21.js","assets/wheel.e7ba1027.js","assets/ngraph.events.083734c6.js","assets/vue-toastification.5e0793ee.js","assets/vue-toastification.4b5f8ac8.css"]),n=window.vue=Ii(Xc);n.config.errorHandler=function(i,r,o){console.error(i,o,r)},e.emit("setupVue",n),n.mount("#app"),ft(()=>{const i=Un(),{updateServiceWorker:r}=ed({onNeedRefresh(){i.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){r()}})},onOfflineReady(){i.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(o){o&&setInterval(()=>o.update(),60*60*1e3)}})}),t()});export{c as D,xt as _,le as a,X as b,Ic as c,ve as g,Xr as l,E as p,J as s};
