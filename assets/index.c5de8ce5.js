/* empty css                    */import"./vue.024b280c.js";import{q as vt,C as o,ab as B,t as A,aF as _,a1 as S,aL as Ae,bv as ht,G as ie,as as lt,_ as $,az as Tt,a2 as y,J as L,O as R,aK as Ie,a0 as E,I as me,a8 as O,a9 as h,b7 as V,aI as Ke,aG as Xe,l as le,u as tn,b2 as $e,aD as Dn,w as Se,b3 as We,ap as ai,aH as Dt,A as de,$ as G,b9 as nn,ar as Le,bt as li,bc as kt,T as ui,j as ci,bw as Re,ay as di,aM as Be,aO as ve,z as ze,bo as fi,bs as gi,bd as wn,am as Bt,H as mi,bf as pi}from"./@vue.6f8187b0.js";import{L as Ee}from"./lz-string.dccec454.js";import{c as En}from"./nanoevents.1080beb7.js";import{Y as hi}from"./vue-next-select.b54494ec.js";import{D as vi}from"./vuedraggable.494fa47c.js";import{p as bi}from"./vue-textarea-autosize.35804eaf.js";import{P as yi}from"./vue-panzoom.f7879767.js";import{s as _i,u as Ni}from"./vue-toastification.94080fa2.js";import"./amator.44aadee5.js";import"./bezier-easing.a990b400.js";import"./sortablejs.8a81d281.js";import"./panzoom.63406b21.js";import"./wheel.e7ba1027.js";import"./ngraph.events.083734c6.js";const wi=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};wi();const Ci="modulepreload",Cn={},ki="./",St=function(t,n){return!n||n.length===0?t():Promise.all(n.map(i=>{if(i=`${ki}${i}`,i in Cn)return;Cn[i]=!0;const r=i.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${s}`))return;const a=document.createElement("link");if(a.rel=r?"stylesheet":Ci,r||(a.as="script",a.crossOrigin=""),a.href=i,document.head.appendChild(a),r)return new Promise((l,u)=>{a.addEventListener("load",l),a.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t())},Si="./projInfo-schema.json",Ii="Layer Crafter",Mi="A project made in Profectus",xi="layer-crafter",$i="rft50",Ti="",Pi="",Fi="0.0",Di="Initial Commit",Ei=!1,Ai=!1,Oi=2,Vi=!0,qi=null,Li="",Ri=["main"],Bi=3600,zi=1,Ui=!0,ji="base64";var J={$schema:Si,title:Ii,description:Mi,id:xi,author:$i,discordName:Ti,discordLink:Pi,versionNumber:Fi,versionTitle:Di,allowGoBack:Ei,defaultShowSmall:Ai,defaultDecimalsShown:Oi,useHeader:Vi,banner:qi,logo:Li,initialTabs:Ri,maxTickLength:Bi,offlineLimit:zi,enablePausing:Ui,exportEncoding:ji};const Gi=vt({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,offlineProd:!0,offlineTime:null,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var D=window.player=Gi;function rn(e){return JSON.stringify(e,(t,n)=>o(n))}var Q=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n};const Wi=["onClick"],Hi=B({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=A(!1),i=A(null);function r(){t("click"),i.value&&clearTimeout(i.value),n.value=!1,lt(()=>{n.value=!0,i.value=setTimeout(()=>n.value=!1,500)})}return(s,a)=>(_(),S("button",{onClick:ht(r,["stop"]),class:ie(["feedback",{activated:n.value,left:e.left}])},[Ae(s.$slots,"default",{},void 0,!0)],10,Wi))}});var on=Q(Hi,[["__scopeId","data-v-01a1b95c"]]);const Zt=e=>(Ke("data-v-ac351c02"),e=e(),Xe(),e),Zi={class:"error"},Yi={class:"error-title"},Ji={class:"error-details",style:{"margin-top":"-10px"}},Ki={key:0},Xi={class:"instructions"},Qi=["href"],er=Zt(()=>y("span",{class:"material-icons",style:{"font-size":"16px"}},"content_paste",-1)),tr=Zt(()=>y("span",{style:{"margin-left":"8px","font-size":"medium"}},"Copy Save",-1)),nr=Zt(()=>y("br",null,null,-1)),ir={key:0,style:{"margin-top":"20px"}},rr=Zt(()=>y("h3",null,"Other errors",-1)),or=[rr],sr={class:"error-details"},ar={key:0,style:{"margin-top":"10px"}},lr={key:1,style:{"margin-top":"10px"}},ur=B({__name:"Error",props:{errors:null},setup(e){const t=e,n=$(()=>t.errors[0]),i=$(()=>t.errors.map(a=>a.stack==null?[]:a.stack.split(`
`))),r=$(()=>t.errors.map(a=>a.cause==null?[]:(typeof a.cause=="string"?a.cause:JSON.stringify(a.cause)).split(`
`)));function s(){let a=rn(D);switch(J.exportEncoding){default:console.warn(`Unknown save encoding: ${J.exportEncoding}. Defaulting to lz`);case"lz":a=Ee.compressToUTF16(a);break;case"base64":a=btoa(unescape(encodeURIComponent(a)));break;case"plain":break}console.log(a);const l=document.createElement("textarea");l.value=a,document.body.appendChild(l),l.select(),l.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(l)}return Tt(()=>{D.autosave=!1,D.devSpeed=0}),(a,l)=>(_(),S("div",Zi,[y("h1",Yi,L(o(n).name)+": "+L(o(n).message),1),y("div",Ji,[o(n).cause?(_(),S("div",Ki,[(_(!0),S(R,null,Ie(o(r)[0],u=>(_(),S("div",{key:u},L(u),1))),128))])):E("",!0),o(n).stack?(_(),S("div",{key:1,style:me(o(n).cause?"margin-top: 10px":"")},[(_(!0),S(R,null,Ie(o(i)[0],u=>(_(),S("div",{key:u},L(u),1))),128))],4)):E("",!0)]),y("div",Xi,[O(" Check the console for more details, and consider sharing it with the developers on "),y("a",{href:o(J).discordLink||"https://discord.gg/yJ4fjnjU54",class:"discord-link"},"discord",8,Qi),O("! "),h(on,{onClick:s,class:"button",style:{display:"inline-flex"}},{default:V(()=>[er,tr]),_:1}),nr,e.errors.length>1?(_(),S("div",ir,or)):E("",!0),(_(!0),S(R,null,Ie(e.errors.slice(1),(u,f)=>(_(),S("div",{key:f,style:{"margin-top":"20px"}},[y("details",sr,[y("summary",null,L(u.name)+": "+L(u.message),1),u.cause?(_(),S("div",ar,[(_(!0),S(R,null,Ie(o(r)[f+1],v=>(_(),S("div",{key:v},L(v),1))),128))])):E("",!0),u.stack?(_(),S("div",lr,[(_(!0),S(R,null,Ie(o(i)[f+1],v=>(_(),S("div",{key:v},L(v),1))),128))])):E("",!0)])]))),128))])]))}});var An=Q(ur,[["__scopeId","data-v-ac351c02"]]);class cr{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const i=new dr(t,n);for(this.first===void 0?(this.first=i,this.last=i):(i.next=this.first,this.first.prev=i,this.first=i),this.map.set(t,i);this.map.size>this.maxSize;){const r=this.last;this.map.delete(r.key),this.last=r.prev,this.last.next=void 0}}}class dr{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const Kt=17,fr=9e15,gr=Math.log10(9e15),mr=1/9e15,pr=308,hr=-324,kn=5,vr=(1<<10)-1,br=function(){const e=[];for(let n=hr+1;n<=pr;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),tt=[2,Math.E,3,4,5,6,7,8,9,10],yr=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],_r=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let N=function(t){return c.fromValue_noAlloc(t)},q=function(e,t,n){return c.fromComponents(e,t,n)},j=function(t,n,i){return c.fromComponents_noNormalize(t,n,i)};const je=function(t,n){const i=n+1,r=Math.ceil(Math.log10(Math.abs(t))),s=Math.round(t*Math.pow(10,i-r))*Math.pow(10,r-i);return parseFloat(s.toFixed(Math.max(i-r,0)))},Xt=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},Nr=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const i=e*e;let r=e;return n=n+1/(12*r),r=r*i,n=n+1/(360*r),r=r*i,n=n+1/(1260*r),r=r*i,n=n+1/(1680*r),r=r*i,n=n+1/(1188*r),r=r*i,n=n+691/(360360*r),r=r*i,n=n+7/(1092*r),r=r*i,n=n+3617/(122400*r),Math.exp(n)/t},On=.5671432904097838,Sn=function(e,t=1e-10){let n,i;if(!Number.isFinite(e)||e===0)return e;if(e===1)return On;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let r=0;r<100;++r){if(i=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(i-n)<t*Math.abs(i))return i;n=i}throw Error(`Iteration failed to converge: ${e.toString()}`)};function In(e,t=1e-10){let n,i,r,s;if(!Number.isFinite(e.mag)||e.eq(c.dZero))return e;if(e.eq(c.dOne))return c.fromNumber(On);n=c.ln(e);for(let a=0;a<100;++a){if(i=n.neg().exp(),r=n.sub(e.mul(i)),s=n.sub(r.div(n.add(1).sub(n.add(2).mul(r).div(c.mul(2,n).add(2))))),c.abs(s.sub(n)).lt(c.abs(s).mul(t)))return s;n=s}throw Error(`Iteration failed to converge: ${e.toString()}`)}const m=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof m?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/br(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new m().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new m().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new m().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new m().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new m().fromDecimal(e)}static fromNumber(e){return new m().fromNumber(e)}static fromString(e){return new m().fromString(e)}static fromValue(e){return new m().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof m)return e;if(typeof e=="string"){const t=m.fromStringCache.get(e);return t!==void 0?t:m.fromString(e)}else return typeof e=="number"?m.fromNumber(e):m.dZero}static abs(e){return N(e).abs()}static neg(e){return N(e).neg()}static negate(e){return N(e).neg()}static negated(e){return N(e).neg()}static sign(e){return N(e).sign}static sgn(e){return N(e).sign}static round(e){return N(e).round()}static floor(e){return N(e).floor()}static ceil(e){return N(e).ceil()}static trunc(e){return N(e).trunc()}static add(e,t){return N(e).add(t)}static plus(e,t){return N(e).add(t)}static sub(e,t){return N(e).sub(t)}static subtract(e,t){return N(e).sub(t)}static minus(e,t){return N(e).sub(t)}static mul(e,t){return N(e).mul(t)}static multiply(e,t){return N(e).mul(t)}static times(e,t){return N(e).mul(t)}static div(e,t){return N(e).div(t)}static divide(e,t){return N(e).div(t)}static recip(e){return N(e).recip()}static reciprocal(e){return N(e).recip()}static reciprocate(e){return N(e).reciprocate()}static cmp(e,t){return N(e).cmp(t)}static cmpabs(e,t){return N(e).cmpabs(t)}static compare(e,t){return N(e).cmp(t)}static isNaN(e){return e=N(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=N(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return N(e).eq(t)}static equals(e,t){return N(e).eq(t)}static neq(e,t){return N(e).neq(t)}static notEquals(e,t){return N(e).notEquals(t)}static lt(e,t){return N(e).lt(t)}static lte(e,t){return N(e).lte(t)}static gt(e,t){return N(e).gt(t)}static gte(e,t){return N(e).gte(t)}static max(e,t){return N(e).max(t)}static min(e,t){return N(e).min(t)}static minabs(e,t){return N(e).minabs(t)}static maxabs(e,t){return N(e).maxabs(t)}static clamp(e,t,n){return N(e).clamp(t,n)}static clampMin(e,t){return N(e).clampMin(t)}static clampMax(e,t){return N(e).clampMax(t)}static cmp_tolerance(e,t,n){return N(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return N(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return N(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return N(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return N(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return N(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return N(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return N(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return N(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return N(e).gte_tolerance(t,n)}static pLog10(e){return N(e).pLog10()}static absLog10(e){return N(e).absLog10()}static log10(e){return N(e).log10()}static log(e,t){return N(e).log(t)}static log2(e){return N(e).log2()}static ln(e){return N(e).ln()}static logarithm(e,t){return N(e).logarithm(t)}static pow(e,t){return N(e).pow(t)}static pow10(e){return N(e).pow10()}static pow_base(e,t){return N(e).pow_base(t)}static root(e,t){return N(e).root(t)}static factorial(e,t){return N(e).factorial()}static gamma(e,t){return N(e).gamma()}static lngamma(e,t){return N(e).lngamma()}static exp(e){return N(e).exp()}static sqr(e){return N(e).sqr()}static sqrt(e){return N(e).sqrt()}static cube(e){return N(e).cube()}static cbrt(e){return N(e).cbrt()}static tetrate(e,t=2,n=j(1,0,1)){return N(e).tetrate(t,n)}static iteratedexp(e,t=2,n=j(1,0,1)){return N(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return N(e).iteratedlog(t,n)}static layeradd10(e,t){return N(e).layeradd10(t)}static layeradd(e,t,n=10){return N(e).layeradd(t,n)}static slog(e,t=10){return N(e).slog(t)}static lambertw(e){return N(e).lambertw()}static ssqrt(e){return N(e).ssqrt()}static pentate(e,t=2,n=j(1,0,1)){return N(e).pentate(t,n)}static sin(e){return N(e).sin()}static cos(e){return N(e).cos()}static tan(e){return N(e).tan()}static asin(e){return N(e).asin()}static acos(e){return N(e).acos()}static atan(e){return N(e).atan()}static sinh(e){return N(e).sinh()}static cosh(e){return N(e).cosh()}static tanh(e){return N(e).tanh()}static asinh(e){return N(e).asinh()}static acosh(e){return N(e).acosh()}static atanh(e){return N(e).atanh()}static affordGeometricSeries(e,t,n,i){return this.affordGeometricSeries_core(N(e),N(t),N(n),i)}static sumGeometricSeries(e,t,n,i){return this.sumGeometricSeries_core(e,N(t),N(n),i)}static affordArithmeticSeries(e,t,n,i){return this.affordArithmeticSeries_core(N(e),N(t),N(n),N(i))}static sumArithmeticSeries(e,t,n,i){return this.sumArithmeticSeries_core(N(e),N(t),N(n),N(i))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(N(e),N(t),N(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return j(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return j(t,0,1);const n=Math.floor(Math.random()*(e+1));let i=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(i=Math.trunc(i));let r=Math.pow(10,i);return Math.random()>.9&&(r=Math.trunc(r)),q(t,n,r)}static affordGeometricSeries_core(e,t,n,i){const r=t.mul(n.pow(i));return m.floor(e.div(r).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,i){return t.mul(n.pow(i)).mul(m.sub(1,n.pow(e))).div(m.sub(1,n))}static affordArithmeticSeries_core(e,t,n,i){const s=t.add(i.mul(n)).sub(n.div(2)),a=s.pow(2);return s.neg().add(a.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,i){const r=t.add(i.mul(n));return e.div(2).mul(r.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<mr)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=fr)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<gr&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=m.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const i=e.split("^^^");if(i.length===2){const C=parseFloat(i[0]),w=parseFloat(i[1]),M=i[1].split(";");let P=1;if(M.length===2&&(P=parseFloat(M[1]),isFinite(P)||(P=1)),isFinite(C)&&isFinite(w)){const k=m.pentate(C,w,P);return this.sign=k.sign,this.layer=k.layer,this.mag=k.mag,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}}const r=e.split("^^");if(r.length===2){const C=parseFloat(r[0]),w=parseFloat(r[1]),M=r[1].split(";");let P=1;if(M.length===2&&(P=parseFloat(M[1]),isFinite(P)||(P=1)),isFinite(C)&&isFinite(w)){const k=m.tetrate(C,w,P);return this.sign=k.sign,this.layer=k.layer,this.mag=k.mag,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}}const s=e.split("^");if(s.length===2){const C=parseFloat(s[0]),w=parseFloat(s[1]);if(isFinite(C)&&isFinite(w)){const M=m.pow(C,w);return this.sign=M.sign,this.layer=M.layer,this.mag=M.mag,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}}e=e.trim().toLowerCase();let a,l,u=e.split("pt");if(u.length===2){a=10,l=parseFloat(u[0]),u[1]=u[1].replace("(",""),u[1]=u[1].replace(")","");let C=parseFloat(u[1]);if(isFinite(C)||(C=1),isFinite(a)&&isFinite(l)){const w=m.tetrate(a,l,C);return this.sign=w.sign,this.layer=w.layer,this.mag=w.mag,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}}if(u=e.split("p"),u.length===2){a=10,l=parseFloat(u[0]),u[1]=u[1].replace("(",""),u[1]=u[1].replace(")","");let C=parseFloat(u[1]);if(isFinite(C)||(C=1),isFinite(a)&&isFinite(l)){const w=m.tetrate(a,l,C);return this.sign=w.sign,this.layer=w.layer,this.mag=w.mag,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}}const f=e.split("e"),v=f.length-1;if(v===0){const C=parseFloat(e);if(isFinite(C))return this.fromNumber(C),m.fromStringCache.size>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}else if(v===1){const C=parseFloat(e);if(isFinite(C)&&C!==0)return this.fromNumber(C),m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}const g=e.split("e^");if(g.length===2){this.sign=1,g[0].charAt(0)=="-"&&(this.sign=-1);let C="";for(let w=0;w<g[1].length;++w){const M=g[1].charCodeAt(w);if(M>=43&&M<=57||M===101)C+=g[1].charAt(w);else return this.layer=parseFloat(C),this.mag=parseFloat(g[1].substr(w+1)),this.normalize(),m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}}if(v<1)return this.sign=0,this.layer=0,this.mag=0,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this;const p=parseFloat(f[0]);if(p===0)return this.sign=0,this.layer=0,this.mag=0,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this;let b=parseFloat(f[f.length-1]);if(v>=2){const C=parseFloat(f[f.length-2]);isFinite(C)&&(b*=Math.sign(C),b+=Xt(C))}if(!isFinite(p))this.sign=f[0]==="-"?-1:1,this.layer=v,this.mag=b;else if(v===1)this.sign=Math.sign(p),this.layer=1,this.mag=b+Math.log10(Math.abs(p));else if(this.sign=Math.sign(p),this.layer=v,v===2){const C=m.mul(q(1,2,b),N(p));return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}else this.mag=b;return this.normalize(),m.fromStringCache.maxSize>=1&&m.fromStringCache.set(t,m.fromDecimal(this)),this}fromValue(e){return e instanceof m?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:je(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:je(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=kn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):je(this.m,e)+"e"+je(this.e,e):this.layer===1?je(this.m,e)+"e"+je(this.e,e):this.layer<=kn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+je(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+je(this.mag,e)}abs(){return j(this.sign===0?0:1,this.layer,this.mag)}neg(){return j(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?m.dZero:this.layer===0?q(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?m.dZero:this.layer===0?q(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?m.dZero:this.layer===0?q(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?m.dZero:this.layer===0?q(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=N(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return j(0,0,0);let n,i;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(m.cmpabs(this,t)>0?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return m.fromNumber(n.sign*n.mag+i.sign*i.mag);const r=n.layer*Math.sign(n.mag),s=i.layer*Math.sign(i.mag);if(r-s>=2)return n;if(r===0&&s===-1){if(Math.abs(i.mag-Math.log10(n.mag))>Kt)return n;{const a=Math.pow(10,Math.log10(n.mag)-i.mag),l=i.sign+n.sign*a;return q(Math.sign(l),1,i.mag+Math.log10(Math.abs(l)))}}if(r===1&&s===0){if(Math.abs(n.mag-Math.log10(i.mag))>Kt)return n;{const a=Math.pow(10,n.mag-Math.log10(i.mag)),l=i.sign+n.sign*a;return q(Math.sign(l),1,Math.log10(i.mag)+Math.log10(Math.abs(l)))}}if(Math.abs(n.mag-i.mag)>Kt)return n;{const a=Math.pow(10,n.mag-i.mag),l=i.sign+n.sign*a;return q(Math.sign(l),1,i.mag+Math.log10(Math.abs(l)))}}plus(e){return this.add(e)}sub(e){return this.add(N(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=N(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return j(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return j(this.sign*t.sign,0,1);let n,i;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return m.fromNumber(n.sign*i.sign*n.mag*i.mag);if(n.layer>=3||n.layer-i.layer>=2)return q(n.sign*i.sign,n.layer,n.mag);if(n.layer===1&&i.layer===0)return q(n.sign*i.sign,1,n.mag+Math.log10(i.mag));if(n.layer===1&&i.layer===1)return q(n.sign*i.sign,1,n.mag+i.mag);if(n.layer===2&&i.layer===1){const r=q(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(q(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return q(n.sign*i.sign,r.layer+1,r.sign*r.mag)}if(n.layer===2&&i.layer===2){const r=q(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(q(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return q(n.sign*i.sign,r.layer+1,r.sign*r.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=N(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?m.dNaN:this.layer===0?q(this.sign,0,1/this.mag):q(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=N(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=N(e),n=this.mag>0?this.layer:-this.layer,i=t.mag>0?t.layer:-t.layer;return n>i?1:n<i?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=N(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=N(e);return this.lt(t)?t:this}min(e){const t=N(e);return this.gt(t)?t:this}maxabs(e){const t=N(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=N(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=N(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=N(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let i=this.mag,r=n.mag;return this.layer>n.layer&&(r=Xt(r)),this.layer<n.layer&&(i=Xt(i)),Math.abs(i-r)<=t*Math.max(Math.abs(i),Math.abs(r))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=N(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=N(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=N(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=N(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(m.dZero)?m.dZero:this.log10()}absLog10(){return this.sign===0?m.dNaN:this.layer>0?q(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):q(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?m.dNaN:this.layer>0?q(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):q(this.sign,0,Math.log10(this.mag))}log(e){return e=N(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?m.dNaN:this.layer===0&&e.layer===0?q(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):m.div(this.log10(),e.log10())}log2(){return this.sign<=0?m.dNaN:this.layer===0?q(this.sign,0,Math.log2(this.mag)):this.layer===1?q(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?q(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):q(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?m.dNaN:this.layer===0?q(this.sign,0,Math.log(this.mag)):this.layer===1?q(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?q(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):q(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=N(e),n=this,i=t;if(n.sign===0)return i.eq(0)?j(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(i.sign===0)return j(1,0,1);if(i.sign===1&&i.layer===0&&i.mag===1)return n;const r=n.absLog10().mul(i).pow10();return this.sign===-1?Math.abs(i.toNumber()%2)%2===1?r.neg():Math.abs(i.toNumber()%2)%2===0?r:m.dNaN:r}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return m.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return q(1,0,t);if(e.sign===0)return m.dOne;e=j(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?q(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?q(-e.sign,e.layer+1,-e.mag):m.dOne}pow_base(e){return N(e).pow(this)}root(e){const t=N(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?m.exp(m.mul(this,m.ln(this).sub(1))):m.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(j(1,0,24)))return m.fromNumber(Nr(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let i=e,r=12*i,s=1/r,a=t+s;if(a===t||(t=a,i=i*n,r=360*i,s=1/r,a=t-s,a===t))return m.exp(t);t=a,i=i*n,r=1260*i;let l=1/r;return t=t+l,i=i*n,r=1680*i,l=1/r,t=t-l,m.exp(t)}else return this.layer===1?m.exp(m.mul(this,m.ln(this).sub(1))):m.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?m.dOne:this.layer===0&&this.mag<=709.7?m.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?q(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?q(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):q(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return m.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return q(1,2,Math.log10(this.mag)-.3010299956639812);{const e=m.div(j(this.sign,this.layer-1,this.mag),j(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=j(1,0,1)){if(e===1)return m.pow(this,t);if(e===0)return new m(t);if(this.eq(m.dOne))return m.dOne;if(this.eq(-1))return m.pow(this,t);if(e===Number.POSITIVE_INFINITY){const r=this.toNumber();if(r<=1.444667861009766&&r>=.06598803584531254){if(r>1.444667861009099)return m.fromNumber(Math.E);const s=m.ln(this).neg();return s.lambertw().div(s)}else return r>1.444667861009766?m.fromNumber(Number.POSITIVE_INFINITY):m.dNaN}if(this.eq(m.dZero)){let r=Math.abs((e+1)%2);return r>1&&(r=2-r),m.fromNumber(r)}if(e<0)return m.iteratedlog(t,this,-e);t=N(t);const n=e;e=Math.trunc(e);const i=n-e;if(this.gt(m.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let r=0;r<e;++r){const s=t;if(t=this.pow(t),s.eq(t))return t}if(i!=0){const r=this.pow(t);return t.mul(1-i).add(r.mul(i))}return t}i!==0&&(t.eq(m.dOne)?this.gt(10)?t=this.pow(i):(t=m.fromNumber(m.tetrate_critical(this.toNumber(),i)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let r=0;r<e;++r){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return j(t.sign,t.layer+(e-r-1),t.mag);if(r>1e4)return t}return t}iteratedexp(e=2,t=j(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return m.tetrate(e,-t,this);e=N(e);let n=m.fromDecimal(this);const i=t;t=Math.trunc(t);const r=i-t;if(n.layer-e.layer>3){const s=Math.min(t,n.layer-e.layer-3);t-=s,n.layer-=s}for(let s=0;s<t;++s){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(s>1e4)return n}return r>0&&r<1&&(e.eq(10)?n=n.layeradd10(-r):n=n.layeradd(-r,e)),n}slog(e=10,t=100){let n=.001,i=!1,r=!1,s=this.slog_internal(e).toNumber();for(let a=1;a<t;++a){const u=new m(e).tetrate(s).gt(this);if(a>1&&r!=u&&(i=!0),r=u,i?n/=2:n*=2,n=Math.abs(n)*(u?-1:1),s+=n,n===0)break}return m.fromNumber(s)}slog_internal(e=10){if(e=N(e),e.lte(m.dZero)||e.eq(m.dOne))return m.dNaN;if(e.lt(m.dOne))return this.eq(m.dOne)?m.dZero:this.eq(m.dZero)?m.dNegOne:m.dNaN;if(this.mag<0||this.eq(m.dZero))return m.dNegOne;let t=0,n=m.fromDecimal(this);if(n.layer-e.layer>3){const i=n.layer-e.layer-3;t+=i,n.layer-=i}for(let i=0;i<100;++i)if(n.lt(m.dZero))n=m.pow(e,n),t-=1;else{if(n.lte(m.dOne))return m.fromNumber(t+m.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=m.log(n,e)}return m.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:m.critical_section(e,t,_r)}static tetrate_critical(e,t){return m.critical_section(e,t,yr)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let i=0,r=0;for(let a=0;a<tt.length;++a)if(tt[a]==e){i=n[a][Math.floor(t)],r=n[a][Math.ceil(t)];break}else if(tt[a]<e&&tt[a+1]>e){const l=(e-tt[a])/(tt[a+1]-tt[a]);i=n[a][Math.floor(t)]*(1-l)+n[a+1][Math.floor(t)]*l,r=n[a][Math.ceil(t)]*(1-l)+n[a+1][Math.ceil(t)]*l;break}const s=t-Math.floor(t);return i<=0||r<=0?i*(1-s)+r*s:Math.pow(e,Math.log(i)/Math.log(e)*(1-s)+Math.log(r)/Math.log(e)*s)}layeradd10(e){e=m.fromValue_noAlloc(e).toNumber();const t=m.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let i=0;i<100;++i){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const i=this.slog(t).toNumber()+e;return i>=0?m.tetrate(t,i):Number.isFinite(i)?i>=-1?m.log(m.tetrate(t,i+1),t):m.log(m.log(m.tetrate(t,i+2),t),t):m.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return m.fromNumber(Sn(this.toNumber()));if(this.layer===0)return m.fromNumber(Sn(this.sign*this.mag));if(this.layer===1)return In(this);if(this.layer===2)return In(this);if(this.layer>=3)return j(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return j(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=j(1,0,1)){t=N(t);const n=e;e=Math.trunc(e);const i=n-e;i!==0&&(t.eq(m.dOne)?(++e,t=m.fromNumber(i)):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let r=0;r<e;++r){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(r>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?m.fromNumber(Math.sin(this.sign*this.mag)):j(0,0,0)}cos(){return this.mag<0?m.dOne:this.layer===0?m.fromNumber(Math.cos(this.sign*this.mag)):j(0,0,0)}tan(){return this.mag<0?this:this.layer===0?m.fromNumber(Math.tan(this.sign*this.mag)):j(0,0,0)}asin(){return this.mag<0?this:this.layer===0?m.fromNumber(Math.asin(this.sign*this.mag)):j(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?m.fromNumber(Math.acos(this.toNumber())):this.layer===0?m.fromNumber(Math.acos(this.sign*this.mag)):j(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?m.fromNumber(Math.atan(this.sign*this.mag)):m.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return m.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return m.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?j(Number.NaN,Number.NaN,Number.NaN):m.ln(this.add(1).div(m.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(m.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let c=m;c.fromStringCache=new cr(vr);c.dZero=j(0,0,0);c.dOne=j(1,0,1);c.dNegOne=j(-1,0,1);c.dTwo=j(1,0,2);c.dTen=j(1,0,10);c.dNaN=j(Number.NaN,Number.NaN,Number.NaN);c.dInf=j(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);c.dNegInf=j(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);c.dNumberMax=q(1,0,Number.MAX_VALUE);c.dNumberMin=q(1,0,Number.MIN_VALUE);N=c.fromValue_noAlloc;q=c.fromComponents;j=c.fromComponents_noNormalize;c.fromMantissaExponent;c.fromMantissaExponent_noNormalize;const wr=new c(1);function wt(e,t,n=!0){let i=c.log10(e).floor(),r=c.div(e,c.pow(10,i));r.toStringWithDecimalPlaces(t)==="10"&&(r=wr,i=i.add(1));const s=i.gte(1e9)?we(i,Math.max(Math.max(t,3),J.defaultDecimalsShown)):i.gte(1e4)?zt(i,0):i.toStringWithDecimalPlaces(0);return n?r.toStringWithDecimalPlaces(t)+"e"+s:"e"+s}function zt(e,t){if(e==null)return"NaN";if(e=new c(e),e.mag<.001)return 0 .toFixed(t);const i=e.toStringWithDecimalPlaces(t).split(".");return i[0]=i[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),i.length==1?i[0]:i[0]+"."+i[1]}function Vn(e,t){return e==null?"NaN":(e=new c(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),J.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const Cr=new c("eeee1000"),kr=new c("e100000"),Mn=new c("e1000"),qn=new c(1e9),Sr=new c(1e6),Ir=new c(1e3),Mr=new c(.98),xr=new c(.001),Ln=new c(0);function we(e,t,n){if(t==null&&(t=J.defaultDecimalsShown),n=n!=null?n:J.defaultShowSmall,e=new c(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+we(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(Cr)){const i=e.slog();return i.gte(Sr)?"F"+we(i.floor()):c.pow(10,i.sub(i.floor())).toStringWithDecimalPlaces(3)+"F"+zt(i.floor(),0)}else{if(e.gte(kr))return wt(e,0,!1);if(e.gte(Mn))return wt(e,0);if(e.gte(qn))return wt(e,t);if(e.gte(Ir))return zt(e,0);if(e.gte(xr)||!n)return Vn(e,t);if(e.eq(Ln))return 0 .toFixed(t)}return e=Bn(e),e.lt(Mn)?wt(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):we(e,t)+"\u207B\xB9"}function Ne(e){return e=new c(e),e.sign<0?"-"+Ne(e.neg()):e.gte(qn)||e.lte(Mr)&&!e.eq(Ln)?we(e):we(e,0)}function Rn(e){return c.lt(e,0)?"-"+Rn(c.neg(e)):c.gt(e,2**51)?we(c.div(e,31536e3))+"y":(e=new c(e).toNumber(),e<60?we(e)+"s":e<3600?Ne(Math.floor(e/60))+"m "+we(e%60)+"s":e<86400?Ne(Math.floor(e/3600))+"h "+Ne(Math.floor(e/60)%60)+"m "+Ne(e%60)+"s":e<31536e3?Ne(Math.floor(e/84600)%365)+"d "+Ne(Math.floor(e/3600)%24)+"h "+Ne(Math.floor(e/60)%60)+"m":Ne(Math.floor(e/31536e3))+"y "+Ne(Math.floor(e/84600)%365)+"d "+Ne(Math.floor(e/3600)%24)+"h")}function $r(e,t,n){e=new c(e);let i=e.toStringWithDecimalPlaces(t);return new c(i).gte(n)&&(i=c.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),i}function Tr(e,t){return we(e,t,!0)}function Bn(e){let t=c.log10(e).ceil();const n=c.div(e,c.pow(10,t));return t=t.neg(),e=new c(10).pow(t).times(n),e}var Pr=Object.freeze(Object.defineProperty({__proto__:null,default:c,exponentialFormat:wt,commaFormat:zt,regularFormat:Vn,format:we,formatWhole:Ne,formatTime:Rn,toPlaces:$r,formatSmall:Tr,invertOOM:Bn},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:Fr,commaFormat:Dr,regularFormat:Er,format:ge,formatWhole:ut,formatTime:Yt,toPlaces:Ar,formatSmall:Ut,invertOOM:Or}=Pr;window.Decimal=c;window.exponentialFormat=Fr;window.commaFormat=Dr;window.regularFormat=Er;window.format=ge;window.formatWhole=ut;window.formatTime=Yt;window.toPlaces=Ar;window.formatSmall=Ut;window.invertOOM=Or;function zn(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function Vr(e){return(e[0]+e.slice(1).replace(/[A-Z]/g,t=>`-${t}`)).toLowerCase()}function jt(e){return typeof e=="function"}var z=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(z||{});const It=Symbol("DoNotCache");function F(e,t){const n=e[t];jt(n)&&n.length===0&&!n[It]?e[t]=$(n.bind(e)):jt(n)&&(e[t]=n.bind(e),e[t][It]=!0)}function Oe(e){return jt(e)&&!e[It]&&(e=$(e)),e}const Ve=Symbol("Component"),qe=Symbol("GatherProps");let qr=0;function Pt(e="feature-"){return e+qr++}var ke=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(ke||{});function ct(e){const t=o(e);return t!==2&&t!==!1}function sn(e){return o(e)===1}function Y(e){return e[It]=!0,e}function K(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}function Lr(e,...t){const n=[],i=r=>{Object.keys(r).forEach(s=>{const a=r[s];a!=null&&typeof a=="object"&&(t.includes(a.type)?n.push(a):!(a instanceof c)&&!le(a)&&i(a))})};return i(e),n}var oe=window.state=tn({lastTenTicks:[],hasNaN:!1,NaNPath:[],errors:vt([])});const nt={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!0,mergeAdjacent:!0,showPin:!0};var an=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e))(an||{}),Me={classic:nt,paper:{...nt,variables:{...nt.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"},floatingTabs:!1},nordic:{...nt,variables:{...nt.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"},floatingTabs:!1},aqua:{...nt,variables:{...nt.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}}};const pe=En();"fonts"in document&&(document.fonts.onloadingdone=()=>pe.emit("fontsLoaded"));var Rr=Object.freeze(Object.defineProperty({__proto__:null,globalBus:pe},Symbol.toStringTag,{value:"Module"}));function Un(e={}){return Object.assign({id:`${J.id}-0`,name:"Default Save",tabs:J.initialTabs.slice(),time:Date.now(),autosave:!0,offlineProd:!0,offlineTime:0,timePlayed:0,keepGoing:!1,modID:J.id,modVersion:J.versionNumber,layers:{}},e)}function ye(e){const t=Ee.compressToUTF16(rn(e!=null?e:D));return localStorage.setItem((e!=null?e:D).id,t),t}async function Br(){jr();try{let e=localStorage.getItem(te.active);if(e==null){await ot(pt());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Ee.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==J.id){await ot(pt());return}t.id=te.active,await ot(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await ot(pt())}}function pt(){const e=qt(),t=Un({id:e});return ye(t),te.saves.push(e),t}function qt(){let e,t=0;do e=`${J.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const zr=A(!1);async function ot(e){console.info("Loading save",e),zr.value=!0;const{layers:t,removeLayer:n,addLayer:i}=await St(()=>Promise.resolve().then(function(){return Rs}),void 0),{fixOldSave:r,getInitialLayers:s}=await St(()=>Promise.resolve().then(function(){return ec}),void 0);for(const a in t){const l=t[a];l&&n(l)}s(e).forEach(a=>i(a,e)),e=Un(e),e.offlineProd&&e.time!=null&&e.time&&e.devSpeed!==0&&(e.offlineTime==null&&(e.offlineTime=0),e.offlineTime+=Math.min(e.offlineTime+(Date.now()-e.time)/1e3,J.offlineLimit*3600)),e.time=Date.now(),e.modVersion!==J.versionNumber&&(r(e.modVersion,e),e.modVersion=J.versionNumber),Object.assign(D,e),te.active=D.id,pe.emit("onLoad")}setInterval(()=>{D.autosave&&ye()},1e3);window.onbeforeunload=()=>{D.autosave&&ye()};window.save=ye;const Ur=window.hardReset=async()=>{await ot(pt())};window.deleteLowerSaves=()=>{const e=Object.values(te.saves).indexOf(D.id)+1;Object.values(te.saves).slice(e).forEach(t=>localStorage.removeItem(t)),te.saves=te.saves.slice(0,e)};const Mt=vt({active:"",saves:[],showTPS:!0,theme:an.Nordic,unthrottled:!1,alignUnits:!1});$e(Mt,e=>{const t=Ee.compressToUTF16(JSON.stringify(e));localStorage.setItem(J.id,t)},{deep:!0});var te=window.settings=Mt;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:an.Nordic,alignUnits:!1};pe.emit("loadSettings",e),Object.assign(Mt,e),Ur()};function jr(){try{let e=localStorage.getItem(J.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Ee.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(Mt,t)}pe.emit("loadSettings",Mt)}catch{}}const Gr=vt([]),Wr=vt([]),Hr=vt([]),Zr={class:"table"},Yr=B({__name:"Row",setup(e){const t=$(()=>Me[te.theme].mergeAdjacent);return(n,i)=>(_(),S("div",Zr,[y("div",{class:ie(["row",{mergeAdjacent:o(t)}])},[Ae(n.$slots,"default")],2)]))}});function Jr(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ai(e)}function ne(e,t="span"){return typeof e=="function"?B({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),B({template:e})):B({render:()=>({})}):e}function He(e){if(bt(e))return typeof e=="function"?e():ne(e);const t=e[Ve];return h(t,e[qe](),null)}function xn(...e){let t;return h(Yr,null,Jr(t=e.map(He))?t:{default:()=>[t]})}function Ze(e){if(bt(e))return typeof e=="function"?e():typeof e=="string"?h(R,null,[e]):h(e,null,null);const t=e[Ve];return h(t,e[qe](),null)}function $n(e,t){return e.reduce((n,i)=>h(R,null,[n,t,i]))}function bt(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[It]===!0}function jn(e,t){const n=A(null),i=A(void 0);function r(l){n.value||(n.value=setInterval(a,250)),i.value=l}function s(){n.value&&(clearInterval(n.value),n.value=null)}function a(){t&&t.value?t.value():e&&e.value&&e.value(i.value)}return Dn(s),{start:r,stop:s,handleHolding:a}}function Kr(e,t="div"){const n=Se();return We(()=>{n.value=ne(Ce(e),t)}),n}function yt(e,t="div"){const n=Se(null);return We(()=>{const i=Ce(e);n.value=i==""||i==null?null:ne(i,t)}),n}function Ce(e){return o(o(e))}function W(...e){return e.includes(Object)||e.push(Object),e}function Gn(e){return Object.keys(e).reduce((t,n)=>(t[Vr(n)]=e[n],t),{})}const Xr=B({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var v;const n=A({}),i=new ResizeObserver(l),r=A(null);Tt(()=>{const g=r.value;g!=null&&i.observe(g)});let s=!0,a=A((v=r.value)==null?void 0:v.getBoundingClientRect());function l(){s&&(s=!1,lt(()=>{var g;a.value=(g=r.value)==null?void 0:g.getBoundingClientRect(),Object.values(n.value).filter(p=>p).forEach(p=>p.rect=p.element.getBoundingClientRect()),t("updateNodes",n.value),s=!0}))}pe.on("fontsLoaded",l);const u={attributes:!1,childList:!0,subtree:!1};Dt(ln,(g,p)=>{const b=new MutationObserver(()=>f(g));b.observe(p,u),n.value[g]={element:p,observer:b,rect:p.getBoundingClientRect()},l()}),Dt(un,g=>{var p;(p=n.value[g])==null||p.observer.disconnect(),n.value[g]=void 0,l()}),Dt(cn,n),Dt(dn,a);function f(g){const p=n.value[g];p!=null&&(p.rect=p.element.getBoundingClientRect(),t("updateNodes",n.value))}return(g,p)=>(_(),S(R,null,[Ae(g.$slots,"default",{},void 0,!0),y("div",{ref_key:"resizeListener",ref:r,class:"resize-listener"},null,512)],64))}});var Wn=Q(Xr,[["__scopeId","data-v-2b1dc1bc"]]);const Qr=["onPointerdown"],eo={class:"modal-wrapper"},to={class:"modal-container"},no={class:"modal-header"},io={class:"modal-body"},ro={class:"modal-footer"},oo=y("div",{class:"modal-default-flex-grow"},null,-1),dt=B({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const r=de(e),s=$(()=>o(r.modelValue)||l.value);function a(){n("update:modelValue",!1)}const l=A(!1),u=A(null),f=$(()=>{var v,g;return(g=(v=u.value)==null?void 0:v.nodes)!=null?g:null});return t({isOpen:s,nodes:f}),(v,g)=>(_(),G(ui,{to:"#modal-root"},[h(kt,{name:"modal",onBeforeEnter:g[0]||(g[0]=p=>l.value=!0),onAfterLeave:g[1]||(g[1]=p=>l.value=!1)},{default:V(()=>[nn(y("div",Le({class:"modal-mask",onPointerdown:ht(a,["self"])},v.$attrs),[y("div",eo,[y("div",to,[y("div",no,[Ae(v.$slots,"header",{shown:o(s)},()=>[O(" default header ")])]),y("div",io,[h(Wn,{ref_key:"contextRef",ref:u},{default:V(()=>[Ae(v.$slots,"body",{shown:o(s)},()=>[O(" default body ")])]),_:3},512)]),y("div",ro,[Ae(v.$slots,"footer",{shown:o(s)},()=>[y("div",{class:"modal-default-footer"},[oo,y("button",{class:"button modal-default-button",onClick:a}," Close ")])])])])])],16,Qr),[[li,e.modelValue]])]),_:3})]))}}),Ge=Symbol("ProxyState");function Te(e,t={}){const n=t;let i=!1,r=!1;function s(){return i||(r&&console.error("Cyclical dependency detected. Cannot evaluate lazy proxy."),r=!0,Object.assign(n,e.call(n,n)),i=!0),n}return new Proxy(n,{get(a,l){if(l===Ge)return s();const u=s()[l];return u!=null&&typeof u=="object"&&xe in u?u[xe]:u},set(a,l,u){return s()[l]=u,!0},has(a,l){return l===Ge?!0:Reflect.has(s(),l)},ownKeys(){return Reflect.ownKeys(s())},getOwnPropertyDescriptor(a,l){return i||(Object.assign(n,e.call(n,n)),i=!0),Object.getOwnPropertyDescriptor(a,l)}})}const Hn=c.ln(10);function Lt(e){return e}function Nt(e,...t){const n=t.find(i=>x(i));return n==null?(console.error("Could not invert due to no input being a variable"),0):n.invert(e)}function so(e,t){return x(t)?t.invert(c.neg(e)):(console.error("Could not invert due to no input being a variable"),0)}function ao(e,t){return x(t)?t.isIntegrable()?d.neg(t.getIntegralFormula(e)):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function lo(e){return d.neg(e)}function uo(e,t,n){return x(t)?t.invert(c.sub(e,se(n))):x(n)?n.invert(c.sub(e,se(t))):(console.error("Could not invert due to no input being a variable"),0)}function co(e,t,n){var i,r;if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const s=t.getIntegralFormula(e);return d.times(n,(i=t.innermostVariable)!=null?i:0).add(s)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const s=n.getIntegralFormula(e);return d.times(t,(r=n.innermostVariable)!=null?r:0).add(s)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function fo(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.add(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.add(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function go(e,t,n){return x(t)?t.invert(c.add(e,se(n))):x(n)?n.invert(c.sub(se(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function mo(e,t,n){var i,r;if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const s=t.getIntegralFormula(e);return d.sub(s,d.times(n,(i=t.innermostVariable)!=null?i:0))}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const s=n.getIntegralFormula(e);return d.times(t,(r=n.innermostVariable)!=null?r:0).sub(s)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function po(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.sub(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.sub(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ho(e,t,n){return x(t)?t.invert(c.div(e,se(n))):x(n)?n.invert(c.div(e,se(t))):(console.error("Could not invert due to no input being a variable"),0)}function vo(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.times(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.times(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function bo(e,t,n){return x(t)?d.div(e,n):x(n)?d.div(e,t):(console.error("Could not apply substitution due to no input being a variable"),d.constant(0))}function yo(e,t,n){return x(t)?t.invert(c.mul(e,se(n))):x(n)?n.invert(c.div(se(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function _o(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.div(i,n)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.div(t,i)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function No(e,t,n){return x(t)?d.mul(e,n):x(n)?d.mul(e,t):(console.error("Could not apply substitution due to no input being a variable"),d.constant(0))}function wo(e,t){return x(t)?t.invert(c.recip(e)):(console.error("Could not invert due to no input being a variable"),0)}function Co(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.ln(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ko(e,t){return x(t)?t.invert(c.pow10(e)):(console.error("Could not invert due to no input being a variable"),0)}function So(e){return c.ln(e).sub(1).times(e).div(Hn)}function Io(e,t){if(x(t)){const n=Hn.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Mo(e,t){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:So,invert:Io}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function xo(e,t,n){return x(t)?t.invert(c.pow(se(n),e)):x(n)?n.invert(c.root(se(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function $o(e,t){return c.ln(e).sub(1).times(e).div(c.ln(t))}function To(e,t,n){if(x(t)){const i=c.ln(se(n)).times(e);return t.invert(i.div(i.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Po(e,t,n){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e),n],evaluate:$o,invert:To}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Fo(e,t){return x(t)?t.invert(c.pow(2,e)):(console.error("Could not invert due to no input being a variable"),0)}function Do(e){return c.ln(e).sub(1).times(e).div(c.ln(2))}function Eo(e,t){if(x(t)){const n=c.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Ao(e,t){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:Do,invert:Eo}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Oo(e,t){return x(t)?t.invert(c.exp(e)):(console.error("Could not invert due to no input being a variable"),0)}function Vo(e){return c.ln(e).sub(1).times(e)}function qo(e,t){return x(t)?t.invert(c.div(e,c.div(e,Math.E).lambertw())):(console.error("Could not invert due to no input being a variable"),0)}function Lo(e,t){return x(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:Vo,invert:qo}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Ro(e,t,n){return x(t)?t.invert(c.root(e,se(n))):x(n)?n.invert(c.ln(e).div(c.ln(se(t)))):(console.error("Could not invert due to no input being a variable"),0)}function Bo(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e),r=d.add(n,1);return d.pow(i,r).div(r)}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.pow(t,i).div(d.ln(t))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function zo(e,t){return x(t)?t.invert(c.root(e,10)):(console.error("Could not invert due to no input being a variable"),0)}function Uo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.pow10(n).div(d.ln(10))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function jo(e,t,n){return x(t)?t.invert(c.ln(e).div(c.ln(se(n)))):x(n)?n.invert(c.root(se(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Go(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.pow(n,i).div(d.ln(n))}else if(x(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e),r=d.add(t,1);return d.pow(i,r).div(r)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Wo(e,t,n){return x(t)?t.invert(c.root(e,c.recip(se(n)))):x(n)?n.invert(c.ln(se(t)).div(c.ln(e))):(console.error("Could not invert due to no input being a variable"),0)}function Ho(e,t,n){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.pow(i,d.recip(n).add(1)).times(n).div(d.add(n,1))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Zo(e,t){return x(t)?t.invert(c.ln(e)):(console.error("Could not invert due to no input being a variable"),0)}function Yo(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.exp(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Jo(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){const i=c.minabs(t,1e308).toNumber();return c.tetrate(e,i,n)}function Ko(e,t,n,i){return x(t)?t.invert(c.ssqrt(e)):(console.error("Could not invert due to no input being a variable"),0)}function Xo(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){const i=c.minabs(t,1e308).toNumber();return c.iteratedexp(e,i,new c(n))}function Qo(e,t,n,i){return x(t)?t.invert(c.iteratedlog(e,Math.E,c.minabs(1e308,se(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function es(e,t=10,n=2){const i=c.minabs(n,1e308).toNumber();return c.iteratedlog(e,t,i)}function ts(e,t=10){const n=c.minabs(t,1e308).toNumber();return c.slog(e,n)}function ns(e,t,n){return x(t)?t.invert(c.tetrate(e,c.minabs(1e308,se(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function is(e,t,n){const i=c.minabs(t,1e308).toNumber();return c.layeradd(e,i,n)}function rs(e,t,n,i){return x(t)?t.invert(c.layeradd(e,c.minabs(1e308,se(n)).negate().toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function os(e,t){return x(t)?t.invert(c.pow(Math.E,e).times(e)):(console.error("Could not invert due to no input being a variable"),0)}function ss(e,t){return x(t)?t.invert(c.tetrate(e,2)):(console.error("Could not invert due to no input being a variable"),0)}function as(e,t,n){const i=c.minabs(t,1e308).toNumber();return c.pentate(e,i,n)}function ls(e,t){return x(t)?t.invert(c.asin(e)):(console.error("Could not invert due to no input being a variable"),0)}function us(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cos(n).neg()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function cs(e,t){return x(t)?t.invert(c.acos(e)):(console.error("Could not invert due to no input being a variable"),0)}function ds(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.sin(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function fs(e,t){return x(t)?t.invert(c.atan(e)):(console.error("Could not invert due to no input being a variable"),0)}function gs(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cos(n).ln().neg()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ms(e,t){return x(t)?t.invert(c.sin(e)):(console.error("Could not invert due to no input being a variable"),0)}function ps(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.asin(n).times(n).add(d.sqrt(d.sub(1,d.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function hs(e,t){return x(t)?t.invert(c.cos(e)):(console.error("Could not invert due to no input being a variable"),0)}function vs(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.acos(n).times(n).sub(d.sqrt(d.sub(1,d.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function bs(e,t){return x(t)?t.invert(c.tan(e)):(console.error("Could not invert due to no input being a variable"),0)}function ys(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.atan(n).times(n).sub(d.ln(d.pow(n,2).add(1)).div(2))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function _s(e,t){return x(t)?t.invert(c.asinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ns(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cosh(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ws(e,t){return x(t)?t.invert(c.acosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Cs(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.sinh(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ks(e,t){return x(t)?t.invert(c.atanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ss(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cosh(n).ln()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Is(e,t){return x(t)?t.invert(c.sinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ms(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.asinh(n).times(n).sub(d.pow(n,2).add(1).sqrt())}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function xs(e,t){return x(t)?t.invert(c.cosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function $s(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.acosh(n).times(n).sub(d.add(n,1).sqrt().times(d.sub(n,1).sqrt()))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ts(e,t){return x(t)?t.invert(c.tanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ps(e,t){if(x(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.atanh(n).times(n).add(d.sub(1,d.pow(n,2)).ln().div(2))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function _t(e){return(t,n)=>new d({inputs:[t,n],evaluate:e,invert:Lt})}function x(e){return e instanceof re&&e.hasVariable()}function se(e,t){return e instanceof re?e.evaluate(t):o(e)}function Fs(){return d.pow(this,2).div(2)}function Ds(){return this}const ue=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"inputs"in e&&(e.inputs=e.inputs.map(n=>typeof n=="object"&&xe in n?n[xe]:n)),"variable"in e?(typeof e.variable=="object"&&xe in e.variable&&(e.variable=e.variable[xe]),t=this.setupVariable(e)):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:Fs,internalIntegrateInner:Ds,applySubstitution:Lt}}setupConstant({inputs:e}){return e.length!==1&&console.error("Evaluate function is required if inputs is not length 1"),{inputs:e,internalVariables:0}}setupFormula(e){var p,b;const{inputs:t,evaluate:n,invert:i,integrate:r,integrateInner:s,applySubstitution:a}=e,l=t.reduce((C,w)=>C+(w instanceof ue?w.internalVariables:0),0),u=t.find(C=>C instanceof ue&&C.hasVariable()),f=l===1?u==null?void 0:u.innermostVariable:void 0,v=(p=u==null?void 0:u.isInvertible())!=null?p:!1,g=(b=u==null?void 0:u.isIntegrable())!=null?b:!1;return{inputs:t,internalEvaluate:n,internalInvert:v?i:void 0,internalIntegrate:g?r:void 0,internalIntegrateInner:s,applySubstitution:a,innermostVariable:f,internalVariables:l}}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,i;return(i=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(r=>se(r,e))))!=null?n:this.hasVariable()?e:null)!=null?i:se(this.inputs[0])}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof ue&&e.inputs[n]instanceof ue?t.equals(e.inputs[n]):!(t instanceof ue)&&!(e.inputs[n]instanceof ue)&&c.eq(o(t),o(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new d({inputs:[e]})}static variable(e){return new d({variable:e})}static step(e,t,n){const i=n(d.variable(0)),r=Oe(t);function s(l){return c.lt(l,o(r))?l:c.add(i.evaluate(c.sub(l,o(r))),o(r))}function a(l,u){return x(u)&&i.isInvertible()?(c.gt(l,o(r))&&(l=c.add(i.invert(c.sub(l,o(r))),o(r))),u.invert(l)):(console.error("Could not invert due to no input being a variable"),0)}return new d({inputs:[e],evaluate:s,invert:i.isInvertible()&&i.hasVariable()?a:void 0})}static if(e,t,n,i){const r=A(0),s=d.variable(r),a=n(s),l=i==null?void 0:i(s),u=Oe(t);function f(g){return o(u)?(r.value=g,a.evaluate()):l?(r.value=g,l.evaluate()):g}function v(g,p){return!x(p)||!a.isInvertible()||l!=null&&!l.isInvertible()?(console.error("Could not invert due to no input being a variable"),0):o(u)?p.invert(a.invert(g)):l?p.invert(l.invert(g)):p.invert(g)}return new d({inputs:[e],evaluate:f,invert:a.isInvertible()&&a.hasVariable()?v:void 0})}static conditional(e,t,n,i){return d.if(e,t,n,i)}static abs(e){return new d({inputs:[e],evaluate:c.abs})}static neg(e){return new d({inputs:[e],evaluate:c.neg,invert:so,applySubstitution:lo,integrate:ao})}static sign(e){return new d({inputs:[e],evaluate:c.sign})}static round(e){return new d({inputs:[e],evaluate:c.round,invert:Nt})}static floor(e){return new d({inputs:[e],evaluate:c.floor,invert:Nt})}static ceil(e){return new d({inputs:[e],evaluate:c.ceil,invert:Nt})}static trunc(e){return new d({inputs:[e],evaluate:c.trunc,invert:Nt})}static add(e,t){return new d({inputs:[e,t],evaluate:c.add,invert:uo,integrate:co,integrateInner:fo,applySubstitution:Lt})}static sub(e,t){return new d({inputs:[e,t],evaluate:c.sub,invert:go,integrate:mo,integrateInner:po,applySubstitution:Lt})}static mul(e,t){return new d({inputs:[e,t],evaluate:c.mul,invert:ho,integrate:vo,applySubstitution:bo})}static div(e,t){return new d({inputs:[e,t],evaluate:c.div,invert:yo,integrate:_o,applySubstitution:No})}static recip(e){return new d({inputs:[e],evaluate:c.recip,invert:wo,integrate:Co})}static clamp(e,t,n){return new d({inputs:[e,t,n],evaluate:c.clamp,invert:Nt})}static pLog10(e){return new d({inputs:[e],evaluate:c.pLog10})}static absLog10(e){return new d({inputs:[e],evaluate:c.absLog10})}static log10(e){return new d({inputs:[e],evaluate:c.log10,invert:ko,integrate:Mo})}static log(e,t){return new d({inputs:[e,t],evaluate:c.log,invert:xo,integrate:Po})}static log2(e){return new d({inputs:[e],evaluate:c.log2,invert:Fo,integrate:Ao})}static ln(e){return new d({inputs:[e],evaluate:c.ln,invert:Oo,integrate:Lo})}static pow(e,t){return new d({inputs:[e,t],evaluate:c.pow,invert:Ro,integrate:Bo})}static pow10(e){return new d({inputs:[e],evaluate:c.pow10,invert:zo,integrate:Uo})}static pow_base(e,t){return new d({inputs:[e,t],evaluate:c.pow_base,invert:jo,integrate:Go})}static root(e,t){return new d({inputs:[e,t],evaluate:c.root,invert:Wo,integrate:Ho})}static factorial(e){return new d({inputs:[e],evaluate:c.factorial})}static gamma(e){return new d({inputs:[e],evaluate:c.gamma})}static lngamma(e){return new d({inputs:[e],evaluate:c.lngamma})}static exp(e){return new d({inputs:[e],evaluate:c.exp,invert:Zo,integrate:Yo})}static sqr(e){return d.pow(e,2)}static sqrt(e){return d.root(e,2)}static cube(e){return d.pow(e,3)}static cbrt(e){return d.root(e,3)}static tetrate(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:Jo,invert:Ko})}static iteratedexp(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:Xo,invert:Qo})}static iteratedlog(e,t=10,n=1){return new d({inputs:[e,t,n],evaluate:es})}static slog(e,t=10){return new d({inputs:[e,t],evaluate:ts,invert:ns})}static layeradd10(e,t){return new d({inputs:[e,t],evaluate:c.layeradd10})}static layeradd(e,t,n=10){return new d({inputs:[e,t,n],evaluate:is,invert:rs})}static lambertw(e){return new d({inputs:[e],evaluate:c.lambertw,invert:os})}static ssqrt(e){return new d({inputs:[e],evaluate:c.ssqrt,invert:ss})}static pentate(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:as})}static sin(e){return new d({inputs:[e],evaluate:c.sin,invert:ms,integrate:us})}static cos(e){return new d({inputs:[e],evaluate:c.cos,invert:hs,integrate:ds})}static tan(e){return new d({inputs:[e],evaluate:c.tan,invert:bs,integrate:gs})}static asin(e){return new d({inputs:[e],evaluate:c.asin,invert:ls,integrate:ps})}static acos(e){return new d({inputs:[e],evaluate:c.acos,invert:cs,integrate:vs})}static atan(e){return new d({inputs:[e],evaluate:c.atan,invert:fs,integrate:ys})}static sinh(e){return new d({inputs:[e],evaluate:c.sinh,invert:Is,integrate:Ns})}static cosh(e){return new d({inputs:[e],evaluate:c.cosh,invert:xs,integrate:Cs})}static tanh(e){return new d({inputs:[e],evaluate:c.tanh,invert:Ts,integrate:Ss})}static asinh(e){return new d({inputs:[e],evaluate:c.asinh,invert:_s,integrate:Ms})}static acosh(e){return new d({inputs:[e],evaluate:c.acosh,invert:ws,integrate:$s})}static atanh(e){return new d({inputs:[e],evaluate:c.atanh,invert:ks,integrate:Ps})}step(e,t){return d.step(this,e,t)}if(e,t){return d.if(this,e,t)}conditional(e,t){return d.if(this,e,t)}abs(){return d.abs(this)}neg(){return d.neg(this)}sign(){return d.sign(this)}round(){return d.round(this)}floor(){return d.floor(this)}ceil(){return d.ceil(this)}trunc(){return d.trunc(this)}add(e){return d.add(this,e)}sub(e){return d.sub(this,e)}mul(e){return d.mul(this,e)}div(e){return d.div(this,e)}recip(){return d.recip(this)}max(e){return d.max(this,e)}min(e){return d.min(this,e)}maxabs(e){return d.maxabs(this,e)}minabs(e){return d.minabs(this,e)}clamp(e,t){return d.clamp(this,e,t)}clampMin(e){return d.clampMin(this,e)}clampMax(e){return d.clampMax(this,e)}pLog10(){return d.pLog10(this)}absLog10(){return d.absLog10(this)}log10(){return d.log10(this)}log(e){return d.log(this,e)}log2(){return d.log2(this)}ln(){return d.ln(this)}pow(e){return d.pow(this,e)}pow10(){return d.pow10(this)}pow_base(e){return d.pow_base(this,e)}root(e){return d.root(this,e)}factorial(){return d.factorial(this)}gamma(){return d.gamma(this)}lngamma(){return d.lngamma(this)}exp(){return d.exp(this)}sqr(){return d.pow(this,2)}sqrt(){return d.root(this,2)}cube(){return d.pow(this,3)}cbrt(){return d.root(this,3)}tetrate(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.tetrate(this,e,t)}iteratedexp(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return d.iteratedlog(this,e,t)}slog(e=10){return d.slog(this,e)}layeradd10(e){return d.layeradd10(this,e)}layeradd(e,t){return d.layeradd(this,e,t)}lambertw(){return d.lambertw(this)}ssqrt(){return d.ssqrt(this)}pentate(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.pentate(this,e,t)}sin(){return d.sin(this)}cos(){return d.cos(this)}tan(){return d.tan(this)}asin(){return d.asin(this)}acos(){return d.acos(this)}atan(){return d.atan(this)}sinh(){return d.sinh(this)}cosh(){return d.cosh(this)}tanh(){return d.tanh(this)}asinh(){return d.asinh(this)}acosh(){return d.acosh(this)}atanh(){return d.atanh(this)}};let re=ue;re.negate=ue.neg;re.negated=ue.neg;re.sgn=ue.sign;re.plus=ue.add;re.subtract=ue.sub;re.minus=ue.sub;re.multiply=ue.mul;re.times=ue.mul;re.divide=ue.div;re.divideBy=ue.div;re.dividedBy=ue.div;re.reciprocal=ue.recip;re.reciprocate=ue.recip;re.max=_t(c.max);re.min=_t(c.min);re.minabs=_t(c.minabs);re.maxabs=_t(c.maxabs);re.clampMin=_t(c.clampMin);re.clampMax=_t(c.clampMax);re.logarithm=ue.log;class d extends re{invert(t){return this.internalInvert&&this.hasVariable()?this.internalInvert.call(this,t,...this.inputs):this.inputs.length===1&&this.hasVariable()?t:(console.error("Cannot invert non-invertible formula"),0)}evaluateIntegral(t){return this.isIntegrable()?this.getIntegralFormula().evaluate(t):(console.error("Cannot evaluate integral of formula without integral"),0)}invertIntegral(t){return!this.isIntegrable()||!this.getIntegralFormula().isInvertible()?(console.error("Cannot invert integral of formula without invertible integral"),0):this.getIntegralFormula().invert(t)}calculateConstantOfIntegration(){const t=this.getIntegralFormula().evaluate(1),n=c.add(this.evaluate(0),this.evaluate(1)).div(2);return c.sub(n,t)}getIntegralFormula(t){if(this.integralFormula!=null&&t==null)return this.integralFormula;if(t==null){if(this.applySubstitution==null){if(t=[],this.internalIntegrate==null)return console.error("Cannot integrate formula with non-integrable operation"),d.constant(0);let n=this.internalIntegrate.call(this,t,...this.inputs);t.forEach(i=>n=i(n)),this.integralFormula=n}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else return console.error("Cannot integrate formula without variable"),d.constant(0);return this.integralFormula}else return this.applySubstitution==null?(console.error("Cannot have two complex operations in an integrable formula"),d.constant(0)):(t.push(n=>this.applySubstitution.call(this,n,...this.inputs)),this.internalIntegrateInner?this.internalIntegrateInner.call(this,t,...this.inputs):this.internalIntegrate?this.internalIntegrate.call(this,t,...this.inputs):this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable()?this:(console.error("Cannot integrate formula without variable"),d.constant(0)))}}function Es(e,t,n=!0,i,r=c.dInf){const s=Oe(n),a=Oe(i),l=Oe(r);return $(()=>{var p,b,C,w;const u=o(l);if(c.eq(u,1))return c.gte(t.value,e.evaluate())?c.dOne:c.dZero;const f=o(s),v=(p=o(a))!=null?p:f?10:0;let g=0;if(c.gt(u,v)){if(!e.isInvertible())return console.error("Cannot calculate max affordable of non-invertible formula with more maxBulkAmount than directSum"),0;if(f){if(!e.isIntegralInvertible())return console.error("Cannot calculate max affordable of formula with non-invertible integral"),0;g=c.floor(e.invertIntegral(c.add(t.value,e.evaluateIntegral()))).sub((b=o(e.innermostVariable))!=null?b:0)}else g=c.floor(e.invert(t.value))}if(g=c.clampMax(g,u),v>0){const M=g;g=c.sub(g,v).clampMin(0);let P;for(f?P=Rt(e,g,!0,0):P=e.evaluate(c.add((C=o(e.innermostVariable))!=null?C:0,g));c.lt(g,u)&&c.lt(g,Number.MAX_SAFE_INTEGER)&&c.add(M,1).gte(g);){const k=e.evaluate(g.add((w=o(e.innermostVariable))!=null?w:0));if(c.add(P,k).lte(t.value))g=g.add(1),P=c.add(P,k);else break}}return g})}function Rt(e,t,n=!0,i){var u;if(c.eq(t,1))return e.evaluate();const r=(u=o(e.innermostVariable))!=null?u:0;let s=c.add(t,r);const a=s;i!=null||(i=n?10:0),s=s.sub(i).clampMin(r);let l=0;if(c.gt(t,i)){if(!e.isInvertible())return console.error("Cannot calculate cost with indirect sum of non-invertible formula"),0;if(n){if(!e.isIntegrable())return console.error("Cannot calculate cost with cumulative cost of non-integrable formula"),0;if(l=c.sub(e.evaluateIntegral(s),e.evaluateIntegral()),a.gt(1e308))return c.add(l,c.sub(a,s).times(e.evaluate(s)))}else if(l=e.evaluate(s),s=s.add(1),a.gt(1e308))return c.sub(a,s).add(1).times(l)}for(let f=s.toNumber();f<a.toNumber();f++)l=c.add(l,e.evaluate(f));return l}const Ye=Symbol("PersistentState"),Je=Symbol("DefaultValue"),Gt=Symbol("StackTrace"),Wt=Symbol("Deleted"),xe=Symbol("NonPersistent"),st=Symbol("SaveDataPath"),xt=Symbol("SkipPersistence");function As(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function Tn(e,t){var n;c.isNaN(t)&&(oe.hasNaN||(D.autosave=!1,oe.hasNaN=!0,oe.NaNPath=e[st],oe.NaNPersistent=e),console.error(`Attempted to save NaN value to ${(n=e[st])==null?void 0:n.join(".")}`)),e[Ye].value=t}function ft(e,t=!0){const n=le(e)?e:A(e);le(e)&&(e=e.value);const i=$({get(){return n.value},set(s){t?Tn(r,s):r[Ye].value=s}});i[Je]=e;const r={get value(){return n.value},set value(s){t?Tn(r,s):r[Ye].value=s},__v_isRef:!0,[Ye]:n,[Je]:e,[Gt]:As(),[Wt]:!1,[xe]:i,[st]:void 0};return be.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",r,`
Created at:
`+r[Gt]):at[be[be.length-1]].add(r),r}function Os(e){return e!=null&&typeof e=="object"&&Ye in e}function it(e){return!(Ge in e)&&xe in e?e[xe]:new Proxy(e,{get(t,n){if(n!==Ye)return n===xt?!0:t[n]},set(t,n,i){return t[n]=i,!0},has(t,n){return n===Ye?!1:n==xt?!0:Reflect.has(t,n)}})}function Vs(e){be.length===0?console.warn("Deleting a persistent ref outside of a layer. Ignoring...",e):at[be[be.length-1]].delete(e),e[Wt]=!0}pe.on("addLayer",(e,t)=>{const n=[],i=(r,s=[])=>{let a=!1;return Object.keys(r).forEach(l=>{let u=r[l];if(u!=null&&typeof u=="object"){if(u[xt]===!0)return;if(Ge in u&&(u=u[Ge]),Os(u)){if(a=!0,u[Wt]){console.warn("Deleted persistent ref present in returned object. Ignoring...",u,`
Created at:
`+u[Gt]);return}at[e.id].delete(u);const f=[e.id,...s,l];u[st]!=null&&JSON.stringify(f)!==JSON.stringify(u[st])&&console.error(`Persistent ref is being saved to \`${f.join(".")}\` when it's already present at \`${u[st].join(".")}\`.`,"This can cause unexpected behavior when loading saves between updates."),u[st]=f;const v=s.reduce((p,b)=>(b in p||(p[b]={}),p[b]),t),g=v[l];v[l]=u[Ye],ci(v)?g!=null?v[l]=g:v[l]=u[Je]:g!=null?v[l].value=g:v[l].value=u[Je]}else!(u instanceof c)&&!(u instanceof d)&&!le(u)&&!n.includes(u)&&(typeof u.type=="symbol"&&n.push(u),i(u,[...s,l])&&(Re(u)&&!Re(r)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",Ge in r?r[Ge]:r,l):a=!0))}}),a};i(e[Ge]),at[e.id].forEach(r=>{r[Wt]||console.error(`Created persistent ref in ${e.id} without registering it to the layer!`,`Make sure to include everything persistent in the returned object.

Created at:
`+r[Gt])}),at[e.id].clear()});const ln=Symbol("RegisterNode"),un=Symbol("UnregisterNode"),cn=Symbol("Nodes"),dn=Symbol("Bounds"),he=tn({});window.layers=he;const at={},be=[];function fn(e,t){return Te(()=>{const n={},i=n.emitter=En();if(n.on=i.on.bind(i),n.emit=i.emit.bind(i),n.nodes=A({}),n.id=e,be.push(e),at[e]=new Set,n.minimized=ft(!1,!1),Object.assign(n,t.call(n,n)),be[be.length-1]==null||be[be.length-1]!==e)throw new Error(`Adding layers stack in invalid state. This should not happen
Stack: ${be}
Trying to pop ${n.id}`);be.pop(),F(n,"color"),F(n,"display"),F(n,"classes"),F(n,"style"),F(n,"name"),K(n,"name",n.id),F(n,"minWidth"),K(n,"minWidth",600),F(n,"minimizable"),K(n,"minimizable",!0),F(n,"minimizedDisplay");const r=n.style;return n.style=$(()=>{var a,l;let s=o(n.minWidth);return(typeof s=="number"||!Number.isNaN(parseInt(s)))&&(s=s+"px"),[(a=o(r))!=null?a:"",(l=n.minimized)!=null&&l.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:s,flexBasis:s,margin:""}]}),n})}function gn(e,t){if(console.info("Adding layer",e.id),he[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,he[e.id]);return}K(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),he[e.id]=e,pe.emit("addLayer",e,t.layers[e.id])}function Zn(e){return he[e]}function mn(e){console.info("Removing layer",e.id),pe.emit("removeLayer",e),he[e.id]=void 0}function qs(e){mn(e),gn(e,D)}function Ls(e){const t=A(!1);return{openModal:()=>t.value=!0,modal:Y(()=>h(dt,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>h("h2",null,[o(e.name)]),body:o(e.display)}))}}pe.on("update",function(t){Object.values(he).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(he).forEach(n=>{n==null||n.emit("update",t)}),Object.values(he).forEach(n=>{n==null||n.emit("postUpdate",t)})});var Rs=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:ln,UnregisterNodeInjectionKey:un,NodesInjectionKey:cn,BoundsInjectionKey:dn,layers:he,persistentRefs:at,addingLayers:be,createLayer:fn,addLayer:gn,getLayer:Zn,removeLayer:mn,reloadLayer:qs,setupLayerModal:Ls},Symbol.toStringTag,{value:"Module"}));const Bs=B({components:{Context:Wn,ErrorVue:An},props:{index:{type:Number,required:!0},display:{type:W(Object,String,Function),required:!0},minimizedDisplay:W(Object,String,Function),minimized:{type:Object,required:!0},name:{type:W(String),required:!0},color:W(String),minimizable:W(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:i,minimizedDisplay:r}=de(e),s=Kr(t),a=yt(r),l=$(()=>J.allowGoBack&&n.value>0&&!Ce(i));function u(){D.tabs.splice(o(e.index),1/0)}function f(g){e.nodes.value=g}const v=A([]);return di((g,p,b)=>(console.warn(`Error caught in "${e.name}" layer`,g,p,b),v.value.push(g instanceof Error?g:new Error(JSON.stringify(g))),!1)),{component:s,minimizedComponent:a,showGoBack:l,updateNodes:f,unref:o,goBack:u,errors:v}}}),zs={key:1};function Us(e,t,n,i,r,s){const a=Be("ErrorVue"),l=Be("Context");return e.errors.length>0?(_(),G(a,{key:0,errors:e.errors},null,8,["errors"])):(_(),S("div",Le({key:1,class:"layer-container",style:{"--layer-color":e.unref(e.color)}},e.$attrs),[e.showGoBack?(_(),S("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...u)=>e.goBack&&e.goBack(...u))},"\u274C")):E("",!0),e.unref(e.minimized)?(_(),S("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=u=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(_(),G(ve(e.minimizedComponent),{key:0})):(_(),S("div",zs,L(e.unref(e.name)),1))])):(_(),S("div",{key:2,class:ie(["layer-tab",{showGoBack:e.showGoBack}])},[h(l,{onUpdateNodes:e.updateNodes},{default:V(()=>[(_(),G(ve(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(_(),S("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=u=>e.$emit("setMinimized",!0))}," \u25BC ")):E("",!0)],16))}var js=Q(Bs,[["render",Us],["__scopeId","data-v-a9f5b1da"]]);const Yn=e=>(Ke("data-v-5adb7020"),e=e(),Xe(),e),Gs=Yn(()=>y("h2",null,"Changelog",-1)),Ws=Yn(()=>y("details",{open:""},[y("summary",null,[O("v0.0 Initial Commit - "),y("time",null,"2024-15-02")]),O(" This is the first release :D "),y("ul",null,[y("li",{class:"feature"},"Add Board"),y("li",{class:"feature"},"Add Base Cascade")])],-1)),Hs=B({__name:"Changelog",setup(e,{expose:t}){const n=A(!1);return t({open(){n.value=!0}}),(i,r)=>(_(),G(dt,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=s=>n.value=s)},{header:V(()=>[Gs]),body:V(()=>[Ws]),_:1},8,["modelValue"]))}});var Zs=Q(Hs,[["__scopeId","data-v-5adb7020"]]),Ys=B({props:{element:Object,display:{type:W(Object,String,Function),required:!0},style:W(Object,String,Array),classes:W(Object),direction:W(String),xoffset:W(String),yoffset:W(String),pinned:Object},setup(e){const{element:t,display:n,pinned:i}=de(e),r=A(!1),s=$(()=>(Ce(i)||r.value)&&a.value),a=yt(n),l=Se(ne(Y(()=>{const v=Ce(t);return v==null?"":Ze(v)})));function u(v){const g=i;v.shiftKey&&g&&(g.value=!g.value,v.stopPropagation(),v.preventDefault())}const f=$(()=>Ce(i)&&Me[te.theme].showPin);return{Direction:z,isHovered:r,isShown:s,comp:a,elementComp:l,unref:o,togglePinned:u,showPin:f}}});const Js={key:0,class:"material-icons pinned"};function Ks(e,t,n,i,r,s){return _(),S("div",{class:ie(["tooltip-container",{shown:e.isShown}]),onMouseenter:t[0]||(t[0]=a=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=a=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...a)=>e.togglePinned&&e.togglePinned(...a))},[Ae(e.$slots,"default",{},void 0,!0),e.elementComp?(_(),G(ve(e.elementComp),{key:0})):E("",!0),h(kt,{name:"fade"},{default:V(()=>{var a;return[e.isShown?(_(),S("div",{key:0,class:ie(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:me([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(a=e.unref(e.style))!=null?a:{}])},[e.showPin?(_(),S("span",Js,"push_pin")):E("",!0),e.comp?(_(),G(ve(e.comp),{key:1})):E("",!0)],6)):E("",!0)]}),_:1})],34)}var ce=Q(Ys,[["render",Ks],["__scopeId","data-v-6102fa3a"]]);const gt=e=>(Ke("data-v-10effbe8"),e=e(),Xe(),e),Xs={class:"info-modal-header"},Qs=["src","alt"],ea={class:"info-modal-title"},ta={key:0},na={key:0},ia={key:0},ra=gt(()=>y("div",null," Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb ",-1)),oa=gt(()=>y("br",null,null,-1)),sa=gt(()=>y("br",null,null,-1)),aa=["href"],la=gt(()=>y("span",{class:"material-icons info-modal-discord"},"discord",-1)),ua=gt(()=>y("div",null,[y("a",{href:"https://discord.gg/yJ4fjnjU54",class:"info-modal-discord-link",target:"_blank"},[y("span",{class:"material-icons info-modal-discord"},"discord"),O(" Profectus & Friends ")])],-1)),ca=gt(()=>y("div",null,[y("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[y("span",{class:"material-icons info-modal-discord"},"discord"),O(" The Modding Tree ")])],-1)),da=gt(()=>y("br",null,null,-1));var fa=B({__name:"Info",props:{changelog:null},setup(e,{expose:t}){const n=e,{title:i,logo:r,author:s,discordName:a,discordLink:l,versionNumber:u,versionTitle:f}=J,v=de(n),g=A(!1),p=$(()=>Yt(D.timePlayed)),b=$(()=>ne(Y(()=>h(R,null,[Wr.map(He)]))));t({open(){g.value=!0}});function C(){var w;(w=o(v.changelog))==null||w.open()}return(w,M)=>(_(),G(dt,{modelValue:g.value,"onUpdate:modelValue":M[0]||(M[0]=P=>g.value=P)},{header:V(()=>[y("div",Xs,[o(r)?(_(),S("img",{key:0,class:"info-modal-logo",src:o(r),alt:o(i)},null,8,Qs)):E("",!0),y("div",ea,[y("h2",null,L(o(i)),1),y("h4",null,[O(" v"+L(o(u)),1),o(f)?(_(),S("span",ta,": "+L(o(f)),1)):E("",!0)])])])]),body:V(({shown:P})=>[P?(_(),S("div",na,[o(s)?(_(),S("div",ia,"By "+L(o(s)),1)):E("",!0),ra,oa,y("div",{class:"link",onClick:C},"Changelog"),sa,y("div",null,[o(l)?(_(),S("a",{key:0,href:o(l),class:"info-modal-discord-link",target:"_blank"},[la,O(" "+L(o(a)),1)],8,aa)):E("",!0)]),ua,ca,da,y("div",null,"Time Played: "+L(o(p)),1),(_(),G(ve(o(b))))])):E("",!0)]),_:1},8,["modelValue"]))}});var ga=Q(fa,[["__scopeId","data-v-10effbe8"]]);const ma={class:"field"},pa={key:0,class:"field-title"},Jn=B({__name:"Select",props:{title:null,modelValue:null,options:null,placeholder:null,closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var a;const n=e,i=yt(ze(n,"title"),"span"),r=A((a=n.options.find(l=>l.value===n.modelValue))!=null?a:null);$e(ze(n,"modelValue"),l=>{var u;Ce(r)!==l&&(r.value=(u=n.options.find(f=>f.value===l))!=null?u:null)});function s(l){t("update:modelValue",l.value)}return(l,u)=>(_(),S("div",ma,[o(i)?(_(),S("span",pa,[(_(),G(ve(o(i))))])):E("",!0),h(o(hi),{options:e.options,modelValue:r.value,"onUpdate:modelValue":[u[0]||(u[0]=f=>r.value=f),s],min:1,"label-by":"label",placeholder:e.placeholder,"close-on-select":e.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const ha={class:"field"},va=B({__name:"Toggle",props:{title:null,modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=$(()=>{var s;return ne((s=o(n.title))!=null?s:"<span></span>","span")}),r=$({get(){return!!n.modelValue},set(s){t("update:modelValue",s)}});return(s,a)=>(_(),S("label",ha,[nn(y("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":a[0]||(a[0]=l=>le(r)?r.value=l:null)},null,512),[[fi,o(r)]]),(_(),G(ve(o(i))))]))}});var De=Q(va,[["__scopeId","data-v-11046116"]]);const ba={class:"header"},ya=y("h2",null,"Settings",-1),_a={class:"option-tabs"},Na={key:0},wa={key:1};var Ca=B({__name:"Options",setup(e,{expose:t}){const n=A(!1),i=A("behaviour");function r(H){return H==i.value}function s(H){i.value=H}t({isTab:r,setTab:s,save:ye,open(){n.value=!0}});const a=Object.keys(Me).map(H=>({label:zn(H),value:H})),l=$(()=>ne(Y(()=>h(R,null,[Gr.map(He)])))),{showTPS:u,theme:f,unthrottled:v,alignUnits:g}=de(te),{autosave:p,offlineProd:b}=de(D),C=$({get(){return D.devSpeed===0},set(H){D.devSpeed=H?0:null}}),w=Y(()=>h("span",{class:"option-title"},[O("Unthrottled"),h("desc",null,[O("Allow the game to run as fast as possible. Not battery friendly.")])])),M=Y(()=>h("span",{class:"option-title"},[O("Offline Production"),h(ce,{display:"Save-specific",direction:z.Right},{default:()=>[O("*")]}),h("desc",null,[O("Simulate production that occurs while the game is closed.")])])),P=Y(()=>h("span",{class:"option-title"},[O("Autosave"),h(ce,{display:"Save-specific",direction:z.Right},{default:()=>[O("*")]}),h("desc",null,[O("Automatically save the game every second or when the game is closed.")])])),k=Y(()=>h("span",{class:"option-title"},[O("Pause game"),h(ce,{display:"Save-specific",direction:z.Right},{default:()=>[O("*")]}),h("desc",null,[O("Stop everything from moving.")])])),T=Y(()=>h("span",{class:"option-title"},[O("Theme"),h("desc",null,[O("How the game looks.")])])),I=Y(()=>h("span",{class:"option-title"},[O("Show TPS"),h("desc",null,[O("Show TPS meter at the bottom-left corner of the page.")])])),U=Y(()=>h("span",{class:"option-title"},[O("Align modifier units"),h("desc",null,[O("Align numbers to the beginning of the unit in modifier view.")])]));return(H,ee)=>(_(),G(dt,{modelValue:n.value,"onUpdate:modelValue":ee[10]||(ee[10]=ae=>n.value=ae)},{header:V(()=>[y("div",ba,[ya,y("div",_a,[y("button",{class:ie({selected:r("behaviour")}),onClick:ee[0]||(ee[0]=ae=>s("behaviour"))},"Behaviour",2),y("button",{class:ie({selected:r("appearance")}),onClick:ee[1]||(ee[1]=ae=>s("appearance"))},"Appearance",2)])])]),body:V(()=>[r("behaviour")?(_(),S("div",Na,[h(De,{title:o(w),modelValue:o(v),"onUpdate:modelValue":ee[2]||(ee[2]=ae=>le(v)?v.value=ae:null)},null,8,["title","modelValue"]),o(J).enablePausing?(_(),G(De,{key:0,title:o(k),modelValue:o(C),"onUpdate:modelValue":ee[3]||(ee[3]=ae=>le(C)?C.value=ae:null)},null,8,["title","modelValue"])):E("",!0),h(De,{title:o(M),modelValue:o(b),"onUpdate:modelValue":ee[4]||(ee[4]=ae=>le(b)?b.value=ae:null)},null,8,["title","modelValue"]),h(De,{title:o(P),modelValue:o(p),"onUpdate:modelValue":ee[5]||(ee[5]=ae=>le(p)?p.value=ae:null)},null,8,["title","modelValue"]),o(p)?E("",!0):(_(),G(on,{key:1,class:"button save-button",onClick:ee[6]||(ee[6]=ae=>o(ye)())},{default:V(()=>[O("Manually save")]),_:1}))])):E("",!0),r("appearance")?(_(),S("div",wa,[h(Jn,{title:o(T),options:o(a),modelValue:o(f),"onUpdate:modelValue":ee[7]||(ee[7]=ae=>le(f)?f.value=ae:null)},null,8,["title","options","modelValue"]),(_(),G(ve(o(l)))),h(De,{title:o(I),modelValue:o(u),"onUpdate:modelValue":ee[8]||(ee[8]=ae=>le(u)?u.value=ae:null)},null,8,["title","modelValue"]),h(De,{title:o(U),modelValue:o(g),"onUpdate:modelValue":ee[9]||(ee[9]=ae=>le(g)?g.value=ae:null)},null,8,["title","modelValue"])])):E("",!0)]),_:1},8,["modelValue"]))}});const ka=["onSubmit"],Sa={class:"field"},Ia={key:0,class:"field-title"},Ma=["placeholder"],xa=B({__name:"Text",props:{title:null,modelValue:null,textArea:{type:Boolean},placeholder:null,maxHeight:null,submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,i=yt(ze(n,"title"),"span"),r=Se(null);Tt(()=>{var u;(u=r.value)==null||u.focus()});const s=$({get(){var u;return(u=o(n.modelValue))!=null?u:""},set(u){t("update:modelValue",u)}});function a(){t("submit")}function l(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(u,f)=>(_(),S("form",{onSubmit:ht(a,["prevent"])},[y("div",Sa,[o(i)?(_(),S("span",Ia,[(_(),G(ve(o(i))))])):E("",!0),e.textArea?(_(),G(o(bi),{key:1,modelValue:o(s),"onUpdate:modelValue":f[0]||(f[0]=v=>le(s)?s.value=v:null),placeholder:e.placeholder,maxHeight:e.maxHeight,onBlur:l,ref_key:"field",ref:r},null,8,["modelValue","placeholder","maxHeight"])):nn((_(),S("input",{key:2,type:"text","onUpdate:modelValue":f[1]||(f[1]=v=>le(s)?s.value=v:null),placeholder:e.placeholder,class:ie({fullWidth:!e.title}),onBlur:l,ref_key:"field",ref:r},null,42,Ma)),[[gi,o(s)]])])],40,ka))}});var Kn=Q(xa,[["__scopeId","data-v-90bd4994"]]);const $a={key:0},Ta=["onClick","disabled"],Pa={key:0},Fa=["onClick"],Da=B({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const i=de(e),r=A(!1);$e(r,l=>{t("confirmingChanged",l)});function s(){if(o(i.skipConfirm)){t("click");return}r.value&&t("click"),r.value=!r.value}function a(){r.value=!1}return(l,u)=>(_(),S("span",{class:ie(["container",{confirming:r.value}])},[r.value?(_(),S("span",$a,"Are you sure?")):E("",!0),y("button",{onClick:ht(s,["stop"]),class:"button danger",disabled:e.disabled},[r.value?(_(),S("span",Pa,"Yes")):Ae(l.$slots,"default",{key:1},void 0,!0)],8,Ta),r.value?(_(),S("button",{key:1,class:"button",onClick:ht(a,["stop"])},"No",8,Fa)):E("",!0)],2))}});var Ea=Q(Da,[["__scopeId","data-v-2f8ef34c"]]);const Ue=e=>(Ke("data-v-32313015"),e=e(),Xe(),e),Aa=Ue(()=>y("div",{class:"handle material-icons"},"drag_handle",-1)),Oa={key:0,class:"actions"},Va=Ue(()=>y("span",{class:"material-icons"},"content_paste",-1)),qa=Ue(()=>y("span",{class:"material-icons"},"content_copy",-1)),La=Ue(()=>y("span",{class:"material-icons"},"edit",-1)),Ra=Ue(()=>y("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),Ba={key:1,class:"actions"},za=Ue(()=>y("span",{class:"material-icons"},"check",-1)),Ua=Ue(()=>y("span",{class:"material-icons"},"close",-1)),ja={key:2,class:"details"},Ga={class:"save-version"},Wa=Ue(()=>y("br",null,null,-1)),Ha={key:0},Za={key:3,class:"details"},Ya={key:4,class:"details error"},Ja=Ue(()=>y("br",null,null,-1)),Ka=B({__name:"Save",props:{save:null},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:i}=de(n),r=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),s=A(!1),a=A(!1),l=A("");$e(s,()=>{var g;return l.value=(g=i.value.name)!=null?g:""});const u=$(()=>i.value!=null&&i.value.id===D.id),f=$(()=>{var g;return u.value?D.time:(g=i.value!=null&&i.value.time)!=null?g:0});function v(){t("editName",l.value),s.value=!1}return(g,p)=>(_(),S("div",{class:ie(["save",{active:o(u)}])},[Aa,s.value?(_(),S("div",Ba,[y("button",{onClick:v,class:"button"},[h(ce,{display:"Save",direction:o(z).Left,class:"info"},{default:V(()=>[za]),_:1},8,["direction"])]),y("button",{onClick:p[5]||(p[5]=b=>s.value=!s.value),class:"button"},[h(ce,{display:"Cancel",direction:o(z).Left,class:"info"},{default:V(()=>[Ua]),_:1},8,["direction"])])])):(_(),S("div",Oa,[o(i).error==null&&!a.value?(_(),G(on,{key:0,onClick:p[0]||(p[0]=b=>t("export")),class:"button",left:""},{default:V(()=>[h(ce,{display:"Export",direction:o(z).Left,class:"info"},{default:V(()=>[Va]),_:1},8,["direction"])]),_:1})):E("",!0),o(i).error==null&&!a.value?(_(),S("button",{key:1,onClick:p[1]||(p[1]=b=>t("duplicate")),class:"button"},[h(ce,{display:"Duplicate",direction:o(z).Left,class:"info"},{default:V(()=>[qa]),_:1},8,["direction"])])):E("",!0),o(i).error==null&&!a.value?(_(),S("button",{key:2,onClick:p[2]||(p[2]=b=>s.value=!s.value),class:"button"},[h(ce,{display:"Edit Name",direction:o(z).Left,class:"info"},{default:V(()=>[La]),_:1},8,["direction"])])):E("",!0),h(Ea,{disabled:o(u),onClick:p[3]||(p[3]=b=>t("delete")),onConfirmingChanged:p[4]||(p[4]=b=>a.value=b)},{default:V(()=>[h(ce,{display:"Delete",direction:o(z).Left,class:"info"},{default:V(()=>[Ra]),_:1},8,["direction"])]),_:1},8,["disabled"])])),o(i).error==null&&!s.value?(_(),S("div",ja,[y("button",{class:"button open",onClick:p[6]||(p[6]=b=>t("open"))},[y("h3",null,L(o(i).name),1)]),y("span",Ga,"v"+L(o(i).modVersion),1),Wa,o(f)?(_(),S("div",Ha,"Last played "+L(o(r).format(o(f))),1)):E("",!0)])):o(i).error==null&&s.value?(_(),S("div",Za,[h(Kn,{modelValue:l.value,"onUpdate:modelValue":p[7]||(p[7]=b=>l.value=b),class:"editname",onSubmit:v},null,8,["modelValue"])])):(_(),S("div",Ya,[O(" Error: Failed to load save with id "+L(o(i).id),1),Ja,O(L(o(i).error),1)]))],2))}});var Xa=Q(Ka,[["__scopeId","data-v-32313015"]]);const pn=e=>(Ke("data-v-2a4275be"),e=e(),Xe(),e),Qa=pn(()=>y("h2",null,"Saves Manager",-1)),el={class:"modal-footer"},tl={class:"field"},nl=pn(()=>y("span",{class:"field-title"},"Create Save",-1)),il={class:"field-buttons"},rl={class:"footer"},ol=pn(()=>y("div",{style:{"flex-grow":"1"}},null,-1)),sl=B({__name:"SavesManager",setup(e,{expose:t}){const n=A(!1),i=A(null);t({open(){n.value=!0}});const r=A(!1),s=A(""),a=A(null);$e(s,k=>{k?lt(()=>{try{if(k[0]!=="{")if(k[0]==="e")k=decodeURIComponent(escape(atob(k)));else if(k[0]==="\u1BE1")k=Ee.decompressFromUTF16(k);else{console.warn("Unable to determine preset encoding",k),r.value=!0;return}const T=JSON.parse(k);if(typeof T!="object"){r.value=!0;return}const I=qt();T.id=I,ye(T),s.value="",r.value=!1,te.saves.push(I)}catch{r.value=!0}}):r.value=!1});let l={},u=A(Object.keys(l).reduce((k,T)=>(k.push({label:T.split("/").slice(-1)[0].slice(0,-4),value:l[T]}),k),[]));const f=tn({});function v(k){if(f[k]==null){let T=localStorage.getItem(k);if(T==null)f[k]={error:"Save doesn't exist in localStorage",id:k};else if(T==="dW5kZWZpbmVk")f[k]={error:"Save is undefined",id:k};else try{if(T[0]!=="{")if(T[0]==="e")T=decodeURIComponent(escape(atob(T)));else if(T[0]==="\u1BE1")T=Ee.decompressFromUTF16(T);else return console.warn("Unable to determine preset encoding",T),r.value=!0,f[k]={error:"Unable to determine preset encoding",id:k},f[k];f[k]={...JSON.parse(T),id:k}}catch(I){f[k]={error:I,id:k},console.warn(`SavesManager: Failed to load info about save with id ${k}:
${I}
${T}`)}}return f[k]}$e(n,k=>{k&&Object.keys(f).forEach(T=>delete f[T])});const g=$(()=>te.saves.reduce((k,T)=>(k[T]=v(T),k),{}));function p(k){let T;switch(D.id===k?T=rn(D):T=JSON.stringify(g.value[k]),J.exportEncoding){default:console.warn(`Unknown save encoding: ${J.exportEncoding}. Defaulting to lz`);case"lz":T=Ee.compressToUTF16(T);break;case"base64":T=btoa(unescape(encodeURIComponent(T)));break;case"plain":break}const I=document.createElement("textarea");I.value=T,document.body.appendChild(I),I.select(),I.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(I)}function b(k){D.id===k&&ye();const T={...g.value[k],id:qt()};ye(T),te.saves.push(T.id)}function C(k){te.saves=te.saves.filter(T=>T!==k),localStorage.removeItem(k),f[k]=void 0}function w(k){g.value[D.id].time=D.time,ye(),f[D.id]=void 0,ot(g.value[k]),f[k]=void 0}function M(k){if(a.value=k,lt(()=>{a.value=null}),k[0]!=="{")if(k[0]==="e")k=decodeURIComponent(escape(atob(k)));else if(k[0]==="\u1BE1")k=Ee.decompressFromUTF16(k);else{console.warn("Unable to determine preset encoding",k);return}const T=JSON.parse(k);T.id=qt(),ye(T),te.saves.push(T.id),w(T.id)}function P(k,T){const I=g.value[k];I!=null&&(I.name=T,D.id===k?(D.name=T,ye()):(ye(I),f[k]=void 0))}return(k,T)=>(_(),G(dt,{modelValue:n.value,"onUpdate:modelValue":T[4]||(T[4]=I=>n.value=I),ref_key:"modal",ref:i},{header:V(()=>[Qa]),body:V(({shown:I})=>[I?(_(),G(o(vi),{key:0,list:o(te).saves,handle:".handle",itemKey:U=>U},{item:V(({element:U})=>[h(Xa,{save:o(g)[U],onOpen:H=>w(U),onExport:H=>p(U),onEditName:H=>P(U,H),onDuplicate:H=>b(U),onDelete:H=>C(U)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):E("",!0)]),footer:V(()=>[y("div",el,[h(Kn,{modelValue:s.value,"onUpdate:modelValue":T[0]||(T[0]=I=>s.value=I),title:"Import Save",placeholder:"Paste your save here!",class:ie({importingFailed:r.value})},null,8,["modelValue","class"]),y("div",tl,[nl,y("div",il,[y("button",{class:"button",onClick:T[1]||(T[1]=I=>w(o(pt)().id))},"New Game"),Object.keys(o(u)).length>0?(_(),G(Jn,{key:0,options:o(u),modelValue:a.value,"onUpdate:modelValue":T[2]||(T[2]=I=>M(I)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):E("",!0)])]),y("div",rl,[ol,y("button",{class:"button modal-default-button",onClick:T[3]||(T[3]=I=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var Xn=Q(sl,[["__scopeId","data-v-2a4275be"]]);const _e=e=>(Ke("data-v-47c54e31"),e=e(),Xe(),e),al=["src","alt"],ll={key:1,class:"title"},ul=_e(()=>y("div",{style:{"flex-grow":"1",cursor:"unset"}},null,-1)),cl={class:"discord"},dl={class:"discord-links"},fl={key:0},gl=["href"],ml=_e(()=>y("li",null,[y("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"Profectus & Friends")],-1)),pl=_e(()=>y("li",null,[y("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),hl={href:"https://forums.moddingtree.com/",target:"_blank"},vl=_e(()=>y("span",{class:"material-icons"},"forum",-1)),bl=_e(()=>y("span",{class:"material-icons"},"info",-1)),yl=_e(()=>y("span",{class:"material-icons"},"library_books",-1)),_l=_e(()=>y("span",{class:"material-icons"},"settings",-1)),Nl=_e(()=>y("span",{class:"material-icons"},"library_books",-1)),wl=_e(()=>y("span",{class:"material-icons"},"settings",-1)),Cl=_e(()=>y("span",{class:"material-icons"},"info",-1)),kl={href:"https://forums.moddingtree.com/",target:"_blank"},Sl=_e(()=>y("span",{class:"material-icons"},"forum",-1)),Il={class:"discord"},Ml={class:"discord-links"},xl={key:0},$l=["href"],Tl=_e(()=>y("li",null,[y("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"Profectus & Friends")],-1)),Pl=_e(()=>y("li",null,[y("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Fl=B({__name:"Nav",setup(e){const t=A(null),n=A(null),i=A(null),r=A(null),{useHeader:s,banner:a,title:l,discordName:u,discordLink:f,versionNumber:v}=J;function g(){window.open(f,"mywindow")}return(p,b)=>(_(),S(R,null,[o(s)?(_(),S("div",Le({key:0,class:"nav"},p.$attrs),[o(a)?(_(),S("img",{key:0,src:o(a),class:"banner",alt:o(l)},null,8,al)):(_(),S("div",ll,L(o(l)),1)),y("div",{onClick:b[0]||(b[0]=C=>{var w;return(w=r.value)==null?void 0:w.open()}),class:"version-container"},[h(ce,{display:"Changelog",direction:o(z).Down,class:"version"},{default:V(()=>[y("span",null,"v"+L(o(v)),1)]),_:1},8,["direction"])]),ul,y("div",cl,[y("span",{onClick:g,class:"material-icons"},"discord"),y("ul",dl,[o(f)?(_(),S("li",fl,[y("a",{href:o(f),target:"_blank"},L(o(u)),9,gl)])):E("",!0),ml,pl])]),y("div",null,[y("a",hl,[h(ce,{display:"Forums",direction:o(z).Down,yoffset:"5px"},{default:V(()=>[vl]),_:1},8,["direction"])])]),y("div",{onClick:b[1]||(b[1]=C=>{var w;return(w=t.value)==null?void 0:w.open()})},[h(ce,{display:"Info",direction:o(z).Down,class:"info"},{default:V(()=>[bl]),_:1},8,["direction"])]),y("div",{onClick:b[2]||(b[2]=C=>{var w;return(w=n.value)==null?void 0:w.open()})},[h(ce,{display:"Saves",direction:o(z).Down,xoffset:"-20px"},{default:V(()=>[yl]),_:1},8,["direction"])]),y("div",{onClick:b[3]||(b[3]=C=>{var w;return(w=i.value)==null?void 0:w.open()})},[h(ce,{display:"Settings",direction:o(z).Down,xoffset:"-66px"},{default:V(()=>[_l]),_:1},8,["direction"])])],16)):(_(),S("div",Le({key:1,class:"overlay-nav"},p.$attrs),[y("div",{onClick:b[4]||(b[4]=C=>{var w;return(w=r.value)==null?void 0:w.open()}),class:"version-container"},[h(ce,{display:"Changelog",direction:o(z).Right,xoffset:"25%",class:"version"},{default:V(()=>[y("span",null,"v"+L(o(v)),1)]),_:1},8,["direction"])]),y("div",{onClick:b[5]||(b[5]=C=>{var w;return(w=n.value)==null?void 0:w.open()})},[h(ce,{display:"Saves",direction:o(z).Right},{default:V(()=>[Nl]),_:1},8,["direction"])]),y("div",{onClick:b[6]||(b[6]=C=>{var w;return(w=i.value)==null?void 0:w.open()})},[h(ce,{display:"Settings",direction:o(z).Right},{default:V(()=>[wl]),_:1},8,["direction"])]),y("div",{onClick:b[7]||(b[7]=C=>{var w;return(w=t.value)==null?void 0:w.open()})},[h(ce,{display:"Info",direction:o(z).Right},{default:V(()=>[Cl]),_:1},8,["direction"])]),y("div",null,[y("a",kl,[h(ce,{display:"Forums",direction:o(z).Right,xoffset:"7px"},{default:V(()=>[Sl]),_:1},8,["direction"])])]),y("div",Il,[y("span",{onClick:g,class:"material-icons"},"discord"),y("ul",Ml,[o(f)?(_(),S("li",xl,[y("a",{href:o(f),target:"_blank"},L(o(u)),9,$l)])):E("",!0),Tl,Pl])])],16)),h(ga,{ref_key:"info",ref:t,changelog:r.value},null,8,["changelog"]),h(Xn,{ref_key:"savesManager",ref:n},null,512),h(Ca,{ref_key:"options",ref:i},null,512),h(Zs,{ref_key:"changelog",ref:r},null,512)],64))}});var Qn=Q(Fl,[["__scopeId","data-v-47c54e31"]]);const Dl={class:"inner-tab"},El=B({__name:"Game",setup(e){const t=ze(D,"tabs"),n=$(()=>Object.keys(he)),i=J.useHeader;function r(s){const{display:a,minimized:l,name:u,color:f,minimizable:v,nodes:g,minimizedDisplay:p}=s;return{display:a,minimized:l,name:u,color:f,minimizable:v,nodes:g,minimizedDisplay:p}}return(s,a)=>(_(),S("div",{class:ie(["tabs-container",{useHeader:o(i)}])},[(_(!0),S(R,null,Ie(o(t),(l,u)=>{var f,v;return _(),S("div",{key:u,class:ie(["tab",o((f=o(he)[l])==null?void 0:f.classes)]),style:me(o((v=o(he)[l])==null?void 0:v.style))},[u===0&&!o(i)?(_(),G(Qn,{key:0})):E("",!0),y("div",Dl,[o(n).includes(l)?(_(),G(js,Le({key:0},r(o(he)[l]),{index:u,onSetMinimized:g=>o(he)[l].minimized.value=g}),null,16,["index","onSetMinimized"])):(_(),G(ve(l),{key:1,index:u},null,8,["index"]))])],6)}),128))],2))}});var Al=Q(El,[["__scopeId","data-v-dcd207b4"]]);const Ol=B({__name:"Spacer",props:{width:{default:"8px"},height:{default:"17px"}},setup(e){return(t,n)=>(_(),S("div",{style:me({width:e.width,height:e.height})},null,4))}});const Vl=["x1","y1","x2","y2"],ql=B({__name:"BoardLink",props:{link:null,dragging:null,dragged:null},setup(e){const t=e,n=de(t),i=$(()=>{var l,u,f,v,g,p,b;const a={...n.link.value.startNode.position};return n.link.value.offsetStart&&(a.x+=o(n.link.value.offsetStart).x,a.y+=o(n.link.value.offsetStart).y),((l=n.dragging)==null?void 0:l.value)===n.link.value.startNode&&(a.x+=(v=(f=(u=n.dragged)==null?void 0:u.value)==null?void 0:f.x)!=null?v:0,a.y+=(b=(p=(g=n.dragged)==null?void 0:g.value)==null?void 0:p.y)!=null?b:0),a}),r=$(()=>{var l,u,f,v,g,p,b;const a={...n.link.value.endNode.position};return n.link.value.offsetEnd&&(a.x+=o(n.link.value.offsetEnd).x,a.y+=o(n.link.value.offsetEnd).y),((l=n.dragging)==null?void 0:l.value)===n.link.value.endNode&&(a.x+=(v=(f=(u=n.dragged)==null?void 0:u.value)==null?void 0:f.x)!=null?v:0,a.y+=(b=(p=(g=n.dragged)==null?void 0:g.value)==null?void 0:p.y)!=null?b:0),a}),s=$(()=>Gn(t.link));return(a,l)=>(_(),S("line",Le({class:"link"},o(s),{class:{pulsing:e.link.pulsing},x1:o(i).x,y1:o(i).y,x2:o(r).x,y2:o(r).y}),null,16,Vl))}});var Ll=Q(ql,[["__scopeId","data-v-4e1e901b"]]);const Rl={key:0},Bl=["transform","onMousedown","onTouchstart","onMouseup","onTouchend"],zl=["fill","stroke-width","stroke"],Ul=["fill"],jl=B({__name:"BoardNodeAction",props:{node:null,nodeType:null,actions:null,isSelected:{type:Boolean},selectedAction:null},emits:["clickAction"],setup(e,{emit:t}){const i=de(e),r=$(()=>X(i.nodeType.value.size,o(i.node))),s=$(()=>{var v;return(v=X(i.nodeType.value.outlineColor,o(i.node)))!=null?v:Me[te.theme].variables["--outline"]}),a=$(()=>{var v;return(v=X(i.nodeType.value.titleColor,o(i.node)))!=null?v:Me[te.theme].variables["--foreground"]}),l=$(()=>X(i.nodeType.value.actionDistance,o(i.node)));function u(v,g){t("clickAction",g.id),v.preventDefault(),v.stopPropagation()}function f(v,g){var p;((p=o(i.selectedAction))==null?void 0:p.id)===g.id&&(v.preventDefault(),v.stopPropagation())}return(v,g)=>(_(),G(kt,{name:"actions",appear:""},{default:V(()=>[e.isSelected&&e.actions?(_(),S("g",Rl,[(_(!0),S(R,null,Ie(e.actions,(p,b)=>{var C,w;return _(),S("g",{key:p.id,class:ie(["action",{selected:((C=e.selectedAction)==null?void 0:C.id)===p.id}]),transform:`translate(
                        ${(-o(r)-30)*Math.sin(((e.actions.length-1)/2-b)*o(l))},
                        ${(o(r)+30)*Math.cos(((e.actions.length-1)/2-b)*o(l))}
                    )`,onMousedown:M=>u(M,p),onTouchstart:M=>u(M,p),onMouseup:M=>f(M,p),onTouchend:ht(M=>f(M,p),["stop"])},[y("circle",{fill:o(X)(p.fillColor,e.node),r:"20","stroke-width":((w=e.selectedAction)==null?void 0:w.id)===p.id?4:0,stroke:o(s)},null,8,zl),y("text",{fill:o(a),class:"material-icons"},L(o(X)(p.icon,e.node)),9,Ul)],42,Bl)}),128))])):E("",!0)]),_:1}))}});var Gl=Q(jl,[["__scopeId","data-v-9efb2a56"]]);const Wl=["transform"],Hl={key:0},Zl=["r","fill","stroke"],Yl=["r","fill","stroke"],Jl=["r","fill"],Kl=["r","stroke-dasharray","stroke-dashoffset","stroke"],Xl={key:1,transform:"rotate(45, 0, 0)"},Ql=["width","height","transform","fill","stroke"],eu=["width","height","transform","fill","stroke"],tu=["width","height","transform","fill"],nu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],iu=["fill"],ru={key:0},ou=["fill","y"],su=["fill","y"],au=B({__name:"BoardNode",props:{node:null,nodeType:null,dragging:null,dragged:null,hasDragged:{type:Boolean},receivingNode:{type:Boolean},isSelected:{type:Boolean},selectedAction:null},emits:["mouseDown","endDragging","clickAction"],setup(e,{emit:t}){const n=e,i=Math.sqrt(2),r=de(n),s=$(()=>X(r.nodeType.value.draggable,o(r.node)));$e(s,Z=>{const fe=o(r.node);o(r.dragging)===fe&&!Z&&t("endDragging",fe)});const a=$(()=>{var fe;const Z=o(r.node);return(fe=X(r.nodeType.value.actions,Z))==null?void 0:fe.filter(Pe=>ct(X(Pe.visibility,Z)))}),l=$(()=>{var fe;const Z=o(r.node);if(X(r.nodeType.value.draggable,Z)&&((fe=o(r.dragging))==null?void 0:fe.id)===Z.id&&o(r.dragged)!=null){const{x:Pe,y:Qe}=o(r.dragged);return{x:Z.position.x+Math.round(Pe/25)*25,y:Z.position.y+Math.round(Qe/25)*25}}return Z.position}),u=$(()=>X(r.nodeType.value.shape,o(r.node))),f=$(()=>X(r.nodeType.value.title,o(r.node))),v=$(()=>{var Z;return(Z=r.isSelected.value?o(r.selectedAction)&&X(o(r.selectedAction).tooltip,o(r.node)):null)!=null?Z:X(r.nodeType.value.label,o(r.node))}),g=$(()=>{var Z,fe;return X((fe=(Z=o(r.selectedAction))==null?void 0:Z.confirmationLabel)!=null?fe:{text:"Tap again to confirm"},o(r.node))}),p=$(()=>X(r.nodeType.value.size,o(r.node))),b=$(()=>{var Z;return(Z=X(r.nodeType.value.progress,o(r.node)))!=null?Z:0}),C=$(()=>Me[te.theme].variables["--background"]),w=$(()=>{var Z;return(Z=X(r.nodeType.value.outlineColor,o(r.node)))!=null?Z:Me[te.theme].variables["--outline"]}),M=$(()=>{var Z;return(Z=X(r.nodeType.value.fillColor,o(r.node)))!=null?Z:Me[te.theme].variables["--raised-background"]}),P=$(()=>X(r.nodeType.value.progressColor,o(r.node))),k=$(()=>{var Z;return(Z=X(r.nodeType.value.titleColor,o(r.node)))!=null?Z:Me[te.theme].variables["--foreground"]}),T=$(()=>X(r.nodeType.value.progressDisplay,o(r.node))),I=$(()=>r.dragging.value!=null&&o(r.hasDragged)&&X(r.nodeType.value.canAccept,o(r.node),r.dragging.value)),U=$(()=>X(r.nodeType.value.style,o(r.node))),H=$(()=>X(r.nodeType.value.classes,o(r.node)));function ee(Z){t("mouseDown",Z,r.node.value,s.value)}function ae(Z){var fe,Pe,Qe;(fe=r.hasDragged)!=null&&fe.value||(t("endDragging",r.node.value),(Qe=(Pe=r.nodeType.value).onClick)==null||Qe.call(Pe,r.node.value),Z.stopPropagation())}return(Z,fe)=>{var Pe,Qe,Nn;return _(),S("g",{class:ie(["boardnode",{[e.node.type]:!0,isSelected:e.isSelected,isDraggable:o(s),...o(H)}]),style:me([{opacity:((Pe=e.dragging)==null?void 0:Pe.id)===e.node.id&&e.hasDragged?.5:1},(Qe=o(U))!=null?Qe:[]]),transform:`translate(${o(l).x},${o(l).y})${e.isSelected?" scale(1.2)":""}`},[h(Gl,{actions:(Nn=o(a))!=null?Nn:[],"is-selected":e.isSelected,node:e.node,"node-type":e.nodeType,"selected-action":e.selectedAction,onClickAction:fe[0]||(fe[0]=et=>t("clickAction",et))},null,8,["actions","is-selected","node","node-type","selected-action"]),y("g",{class:"node-container",onMousedown:ee,onTouchstartPassive:ee,onMouseup:ae,onTouchendPassive:ae},[o(u)===o($t).Circle?(_(),S("g",Hl,[o(I)?(_(),S("circle",{key:0,class:"receiver",r:o(p)+8,fill:o(C),stroke:e.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,Zl)):E("",!0),y("circle",{class:"body",r:o(p),fill:o(M),stroke:o(w),"stroke-width":4},null,8,Yl),o(T)===o(en).Fill?(_(),S("circle",{key:1,class:"progress progressFill",r:Math.max(o(p)*o(b)-2,0),fill:o(P)},null,8,Jl)):(_(),S("circle",{key:2,r:o(p)+4.5,class:"progress progressRing",fill:"transparent","stroke-dasharray":(o(p)+4.5)*2*Math.PI,"stroke-width":5,"stroke-dashoffset":(o(p)+4.5)*2*Math.PI-o(b)*(o(p)+4.5)*2*Math.PI,stroke:o(P)},null,8,Kl))])):o(u)===o($t).Diamond?(_(),S("g",Xl,[o(I)?(_(),S("rect",{key:0,class:"receiver",width:o(p)*o(i)+16,height:o(p)*o(i)+16,transform:`translate(${-(o(p)*o(i)+16)/2}, ${-(o(p)*o(i)+16)/2})`,fill:o(C),stroke:e.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,Ql)):E("",!0),y("rect",{class:"body",width:o(p)*o(i),height:o(p)*o(i),transform:`translate(${-o(p)*o(i)/2}, ${-o(p)*o(i)/2})`,fill:o(M),stroke:o(w),"stroke-width":4},null,8,eu),o(T)===o(en).Fill?(_(),S("rect",{key:1,class:"progress progressFill",width:Math.max(o(p)*o(i)*o(b)-2,0),height:Math.max(o(p)*o(i)*o(b)-2,0),transform:`translate(${-Math.max(o(p)*o(i)*o(b)-2,0)/2}, ${-Math.max(o(p)*o(i)*o(b)-2,0)/2})`,fill:o(P)},null,8,tu)):(_(),S("rect",{key:2,class:"progress progressDiamond",width:o(p)*o(i)+9,height:o(p)*o(i)+9,transform:`translate(${-(o(p)*o(i)+9)/2}, ${-(o(p)*o(i)+9)/2})`,fill:"transparent","stroke-dasharray":(o(p)*o(i)+9)*4,"stroke-width":5,"stroke-dashoffset":(o(p)*o(i)+9)*4-o(b)*(o(p)*o(i)+9)*4,stroke:o(P)},null,8,nu))])):E("",!0),y("text",{fill:o(k),class:"node-title"},L(o(f)),9,iu)],32),h(kt,{name:"fade",appear:""},{default:V(()=>{var et;return[o(v)?(_(),S("g",ru,[y("text",{fill:(et=o(v).color)!=null?et:o(k),class:ie(["node-title",{pulsing:o(v).pulsing}]),y:-o(p)-20},L(o(v).text),11,ou)])):E("",!0)]}),_:1}),h(kt,{name:"fade",appear:""},{default:V(()=>{var et;return[e.isSelected&&e.selectedAction?(_(),S("text",{key:0,fill:(et=o(g).color)!=null?et:o(k),class:ie(["node-title",{pulsing:o(g).pulsing}]),y:o(p)+75},L(o(g).text),11,su)):E("",!0)]}),_:1})],14,Wl)}}});var lu=Q(au,[["__scopeId","data-v-1a032ffd"]]);const uu={class:"stage",width:"100%",height:"100%"},cu={class:"g1"},du=B({__name:"Board",props:{nodes:null,types:null,state:null,visibility:null,width:null,height:null,style:null,classes:null,links:null,selectedAction:null,selectedNode:null,draggingNode:null,receivingNode:null,mousePosition:null,setReceivingNode:{type:Function},setDraggingNode:{type:Function}},setup(e){const n=de(e),i=A({x:0,y:0}),r=A({x:0,y:0}),s=A(!1),a=A(null),l=$(()=>{const b=n.nodes.value.slice();if(n.selectedNode.value){const C=b.splice(b.indexOf(n.selectedNode.value),1)[0];b.push(C)}if(n.draggingNode.value){const C=b.splice(b.indexOf(n.draggingNode.value),1)[0];b.push(C)}return b});We(()=>{const b=n.draggingNode.value;if(b==null)return null;const C={x:b.position.x+r.value.x,y:b.position.y+r.value.y};let w=Number.MAX_VALUE;n.setReceivingNode.value(n.nodes.value.reduce((M,P)=>{if(P.id===b.id)return M;const k=n.types.value[P.type];if(!X(k.canAccept,P,b))return M;const I=Math.pow(C.x-P.position.x,2)+Math.pow(C.y-P.position.y,2);let U=X(k.size,P);return I>w||I>U*U?M:(w=I,P)},null))});function u(b){b.setTransformOrigin(null),b.moveTo(a.value.$el.clientWidth/2,a.value.$el.clientHeight/2)}function f(b,C=null,w=!1){if(n.draggingNode.value==null){b.preventDefault(),b.stopPropagation();let M,P;if("touches"in b)if(b.touches.length===1)M=b.touches[0].clientX,P=b.touches[0].clientY;else return;else M=b.clientX,P=b.clientY;i.value={x:M,y:P},r.value={x:0,y:0},s.value=!1,w&&n.setDraggingNode.value(C)}C!=null&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function v(b){const{x:C,y:w,scale:M}=a.value.panZoomInstance.getTransform();let P,k;if("touches"in b)if(b.touches.length===1)P=b.touches[0].clientX,k=b.touches[0].clientY;else{g(n.draggingNode.value),n.mousePosition.value=null;return}else P=b.clientX,k=b.clientY;n.mousePosition.value={x:(P-C)/M,y:(k-w)/M},r.value={x:r.value.x+(P-i.value.x)/M,y:r.value.y+(k-i.value.y)/M},i.value={x:P,y:k},(Math.abs(r.value.x)>10||Math.abs(r.value.y)>10)&&(s.value=!0),n.draggingNode.value!=null&&(b.preventDefault(),b.stopPropagation())}function g(b,C=!1){var w,M;if(n.draggingNode.value!=null&&n.draggingNode.value===b){n.receivingNode.value==null&&(n.draggingNode.value.position.x+=Math.round(r.value.x/25)*25,n.draggingNode.value.position.y+=Math.round(r.value.y/25)*25);const P=n.nodes.value;P.push(P.splice(P.indexOf(n.draggingNode.value),1)[0]),n.receivingNode.value&&((M=(w=n.types.value[n.receivingNode.value.type]).onDrop)==null||M.call(w,n.receivingNode.value,n.draggingNode.value)),n.setDraggingNode.value(null)}else!s.value&&!C&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function p(b,C){n.state.value.selectedAction===C?o(n.selectedAction).onClick(o(n.selectedNode)):n.state.value={...n.state.value,selectedAction:C}}return(b,C)=>{const w=Be("panZoom");return o(ct)(e.visibility)?(_(),G(w,{key:0,style:me([{width:e.width,height:e.height},e.style]),class:ie(e.classes),selector:".g1",options:{initialZoom:1,minZoom:.1,maxZoom:10,zoomDoubleClickSpeed:1},ref_key:"stage",ref:a,onInit:u,onMousemove:v,onTouchmove:v,onMousedown:C[0]||(C[0]=M=>f(M)),onTouchstart:C[1]||(C[1]=M=>f(M)),onMouseup:C[2]||(C[2]=()=>g(o(e.draggingNode))),onTouchendPassive:C[3]||(C[3]=()=>g(o(e.draggingNode))),onMouseleave:C[4]||(C[4]=()=>g(o(e.draggingNode),!0))},{default:V(()=>[(_(),S("svg",uu,[y("g",cu,[h(wn,{name:"link",appear:""},{default:V(()=>[(_(!0),S(R,null,Ie(o(e.links)||[],M=>(_(),S("g",{key:`${M.startNode.id}-${M.endNode.id}`},[h(Ll,{link:M,dragging:o(e.draggingNode),dragged:M.startNode===o(e.draggingNode)||M.endNode===o(e.draggingNode)?r.value:void 0},null,8,["link","dragging","dragged"])]))),128))]),_:1}),h(wn,{name:"grow",duration:500,appear:""},{default:V(()=>[(_(!0),S(R,null,Ie(o(l),M=>(_(),S("g",{key:M.id,style:{"transition-duration":"0s"}},[h(lu,{node:M,nodeType:e.types[M.type],dragging:o(e.draggingNode),dragged:o(e.draggingNode)===M?r.value:void 0,hasDragged:o(e.draggingNode)==null?!1:s.value,receivingNode:o(e.receivingNode)===M,isSelected:o(e.selectedNode)===M,selectedAction:o(e.selectedNode)===M?o(e.selectedAction):null,onMouseDown:f,onEndDragging:g,onClickAction:P=>p(M,P)},null,8,["node","nodeType","dragging","dragged","hasDragged","receivingNode","isSelected","selectedAction","onClickAction"])]))),128))]),_:1})])]))]),_:1},8,["style","class","options"])):E("",!0)}}});pe.on("setupVue",e=>yi.install(e));const ei=Symbol("Board");var en=(e=>(e.Outline="Outline",e.Fill="Fill",e))(en||{}),$t=(e=>(e.Circle="Circle",e.Diamond="Triangle",e))($t||{});function fu(e){const t=ft({nodes:[],selectedNode:null,selectedAction:null},!1);return Te(n=>{const i=e.call(n,n);i.id=Pt("board-"),i.type=ei,i[Ve]=du,i.state?(Vs(t),F(i,"state")):(t[Je]={nodes:i.startNodes().map((l,u)=>(l.id=u,l)),selectedNode:null,selectedAction:null},i.state=t),i.nodes=$(()=>o(a.state).nodes),i.selectedNode=$({get(){return a.nodes.value.find(l=>l.id===o(a.state).selectedNode)||null},set(l){var u,f;le(a.state)?a.state.value={...a.state.value,selectedNode:(u=l==null?void 0:l.id)!=null?u:null}:a.state.selectedNode=(f=l==null?void 0:l.id)!=null?f:null}}),i.selectedAction=$({get(){const l=a.selectedNode.value;if(l==null)return null;const u=a.types[l.type];return u.actions==null?null:u.actions.find(f=>f.id===o(a.state).selectedAction)||null},set(l){var u,f;le(a.state)?a.state.value={...a.state.value,selectedAction:(u=l==null?void 0:l.id)!=null?u:null}:a.state.selectedAction=(f=l==null?void 0:l.id)!=null?f:null}}),i.mousePosition=A(null),i.links?F(i,"links"):i.links=$(()=>a.selectedAction.value==null?null:a.selectedAction.value.links&&a.selectedNode.value?X(a.selectedAction.value.links,a.selectedNode.value):null),i.draggingNode=A(null),i.receivingNode=A(null),F(i,"visibility"),K(i,"visibility",ke.Visible),F(i,"width"),K(i,"width","100%"),F(i,"height"),K(i,"height","100%"),F(i,"classes"),F(i,"style");for(const l in i.types){const u=i.types[l];if(F(u,"title"),F(u,"label"),F(u,"size"),K(u,"size",50),F(u,"style"),F(u,"classes"),F(u,"draggable"),K(u,"draggable",!1),F(u,"shape"),K(u,"shape","Circle"),F(u,"canAccept"),K(u,"canAccept",!1),F(u,"progress"),F(u,"progressDisplay"),K(u,"progressDisplay","Fill"),F(u,"progressColor"),K(u,"progressColor","none"),F(u,"fillColor"),F(u,"outlineColor"),F(u,"titleColor"),F(u,"actionDistance"),K(u,"actionDistance",Math.PI/6),u.nodes=$(()=>o(a.state).nodes.filter(f=>f.type===l)),K(u,"onClick",function(f){o(a.state).selectedNode=f.id}),u.actions)for(const f of u.actions)F(f,"visibility"),K(f,"visibility",ke.Visible),F(f,"icon"),F(f,"fillColor"),F(f,"tooltip"),F(f,"confirmationLabel"),K(f,"confirmationLabel",{text:"Tap again to confirm"}),F(f,"links")}function r(l){i.draggingNode.value=l}function s(l){i.receivingNode.value=l}i.placeInAvailableSpace=function(l,u=100,f=z.Right){const v=a.nodes.value.slice().filter(g=>g===l||(f===z.Down||f===z.Up)&&Math.abs(g.position.x-l.position.x)>u||(f===z.Left||f===z.Right)&&Math.abs(g.position.y-l.position.y)>u?!1:!(f===z.Right&&g.position.x<l.position.x-u||f===z.Left&&g.position.x>l.position.x+u||f===z.Up&&g.position.y>l.position.y+u||f===z.Down&&g.position.y<l.position.y-u)).sort(f===z.Right?(g,p)=>g.position.x-p.position.x:f===z.Left?(g,p)=>p.position.x-g.position.x:f===z.Up?(g,p)=>p.position.y-g.position.y:(g,p)=>g.position.y-p.position.y);for(let g=0;g<v.length;g++){const p=v[g],b=f===z.Right||f===z.Left?Math.abs(l.position.x-p.position.x):Math.abs(l.position.y-p.position.y);if(b<u)f===z.Right?l.position.x=p.position.x+u:f===z.Left?l.position.x=p.position.x-u:f===z.Up?l.position.y=p.position.y-u:f===z.Down&&(l.position.y=p.position.y+u);else if(g>0&&b>u)break}},i[qe]=function(){const{nodes:l,types:u,state:f,visibility:v,width:g,height:p,style:b,classes:C,links:w,selectedAction:M,selectedNode:P,mousePosition:k,draggingNode:T,receivingNode:I}=this;return{nodes:l,types:u,state:f,visibility:v,width:g,height:p,style:o(b),classes:C,links:w,selectedAction:M,selectedNode:P,mousePosition:k,draggingNode:T,receivingNode:I,setDraggingNode:r,setReceivingNode:s}};const a=i;return a})}function X(e,t,...n){return jt(e)?e(t,...n):o(e)}const Ct={};pe.on("addLayer",e=>{const t=Lr(e,ei);Ct[e.id]=e.on("postUpdate",n=>{t.forEach(i=>{Object.values(i.types).forEach(r=>r.nodes.value.forEach(s=>{var a;return(a=r.update)==null?void 0:a.call(r,s,n)}))})})});pe.on("removeLayer",e=>{var t;(t=Ct[e.id])==null||t.call(Ct),Ct[e.id]=void 0});function Qt(e,t){return e.nodes.value.find(n=>n.id===t)}function gu(e,t="points",n=0,i=void 0){const r=le(e)?e:ft(e);if(r.displayName=t,r.precision=n,r.small=i,!le(e)){const s=r[xe];s.displayName=t,s.precision=n,s.small=i}return r}new c("10^^8");new c("1e100");function Ht(e,t){const n=t!=null?t:e.value;return c.eq(e.precision,0)?ut(e.small?n:c.floor(n)):ge(n,e.precision,e.small)}const mu=Symbol("Reset");function pu(e){return Te(t=>{const n=e.call(t,t);return n.id=Pt("reset-"),n.type=mu,n.reset=function(){var r;const i=s=>{if(s!=null&&typeof s=="object"&&!(s instanceof c)&&!(s instanceof d)){if(xt in s&&s[xt]===!0)return;if(Je in s){const a=s;a.value=a[Je]}else!(s instanceof c)&&!le(s)&&Object.values(s).forEach(a=>i(a))}};o(n.thingsToReset).forEach(i),pe.emit("reset",n),(r=n.onReset)==null||r.call(n)},F(n,"thingsToReset"),n})}const Et={};pe.on("removeLayer",e=>{var t;(t=Et[e.id])==null||t.call(Et),Et[e.id]=void 0});const hu={key:0},vu={key:0,class:"mark star"},bu=["src"],yu=B({__name:"MarkNode",props:{mark:{type:[Boolean,String]}},setup(e){return(t,n)=>e.mark?(_(),S("div",hu,[e.mark===!0?(_(),S("div",vu)):(_(),S("img",{key:1,class:"mark",src:e.mark},null,8,bu))])):E("",!0)}});var hn=Q(yu,[["__scopeId","data-v-2207999f"]]);const _u=B({__name:"Node",props:{id:null},setup(e){const n=de(e),i=Bt(ln,()=>{}),r=Bt(un,()=>{}),s=Se(null),a=$(()=>s.value&&s.value.parentElement);return $e([a,n.id],([l,u],[f,v])=>{f&&r(o(v)),l&&i(u,l)}),Dn(()=>r(o(n.id))),(l,u)=>(_(),S("div",{class:"node",ref_key:"node",ref:s},null,512))}});var vn=Q(_u,[["__scopeId","data-v-a48cb382"]]),Nu=B({props:{display:{type:W(Object,String,Function),required:!0},visibility:{type:W(Number,Boolean),required:!0},style:W(Object,String,Array),classes:W(Object),onClick:Function,onHold:Function,canClick:{type:W(Boolean),required:!0},small:Boolean,mark:W(Boolean,String),id:{type:String,required:!0}},components:{Node:vn,MarkNode:hn},setup(e){const{display:t,onClick:n,onHold:i}=de(e),r=Se("");We(()=>{var v;const l=Ce(t);if(l==null){r.value="";return}if(bt(l)){r.value=ne(l);return}const u=ne((v=l.title)!=null?v:"","h3"),f=ne(l.description,"div");r.value=ne(Y(()=>h("span",null,[l.title!=null?h("div",null,[h(u,null,null)]):null,h(f,null,null)])))});const{start:s,stop:a}=jn(n,i);return{start:s,stop:a,comp:r,Visibility:ke,isVisible:ct,isHidden:sn,unref:o}}});function wu(e,t,n,i,r,s){var u;const a=Be("MarkNode"),l=Be("Node");return e.isVisible(e.visibility)?(_(),S("button",{key:0,style:me([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(u=e.unref(e.style))!=null?u:[]]),onClick:t[0]||(t[0]=(...f)=>e.onClick&&e.onClick(...f)),onMousedown:t[1]||(t[1]=(...f)=>e.start&&e.start(...f)),onMouseleave:t[2]||(t[2]=(...f)=>e.stop&&e.stop(...f)),onMouseup:t[3]||(t[3]=(...f)=>e.stop&&e.stop(...f)),onTouchstartPassive:t[4]||(t[4]=(...f)=>e.start&&e.start(...f)),onTouchendPassive:t[5]||(t[5]=(...f)=>e.stop&&e.stop(...f)),onTouchcancelPassive:t[6]||(t[6]=(...f)=>e.stop&&e.stop(...f)),class:ie({feature:!0,clickable:!0,can:e.unref(e.canClick),locked:!e.unref(e.canClick),small:e.small,...e.unref(e.classes)})},[e.unref(e.comp)?(_(),G(ve(e.unref(e.comp)),{key:0})):E("",!0),h(a,{mark:e.unref(e.mark)},null,8,["mark"]),h(l,{id:e.id},null,8,["id"])],38)):E("",!0)}var Cu=Q(Nu,[["render",wu],["__scopeId","data-v-211328c0"]]);const ku=["x1","y1","x2","y2"],Su=B({__name:"Link",props:{link:null,startNode:null,endNode:null,boundingRect:null},setup(e){const t=e,n=de(t),i=$(()=>{const a=n.startNode.value.rect,l=n.boundingRect.value,u=l?{x:a.x+a.width/2-l.x,y:a.y+a.height/2-l.y}:{x:0,y:0};return n.link.value.offsetStart&&(u.x+=n.link.value.offsetStart.x,u.y+=n.link.value.offsetStart.y),u}),r=$(()=>{const a=n.endNode.value.rect,l=n.boundingRect.value,u=l?{x:a.x+a.width/2-l.x,y:a.y+a.height/2-l.y}:{x:0,y:0};return n.link.value.offsetEnd&&(u.x+=n.link.value.offsetEnd.x,u.y+=n.link.value.offsetEnd.y),u}),s=$(()=>Gn(t.link));return(a,l)=>(_(),S("line",Le({"stroke-width":"15px",stroke:"white"},o(s),{x1:o(i).x,y1:o(i).y,x2:o(r).x,y2:o(r).y}),null,16,ku))}});const Iu=B({__name:"Links",props:{links:null},setup(e){var u;const n=ze(e,"links"),i=A(null),r=Bt(cn,A({})),s=Bt(dn,A(void 0)),a=A((u=i.value)==null?void 0:u.getBoundingClientRect());$e(s,()=>{var f;return a.value=(f=i.value)==null?void 0:f.getBoundingClientRect()}),Tt(()=>{var f;return a.value=(f=i.value)==null?void 0:f.getBoundingClientRect()});const l=$(()=>{var v,g;const f=r.value;return(g=(v=n.value)==null?void 0:v.filter(p=>{var b,C;return((b=f[p.startNode.id])==null?void 0:b.rect)&&((C=f[p.startNode.id])==null?void 0:C.rect)}))!=null?g:[]});return(f,v)=>(_(),S(R,null,[o(l)?(_(),S("svg",mi(Le({key:0},f.$attrs)),[(_(!0),S(R,null,Ie(o(l),(g,p)=>(_(),G(Su,{key:p,link:g,boundingRect:a.value,startNode:o(r)[g.startNode.id],endNode:o(r)[g.endNode.id]},null,8,["link","boundingRect","startNode","endNode"]))),128))],16)):E("",!0),y("div",{ref_key:"resizeListener",ref:i,class:"resize-listener"},null,512)],64))}});var Mu=Q(Iu,[["__scopeId","data-v-063f6d6b"]]);B({props:{nodes:{type:W(Array),required:!0},leftSideNodes:W(Array),rightSideNodes:W(Array),branches:W(Array)},components:{Links:Mu},setup(e){const{nodes:t,leftSideNodes:n,rightSideNodes:i}=de(e),r=Se();We(()=>{const l=Ce(t);r.value=ne(Y(()=>h(R,null,[l.map(u=>h("span",{class:"row tree-row",style:"margin: 50px auto;"},[u.map(Ze)]))])))});const s=Se();We(()=>{const l=Ce(n);s.value=l?ne(Y(()=>h("span",{class:"left-side-nodes small"},[l.map(Ze)]))):""});const a=Se();return We(()=>{const l=Ce(i);a.value=l?ne(Y(()=>h("span",{class:"side-nodes small"},[l.map(Ze)]))):""}),{unref:o,nodesComp:r,leftNodesComp:s,rightNodesComp:a}}});const xu=B({props:{display:W(Object,String,Function),visibility:{type:W(Number,Boolean),required:!0},style:W(String,Object,Array),classes:W(Object),onClick:Function,onHold:Function,color:W(String),glowColor:W(String),canClick:{type:W(Boolean),required:!0},mark:W(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:hn,Node:vn},setup(e){const{onClick:t,onHold:n,display:i}=de(e),r=yt(i),{start:s,stop:a}=jn(t,n);return{start:s,stop:a,comp:r,unref:o,Visibility:ke,isCoercableComponent:bt,isVisible:ct,isHidden:sn}}});function $u(e,t,n,i,r,s){var u;const a=Be("MarkNode"),l=Be("Node");return e.isVisible(e.visibility)?(_(),S("div",{key:0,style:me({visibility:e.isHidden(e.visibility)?"hidden":void 0}),class:ie({treeNode:!0,can:e.unref(e.canClick),...e.unref(e.classes)}),onClick:t[0]||(t[0]=(...f)=>e.onClick&&e.onClick(...f)),onMousedown:t[1]||(t[1]=(...f)=>e.start&&e.start(...f)),onMouseleave:t[2]||(t[2]=(...f)=>e.stop&&e.stop(...f)),onMouseup:t[3]||(t[3]=(...f)=>e.stop&&e.stop(...f)),onTouchstartPassive:t[4]||(t[4]=(...f)=>e.start&&e.start(...f)),onTouchendPassive:t[5]||(t[5]=(...f)=>e.stop&&e.stop(...f)),onTouchcancelPassive:t[6]||(t[6]=(...f)=>e.stop&&e.stop(...f))},[y("div",{style:me([{backgroundColor:e.unref(e.color),boxShadow:`-4px -4px 4px rgba(0, 0, 0, 0.25) inset, 0 0 20px ${e.unref(e.glowColor)}`},(u=e.unref(e.style))!=null?u:[]])},[(_(),G(ve(e.unref(e.comp))))],4),h(a,{mark:e.unref(e.mark)},null,8,["mark"]),h(l,{id:e.id},null,8,["id"])],38)):E("",!0)}var Tu=Q(xu,[["render",$u],["__scopeId","data-v-727230a6"]]);const Pu=Symbol("TreeNode");function Fu(e,...t){const n=t.reduce((i,r)=>{var s;return Object.assign(i,(s=r.getPersistentData)==null?void 0:s.call(r))},{});return Te(i=>{var a,l,u;const r=(a=e==null?void 0:e.call(i,i))!=null?a:{};r.id=Pt("treeNode-"),r.type=Pu,r[Ve]=Tu;for(const f of t)(l=f.preConstruct)==null||l.call(f,r);Object.assign(n),F(r,"visibility"),K(r,"visibility",ke.Visible),F(r,"canClick"),K(r,"canClick",!0),F(r,"color"),F(r,"display"),F(r,"glowColor"),F(r,"classes"),F(r,"style"),F(r,"mark");for(const f of t)(u=f.postConstruct)==null||u.call(f,r);if(r.onClick){const f=r.onClick.bind(r);r.onClick=function(v){o(r.canClick)!==!1&&f(v)}}if(r.onHold){const f=r.onHold.bind(r);r.onHold=function(){o(r.canClick)!==!1&&f()}}const s=t.reduce((f,v)=>{var g;return Object.assign(f,(g=v.getGatheredProps)==null?void 0:g.call(v,r))},{});return r[qe]=function(){const{display:f,visibility:v,style:g,classes:p,onClick:b,onHold:C,color:w,glowColor:M,canClick:P,mark:k,id:T}=this;return{display:f,visibility:v,style:g,classes:p,onClick:b,onHold:C,color:w,glowColor:M,canClick:P,mark:k,id:T,...s}},r})}function Du(e,t=null,n=0){const i=Oe(n);return $(()=>t==null||c.gte(e.value,o(i))?Ht(e)+" "+e.displayName:`Reach ${c.eq(t.precision,0)?ut(o(i)):ge(o(i),t.precision)} ${t.displayName} to unlock (You have ${c.eq(t.precision,0)?ut(t.value):ge(t.value,t.precision)})`)}function Eu(e){return Fu(t=>{const n=e.call(t,t);return K(n,"display",zn(n.layerID)),F(n,"append"),{...n,onClick:o(n.append)?function(){if(D.tabs.includes(n.layerID)){const i=D.tabs.lastIndexOf(n.layerID);D.tabs.splice(i,1)}else D.tabs.push(n.layerID)}:function(){D.tabs.splice(1,1,n.layerID)}}})}function Au(e,t){return F(t,"display"),F(t,"classes"),F(t,"style"),F(t,"direction"),K(t,"direction",z.Up),F(t,"xoffset"),F(t,"yoffset"),t.pinnable&&(t.pinned=ft(!1,!1)),lt(()=>{const n=e[Ve];e[Ve]=ce;const i=e[qe].bind(e);e[qe]=function(){const{display:s,classes:a,style:l,direction:u,xoffset:f,yoffset:v,pinned:g}=this;return{element:{[Ve]:n,[qe]:i},display:s,classes:a,style:o(l),direction:u,xoffset:f,yoffset:v,pinned:g}}.bind(t)}),t}const Ou=B({__name:"Sticky",setup(e){const t=A("0"),n=new ResizeObserver(r),i=Se(null);function r(){let s=i.value;if(s==null)return;let a=0;for(;s.previousSibling;){const l=s.previousSibling;l.dataset&&"vSticky"in l.dataset&&(a+=l.offsetHeight),s=l}t.value=a+"px"}return lt(r),document.fonts.ready.then(r),Tt(()=>{var a;const s=(a=i.value)==null?void 0:a.parentElement;s&&n.observe(s)}),(s,a)=>(_(),S("div",{class:"sticky",style:me({top:t.value}),ref_key:"element",ref:i,"data-v-sticky":""},[Ae(s.$slots,"default",{},void 0,!0)],4))}});var Vu=Q(Ou,[["__scopeId","data-v-cccac690"]]);const qu=B({__name:"Resource",props:{resource:null,color:null},setup(e){const t=e,n=$(()=>Ht(t.resource));return(i,r)=>(_(),S("h2",{style:me({color:e.color,"text-shadow":"0px 0px 10px "+e.color})},L(o(n)),5))}});const Lu={class:"main-display"},Ru={key:0},Bu={key:1},zu=B({__name:"MainDisplay",props:{resource:null,color:null,classes:null,style:null,effectDisplay:null},setup(e){const n=de(e),i=A(null),r=yt(n.effectDisplay),s=$(()=>c.lt(n.resource.value,"1e1000"));return(a,l)=>(_(),G(Vu,null,{default:V(()=>{var u,f,v,g;return[y("div",{class:ie(["main-display-container",(u=e.classes)!=null?u:{}]),style:me([{height:`${((v=(f=i.value)==null?void 0:f.$el.clientHeight)!=null?v:0)+50}px`},(g=e.style)!=null?g:{}])},[y("div",Lu,[o(s)?(_(),S("span",Ru,"You have ")):E("",!0),h(qu,{resource:e.resource,color:e.color||"white"},null,8,["resource","color"]),O(" "+L(e.resource.displayName),1),o(r)?(_(),S("span",Bu,[O(", "),(_(),G(ve(o(r)),{ref_key:"effectRef",ref:i},null,512))])):E("",!0)])],6)]}),_:1}))}});function rt(e){return Te(t=>{var i;const n=e.call(t,t);return n.partialDisplay=r=>h("span",{style:o(n.requirementMet)?"":"color: var(--danger)"},[Ht(n.resource,n.cost instanceof d?Rt(n.cost,r!=null?r:1,o(n.cumulativeCost),o(n.directSum)):o(n.cost))," ",n.resource.displayName]),n.display=r=>h("div",null,[o(n.requiresPay)?"Costs: ":"Requires: ",Ht(n.resource,n.cost instanceof d?Rt(n.cost,r!=null?r:1,o(n.cumulativeCost),o(n.directSum)):o(n.cost))," ",n.resource.displayName]),F(n,"visibility"),K(n,"visibility",ke.Visible),F(n,"cost"),F(n,"requiresPay"),K(n,"requiresPay",!0),F(n,"cumulativeCost"),K(n,"cumulativeCost",!0),F(n,"maxBulkAmount"),K(n,"maxBulkAmount",1),F(n,"directSum"),K(n,"pay",function(r){const s=n.cost instanceof d?Rt(n.cost,r!=null?r:1,o(n.cumulativeCost),o(n.directSum)):o(n.cost);n.resource.value=c.sub(n.resource.value,s).max(0)}),n.canMaximize=$(()=>{var l;if(!(n.cost instanceof d))return!1;const r=o(n.maxBulkAmount);if(c.lte(r,1))return!1;const s=o(n.cumulativeCost),a=(l=o(n.directSum))!=null?l:s?10:0;return c.lte(r,a)?!0:!(!n.cost.isInvertible()||s===!0&&!n.cost.isIntegrable())}),n.cost instanceof d?n.requirementMet=Es(n.cost,n.resource,(i=n.cumulativeCost)!=null?i:!0,n.directSum,n.maxBulkAmount):n.requirementMet=$(()=>c.gte(n.resource.value,o(n.cost))?1:0),n})}function ti(e){return Te(()=>({requirementMet:$(()=>ct(e.visibility)),visibility:ke.None,requiresPay:!1}))}function bn(e){if(Re(e))return e.every(bn);const t=o(e.requirementMet);return typeof t=="boolean"?t:c.gt(t,0)}function ni(e){if(Re(e))return e.map(ni).reduce(c.min);const t=o(e.requirementMet);return typeof t=="boolean"?t?c.dInf:0:c.gt(t,1)&&o(e.canMaximize)!==!0?1:t}function yn(e,t=1){var n,i;if(Re(e)&&(e=e.filter(r=>ct(r.visibility)),e.length===1&&(e=e[0])),Re(e)){e=e.filter(a=>"partialDisplay"in a);const r=e.filter(a=>o(a.requiresPay)),s=e.filter(a=>!o(a.requiresPay));return h(R,null,[r.length>0?h("div",null,[O("Costs:")," ",$n(r.map(a=>a.partialDisplay(t)),h(R,null,[O(", ")]))]):null,s.length>0?h("div",null,[O("Requires:")," ",$n(s.map(a=>a.partialDisplay(t)),h(R,null,[O(", ")]))]):null])}return(i=(n=e.display)==null?void 0:n.call(e))!=null?i:h(R,null,null)}function ii(e,t=1){var n;Re(e)?e.filter(i=>o(i.requiresPay)).forEach(i=>{var r;return(r=i.pay)==null?void 0:r.call(i,t)}):o(e.requiresPay)&&((n=e.pay)==null||n.call(e,t))}const Uu=Symbol("Repeatable");function At(e,...t){const n=ft(0),i=t.reduce((r,s)=>{var a;return Object.assign(r,(a=s.getPersistentData)==null?void 0:a.call(s))},{});return Te(r=>{var p,b,C;const s=e.call(r,r);s.id=Pt("repeatable-"),s.type=Uu,s[Ve]=Cu;for(const w of t)(p=w.preConstruct)==null||p.call(w,s);s.amount=n,s.amount[Je]=(b=s.initialAmount)!=null?b:0,Object.assign(s,i);const a={requirementMet:$(()=>c.sub(o(s.limit),s.amount.value)),requiresPay:!1,visibility:ke.None,canMaximize:!0},l=ti(s);Re(s.requirements)?(s.requirements.unshift(l),s.requirements.push(a)):s.requirements=[l,s.requirements,a],s.maxed=$(()=>c.gte(s.amount.value,o(s.limit))),F(s,"classes");const u=s.classes;s.classes=$(()=>{const w=o(u)||{};return s.maxed.value&&(w.bought=!0),w}),s.amountToIncrease=$(()=>c.clampMin(ni(s.requirements),1)),s.canClick=$(()=>bn(s.requirements));const f=s.onClick;s.onClick=function(w){var k;const M=s;if(!o(M.canClick))return;const P=(k=o(s.amountToIncrease))!=null?k:1;ii(s.requirements,P),M.amount.value=c.add(M.amount.value,P),f==null||f(w)},F(s,"display");const v=s.display;s.display=Y(()=>{var M,P,k;const w=o(v);if(bt(w)){const T=ne(w);return h(T,null,null)}if(w!=null){const T=s,I=ne((M=w.title)!=null?M:"","h3"),U=ne((P=w.description)!=null?P:""),H=ne((k=w.effectDisplay)!=null?k:"");return h("span",null,[w.title==null?null:h("div",null,[h(I,null,null)]),w.description==null?null:h(U,null,null),w.showAmount===!1?null:h("div",null,[h("br",null,null),h(R,null,[O("Amount: "),ut(T.amount.value)]),c.isFinite(o(T.limit))?h(R,null,[O(" / "),ut(o(T.limit))]):void 0]),w.effectDisplay==null?null:h("div",null,[h("br",null,null),O("Currently: "),h(H,null,null)]),T.maxed.value?null:h("div",null,[h("br",null,null),yn(T.requirements,o(s.amountToIncrease))])])}return""}),F(s,"visibility"),K(s,"visibility",ke.Visible),F(s,"limit"),K(s,"limit",c.dInf),F(s,"style"),F(s,"mark"),F(s,"small");for(const w of t)(C=w.postConstruct)==null||C.call(w,s);const g=t.reduce((w,M)=>{var P;return Object.assign(w,(P=M.getGatheredProps)==null?void 0:P.call(M,s))},{});return s[qe]=function(){const{display:w,visibility:M,style:P,classes:k,onClick:T,canClick:I,small:U,mark:H,id:ee}=this;return{display:w,visibility:M,style:o(P),classes:k,onClick:T,canClick:I,small:U,mark:H,id:ee,...g}},s})}const ju={postConstruct(e){e.amount===void 0&&console.error(`Decorated feature ${e.id} does not contain the required 'amount' property"`),F(e,"bonusAmount"),e.totalAmount===void 0&&(e.totalAmount=$(()=>{var t;return c.add(o((t=e.amount)!=null?t:0),o(e.bonusAmount))}))}};function Ot(e){return Te(t=>{const{multiplier:n,description:i,enabled:r,smallerIsBetter:s}=e.call(t,t),a=Oe(n),l=Oe(i),u=r==null?void 0:Oe(r);return{apply:f=>c.times(f,o(a)),invert:f=>c.div(f,o(a)),getFormula:f=>d.times(f,a),enabled:u,description:i==null?void 0:Y(()=>h("div",{class:"modifier-container"},[o(l)!=null?h("span",{class:"modifier-description"},[Ze(o(l))]):null,h("span",{class:"modifier-amount",style:(s===!0?c.gt(o(a),1):c.lt(o(a),1))?"color: var(--danger)":""},[O("\xD7"),Ut(o(a))])]))}})}function Pn(e){return Te(()=>{const t=e();return{apply:n=>t.filter(i=>o(i.enabled)!==!1).reduce((i,r)=>r.apply(i),n),invert:t.every(n=>n.invert!=null)?n=>t.filter(i=>o(i.enabled)!==!1).reduceRight((i,r)=>r.invert(i),n):void 0,getFormula:t.every(n=>n.getFormula!=null)?n=>t.filter(i=>o(i.enabled)!==!1).reduce((i,r)=>r.getFormula(i),n):void 0,enabled:t.some(n=>n.enabled!=null)?$(()=>t.filter(n=>o(n.enabled)!==!1).length>0):void 0,description:t.some(n=>n.description!=null)?Y(()=>h(R,null,[t.filter(n=>o(n.enabled)!==!1).map(n=>o(n.description)).filter(n=>n).map(Ze)])):void 0}})}function Vt({title:e,subtitle:t,modifier:n,base:i,unit:r,baseText:s,smallerIsBetter:a}){const l=n.apply(i!=null?i:1);return h("div",{style:{"--unit":te.alignUnits&&r!=null?"'"+r+"'":""}},[h("h3",null,[e,t==null?null:h("span",{class:"subtitle"},[O(" ("),t,O(")")])]),h("br",null,null),h("div",{class:"modifier-container"},[h("span",{class:"modifier-description"},[Ze(s!=null?s:"Base")]),h("span",{class:"modifier-amount"},[Ut(i!=null?i:1),r])]),Ze(o(n.description)),h("hr",null,null),h("div",{class:"modifier-container"},[h("span",{class:"modifier-description"},[O("Total")]),h("span",{class:"modifier-amount",style:(a===!0?c.gt(l,i!=null?i:1):c.lt(l,i!=null?i:1))?"color: var(--danger)":""},[Ut(l),r])])])}const Fe={postConstruct(e){F(e,"effect")}};var Gu=B({props:{display:{type:W(String,Object,Function),required:!0},visibility:{type:W(Number,Boolean),required:!0},style:W(String,Object,Array),classes:W(Object),requirements:{type:Object,required:!0},canPurchase:{type:W(Boolean),required:!0},bought:{type:W(Boolean),required:!0},mark:W(Boolean,String),id:{type:String,required:!0},purchase:{type:Function,required:!0}},components:{Node:vn,MarkNode:hn},setup(e){const{display:t,requirements:n,bought:i}=de(e),r=Se("");return We(()=>{const s=Ce(t);if(s==null){r.value="";return}if(bt(s)){r.value=ne(s);return}const a=ne(s.title||"","h3"),l=ne(s.description,"div"),u=ne(s.effectDisplay||"");r.value=ne(Y(()=>h("span",null,[s.title!=null?h("div",null,[h(a,null,null)]):null,h(l,null,null),s.effectDisplay!=null?h("div",null,[O("Currently: "),h(u,null,null)]):null,i.value?null:h(R,null,[h("br",null,null),yn(n.value)])])))}),{component:r,unref:o,Visibility:ke,isVisible:ct,isHidden:sn}}});const Wu=["disabled"];function Hu(e,t,n,i,r,s){var u;const a=Be("MarkNode"),l=Be("Node");return e.isVisible(e.visibility)?(_(),S("button",{key:0,style:me([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(u=e.unref(e.style))!=null?u:{}]),onClick:t[0]||(t[0]=(...f)=>e.purchase&&e.purchase(...f)),class:ie({feature:!0,upgrade:!0,can:e.unref(e.canPurchase),locked:!e.unref(e.canPurchase),bought:e.unref(e.bought),...e.unref(e.classes)}),disabled:!e.unref(e.canPurchase)},[e.unref(e.component)?(_(),G(ve(e.unref(e.component)),{key:0})):E("",!0),h(a,{mark:e.unref(e.mark)},null,8,["mark"]),h(l,{id:e.id},null,8,["id"])],14,Wu)):E("",!0)}var Zu=Q(Gu,[["render",Hu],["__scopeId","data-v-9be6bac0"]]);const Yu=Symbol("Upgrade");function mt(e,...t){const n=ft(!1,!1),i=t.reduce((r,s)=>{var a;return Object.assign(r,(a=s.getPersistentData)==null?void 0:a.call(s))},{});return Te(r=>{var u,f;const s=e.call(r,r);s.id=Pt("upgrade-"),s.type=Yu,s[Ve]=Zu;for(const v of t)(u=v.preConstruct)==null||u.call(v,s);s.bought=n,Object.assign(s,i),s.canPurchase=$(()=>!n.value&&bn(s.requirements)),s.purchase=function(){var g;const v=s;!o(v.canPurchase)||(ii(s.requirements),n.value=!0,(g=v.onPurchase)==null||g.call(v))};const a=ti(s);Re(s.requirements)?s.requirements.unshift(a):s.requirements=[a,s.requirements],F(s,"visibility"),K(s,"visibility",ke.Visible),F(s,"classes"),F(s,"style"),F(s,"display"),F(s,"mark");for(const v of t)(f=v.postConstruct)==null||f.call(v,s);const l=t.reduce((v,g)=>{var p;return Object.assign(v,(p=g.getGatheredProps)==null?void 0:p.call(g,s))},{});return s[qe]=function(){const{display:v,visibility:g,style:p,classes:b,requirements:C,canPurchase:w,bought:M,mark:P,id:k,purchase:T}=this;return{display:v,visibility:g,style:o(p),classes:b,requirements:C,canPurchase:w,bought:M,mark:P,id:k,purchase:T,...l}},s})}function Ju(e,t){const n=[];for(let i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n}const Fn=[{requiredSize:-2,baseCost:1,scaling:1.4},{requiredSize:-1,baseCost:1e5,scaling:1.5},{requiredSize:0,baseCost:1e12,scaling:1.6}],Ku=function(e){const t="C",n="Cascade-"+e.position,i="#4BDC13",r=fn(t+"-"+e.position,function(){const s=gu(1,"stuff"),a=pu(()=>({thingsToReset:()=>[r]})),l=Eu(()=>({layerID:this.id,display:t,color:i,reset:a})),u=Au(l,{display:Du(s),pinnable:!0});function f(I,U){return rt(()=>({cost:$(()=>c.mul(I.baseCost,c.pow(I.scaling,o(U.amount)))),resource:it(s)}))}const v=[],g=Pn(()=>v),p=Ot(()=>({multiplier:$(()=>g.apply(1)),description:"All Boost"})),b=[],C=[];for(let I=0;I<Fn.length;I++){const U=Fn[I];b[I]=At(H=>({requirements:f(U,H),display:Y(()=>h(R,null,[t+"-"+I,h("br",null,null),"Amount: "+ge(o(H.totalAmount))+" ("+ge(o(H.amount))+")",h("br",null,null),yn(H.requirements)])),bonusAmountRaw:ft(0),bonusAmount:$(()=>H.bonusAmountRaw.value)}),ju),C[I]=[Ot(()=>({multiplier:b[I].totalAmount,description:()=>"Structure Count"})),p]}const w={res0:mt(I=>({requirements:rt(()=>({cost:200,resource:it(s)})),effect:()=>c.pow(1.1,o(b[0].amount)),display:{title:"Resonance 0",description:"Purchased C-0 boost themselves by 1.1x",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},appliesTo:0}),Fe),spec1:mt(I=>({requirements:rt(()=>({cost:1e5,resource:it(s)})),effect:()=>2,display:{title:"Spectrum 1",description:"All production on this layer is doubled",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},appliesTo:-1}),Fe),res1:mt(I=>({requirements:rt(()=>({cost:2e7,resource:it(s)})),effect:()=>c.pow(1.08,o(b[1].amount)),display:{title:"Resonance 1",description:"Purchased C-1 boost themselves by 1.08x",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},appliesTo:1}),Fe),cond0:mt(I=>({requirements:rt(()=>({cost:1e13,resource:it(s)})),effect:()=>c.add(10,o(b[0].totalAmount)).log10(),display:{title:"Condense 0",description:"Boost C-0 by log10 of C-0",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},appliesTo:0}),Fe),res2:mt(I=>({requirements:rt(()=>({cost:2e16,resource:it(s)})),effect:()=>c.pow(1.06,o(b[2].amount)),display:{title:"Resonance 2",description:"Purchased C-2 boost themselves by 1.06x",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},appliesTo:2}),Fe),spec2:mt(I=>({requirements:rt(()=>({cost:1e21,resource:it(s)})),effect:()=>2,display:{title:"Spectrum 2",description:"All production on this layer is doubled",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},appliesTo:-1}),Fe)},M=Object.values(w),P=[At(I=>({requirements:f({baseCost:100,scaling:100},I),effect:()=>c.pow(3,o(I.amount)),display:{title:"CR-0",description:"3x C-0 production per level",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},limit:5,appliesTo:0}),Fe),At(I=>({requirements:f({baseCost:1e9,scaling:1e3},I),effect:()=>c.pow(2,o(I.amount)),display:{title:"CR-1",description:"2x C-0 production per level",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},limit:3,appliesTo:0}),Fe),At(I=>({requirements:f({baseCost:1e16,scaling:1e4},I),effect:()=>c.pow(2,o(I.amount)),display:{title:"CR-2",description:"2x C-1 production per level",effectDisplay:Y(()=>h(R,null,[ge(o(I.effect))+"x"]))},limit:3,appliesTo:1}),Fe)],k=[];for(let I=0;I<C.length;I++)k[I]=Pn(()=>C[I]);for(const I of M){const U=I.appliesTo;if(U===void 0)continue;const H=Ot(()=>({multiplier:I.effect,description:I.display.title,enabled:I.bought}));U===-1?v.push(H):C[U].push(H)}for(const I of P){const U=I.appliesTo;if(U===void 0)continue;const H=Ot(()=>({multiplier:I.effect,description:I.display.title,enabled:()=>c.gt(o(I.amount),0)}));U===-1?v.push(H):C[U].push(H)}this.on("update",I=>{s.value=c.add(s.value,k[0].apply(I));for(let U=0;U<b.length-1;U++)b[U].bonusAmountRaw.value=c.add(b[U].bonusAmountRaw.value,k[U+1].apply(I))});const T=Ju(M,5).map(I=>xn(...I));return{name:n,color:i,points:s,tooltip:u,display:Y(()=>h(R,null,[h(zu,{resource:s,color:i},null),T,h("br",null,null),xn(...P),h("br",null,null),He(b[0]),h("br",null,null),He(b[1]),h("br",null,null),He(b[2]),h("br",null,null),Vt({title:"All Boost",modifier:g}),h("br",null,null),Vt({title:"C-0 Production",modifier:k[0]}),h("br",null,null),Vt({title:"C-1 Production",modifier:k[1]}),h("br",null,null),Vt({title:"C-2 Production",modifier:k[2]})])),treeNode:l,structures:b,upgrades:w,repeatables:P}});return r},ri=fn("main",function(){const e=$(()=>o(t.types.builder.nodes)[0]),t=fu(n=>({links:()=>{const i=[];return o(n.nodes),e.value.state.linked.forEach(r=>{i.push({startNode:e.value,endNode:Qt(n,r),stroke:"var(--foreground)",strokeWidth:4})}),i},types:{builder:{actions:[{icon:"build",id:"build",onClick:i=>{const r=i.state,s=r.linked;if(!r.active&&s.length>0){r.active=!0;for(let a=0;a<s.length;a++){const l=Qt(n,s[a]),u=oi(l);gn(u,D),D.tabs.push(u.id),l.position={x:i.position.x-50*s.length+100*a+50,y:i.position.y+300}}}else if(r.active){r.active=!1;for(let a=0;a<s.length;a++){const u=Qt(n,s[a]).state,f=u.layerId;mn(Zn(f)),delete D.layers[f];const v=D.tabs.indexOf(f);D.tabs.splice(v,1),u.layerId=null}}},tooltip:{text:"BUILD"}}],canAccept:(i,r)=>!i.state.active,draggable:!1,onDrop:(i,r)=>{const s=i.state.linked;s.includes(r.id)?s.splice(s.indexOf(r.id),1):s.push(r.id)},shape:$t.Diamond,size:100,title:"Builder"},layer:{draggable:i=>i.state.layerId===null,onClick:i=>{const r=i.state.layerId;if(r!=null)if(D.tabs.includes(r)){const s=D.tabs.lastIndexOf(r);D.tabs.splice(s,1)}else D.tabs.push(r)},shape:$t.Circle,size:50,title:i=>i.state.type}},startNodes:()=>[{position:{x:0,y:0},type:"builder",state:{active:!1,linked:[]}},{position:{x:100,y:100},type:"layer",state:{type:"cascade",layerId:null}}]}));return{name:"Board",display:Y(()=>h(R,null,[D.devSpeed===0?h("div",null,[O("Game Paused")]):null,D.devSpeed!=null&&D.devSpeed!==0&&D.devSpeed!==1?h("div",null,[O("Dev Speed: "),ge(D.devSpeed),O("x")]):null,D.offlineTime!=null&&D.offlineTime!==0?h("div",null,[O("Offline Time: "),Yt(D.offlineTime)]):null,h(Ol,null,null),He(t)])),board:t}});function oi(e){const t=e.state,n=Ku({position:0,size:0,upgrade:0,repeatable:0});return t.layerId=n.id,n}const Xu=e=>{var n,i,r,s,a;const t=[ri];return(a=(s=(r=(i=(n=e.layers)==null?void 0:n.main)==null?void 0:i.board)==null?void 0:r.state)==null?void 0:s.nodes)==null||a.filter(l=>(l==null?void 0:l.type)=="layer").forEach(l=>{if(l.state.layerId!=null){const f=oi(l);t.push(f)}}),t},si=$(()=>!1);function Qu(e,t){}var ec=Object.freeze(Object.defineProperty({__proto__:null,main:ri,getInitialLayers:Xu,hasWon:si,fixOldSave:Qu},Symbol.toStringTag,{value:"Module"}));const Ft=e=>(Ke("data-v-4a50ce42"),e=e(),Xe(),e),tc={class:"game-over-modal-header"},nc=["src","alt"],ic={class:"game-over-modal-title"},rc=Ft(()=>y("h2",null,"Congratulations!",-1)),oc={key:0},sc=Ft(()=>y("br",null,null,-1)),ac=Ft(()=>y("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),lc=Ft(()=>y("br",null,null,-1)),uc=["href"],cc=Ft(()=>y("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),dc=B({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:i,discordLink:r,versionNumber:s,versionTitle:a}=J,l=$(()=>Yt(D.timePlayed)),u=$(()=>si.value&&!D.keepGoing),f=ze(D,"autosave");function v(){D.keepGoing=!0}function g(){ot(pt())}return(p,b)=>(_(),G(dt,{"model-value":o(u)},{header:V(()=>[y("div",tc,[o(n)?(_(),S("img",{key:0,class:"game-over-modal-logo",src:o(n),alt:o(t)},null,8,nc)):E("",!0),y("div",ic,[rc,y("h4",null,"You've beaten "+L(o(t))+" v"+L(o(s))+": "+L(o(a)),1)])])]),body:V(({shown:C})=>[C?(_(),S("div",oc,[y("div",null,"It took you "+L(o(l))+" to beat the game.",1),sc,ac,lc,y("div",null,[y("a",{href:o(r),class:"game-over-modal-discord-link"},[cc,O(" "+L(o(i)),1)],8,uc)]),h(De,{title:"Autosave",modelValue:o(f),"onUpdate:modelValue":b[0]||(b[0]=w=>le(f)?f.value=w:null)},null,8,["modelValue"])])):E("",!0)]),footer:V(()=>[y("div",{class:"game-over-footer"},[y("button",{onClick:v,class:"button"},"Keep Going"),y("button",{onClick:g,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var fc=Q(dc,[["__scopeId","data-v-4a50ce42"]]);const Jt=e=>(Ke("data-v-d3bb0716"),e=e(),Xe(),e),gc=Jt(()=>y("div",{class:"nan-modal-header"},[y("h2",null,"NaN value detected!")],-1)),mc={key:0},pc=Jt(()=>y("br",null,null,-1)),hc=["href"],vc=Jt(()=>y("span",{class:"material-icons nan-modal-discord"},"discord",-1)),bc=Jt(()=>y("br",null,null,-1)),yc={class:"nan-footer"},_c=B({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=J,i=A(!0),r=A(!0),s=ze(oe,"hasNaN"),a=A(null);$e(s,p=>{p?(i.value=D.autosave,r.value=D.devSpeed===0):(D.autosave=i.value,D.devSpeed=r.value?0:null)});const l=$(()=>{var p;return(p=oe.NaNPath)==null?void 0:p.join(".")}),u=$(()=>oe.NaNPersistent!=null?oe.NaNPersistent.value:null);function f(){oe.NaNPersistent!=null&&(oe.NaNPersistent.value=new c(0),oe.hasNaN=!1)}function v(){oe.NaNPersistent&&(oe.NaNPersistent.value=new c(1),oe.hasNaN=!1)}function g(){oe.NaNPersistent&&(oe.NaNPersistent.value=new c(NaN),oe.hasNaN=!1)}return(p,b)=>(_(),S(R,null,[h(dt,Le({modelValue:o(s),"onUpdate:modelValue":b[4]||(b[4]=C=>le(s)?s.value=C:null)},p.$attrs),{header:V(()=>[gc]),body:V(()=>[y("div",null,[O(' Attempted to assign "'+L(o(l))+'" to NaN',1),o(u)?(_(),S("span",mc,L(" ")+"(previously "+L(o(ge)(o(u)))+")",1)):E("",!0),O(". Auto-saving has been "+L(i.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),pc,y("div",null,[y("a",{href:o(n)||"https://discord.gg/yJ4fjnjU54",class:"nan-modal-discord-link"},[vc,O(" "+L(o(t)||"Profectus & Friends"),1)],8,hc)]),bc,h(De,{title:"Autosave",modelValue:i.value,"onUpdate:modelValue":b[0]||(b[0]=C=>i.value=C)},null,8,["modelValue"]),o(J).enablePausing?(_(),G(De,{key:0,title:"Pause game",modelValue:r.value,"onUpdate:modelValue":b[1]||(b[1]=C=>r.value=C)},null,8,["modelValue"])):E("",!0)]),footer:V(()=>[y("div",yc,[y("button",{onClick:b[2]||(b[2]=C=>{var w;return(w=a.value)==null?void 0:w.open()}),class:"button"},"Open Saves Manager"),y("button",{onClick:f,class:"button"},"Set to 0"),y("button",{onClick:v,class:"button"},"Set to 1"),o(u)&&o(c).neq(o(u),0)&&o(c).neq(o(u),1)?(_(),S("button",{key:0,onClick:b[3]||(b[3]=C=>s.value=!1),class:"button"}," Set to previous ")):E("",!0),y("button",{onClick:g,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),h(Xn,{ref_key:"savesManager",ref:a},null,512)],64))}});var Nc=Q(_c,[["__scopeId","data-v-d3bb0716"]]);const wc={key:0,class:"tpsDisplay"},Cc=B({__name:"TPS",setup(e){const t=$(()=>c.div(oe.lastTenTicks.length,oe.lastTenTicks.reduce((n,i)=>n+i,0)));return(n,i)=>o(t).isNan()?E("",!0):(_(),S("div",wc,"TPS: "+L(o(ut)(o(t))),1))}});var kc=Q(Cc,[["__scopeId","data-v-89b89152"]]);var Sc=B({__name:"App",setup(e){const t=J.useHeader,n=$(()=>Me[te.theme].variables),i=ze(te,"showTPS"),r=ze(oe,"errors"),s=$(()=>ne(Y(()=>h(R,null,[Hr.map(He)]))));return(a,l)=>o(r).length>0?(_(),S("div",{key:0,class:"error-container",style:me(o(n))},[h(An,{errors:o(r)},null,8,["errors"])],4)):(_(),S(R,{key:1},[y("div",{id:"modal-root",style:me(o(n))},null,4),y("div",{class:ie(["app",{useHeader:o(t)}]),style:me(o(n))},[o(t)?(_(),G(Qn,{key:0})):E("",!0),h(Al),o(o(i))?(_(),G(kc,{key:1})):E("",!0),h(fc),h(Nc),(_(),G(ve(o(s))))],6)],64))}});var Ic=Q(Sc,[["__scopeId","data-v-bf4e22ac"]]);pe.on("setupVue",e=>e.use(_i));function Mc(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:a}=e;let l,u,f,v;const g=async(b=!0)=>{await f,b&&(l==null||l.addEventListener("controlling",C=>{C.isUpdate&&window.location.reload()})),await(v==null?void 0:v())};async function p(){if("serviceWorker"in navigator){const{Workbox:b,messageSW:C}=await St(()=>import("./workbox-window.4a8794bb.js"),[]);v=async()=>{u&&u.waiting&&await C(u.waiting,{type:"SKIP_WAITING"})},l=new b("./sw.js",{scope:"./",type:"classic"}),l.addEventListener("activated",w=>{w.isUpdate||i==null||i()});{const w=()=>{n==null||n()};l.addEventListener("waiting",w),l.addEventListener("externalwaiting",w)}l.register({immediate:t}).then(w=>{u=w,s?s("./sw.js",w):r==null||r(w)}).catch(w=>{a==null||a(w)})}}return f=p(),g}function xc(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:a}=e,l=A(!1),u=A(!1);return{updateServiceWorker:Mc({immediate:t,onNeedRefresh(){l.value=!0,n==null||n()},onOfflineReady(){u.value=!0,i==null||i()},onRegistered:r,onRegisteredSW:s,onRegisterError:a}),offlineReady:u,needRefresh:l}}const _n=console.error;console.error=function(...e){_n(...e)};window.onerror=function(e,t,n,i,r){return oe.errors.push(r instanceof Error?r:new Error(JSON.stringify(r))),_n(r),!0};window.onunhandledrejection=function(e){oe.errors.push(e.reason instanceof Error?e.reason:new Error(JSON.stringify(e.reason))),_n(e.reason)};document.title=J.title;window.projInfo=J;J.id===""&&console.error("Project ID is empty!","Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await Br();const{globalBus:e}=await St(()=>Promise.resolve().then(function(){return Rr}),void 0),{startGameLoop:t}=await St(()=>import("./gameLoop.1323ca2a.js"),["assets/gameLoop.1323ca2a.js","assets/@fontsource.f66d05e7.css","assets/vue.024b280c.js","assets/amator.44aadee5.js","assets/bezier-easing.a990b400.js","assets/@vue.6f8187b0.js","assets/lz-string.dccec454.js","assets/nanoevents.1080beb7.js","assets/vue-next-select.b54494ec.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.494fa47c.js","assets/sortablejs.8a81d281.js","assets/vue-textarea-autosize.35804eaf.js","assets/vue-panzoom.f7879767.js","assets/panzoom.63406b21.js","assets/wheel.e7ba1027.js","assets/ngraph.events.083734c6.js","assets/vue-toastification.94080fa2.js","assets/vue-toastification.4b5f8ac8.css"]),n=window.vue=pi(Ic);n.config.errorHandler=function(i,r,s){console.error(i,s,r)},e.emit("setupVue",n),n.mount("#app"),lt(()=>{const i=Ni(),{updateServiceWorker:r}=xc({onNeedRefresh(){i.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){r()}})},onOfflineReady(){i.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(s){s&&setInterval(()=>s.update(),60*60*1e3)}})}),t()});export{c as D,St as _,oe as a,J as b,ec as c,pe as g,zr as l,D as p,te as s};
